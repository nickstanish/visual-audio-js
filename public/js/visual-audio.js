!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var a in n)("object"==typeof exports?exports:t)[a]=n[a]}}(this,function(){return function(t){function e(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return t[a].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(4)},,,,function(t,e,n){"use strict";function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return"boolean"==typeof t&&t||"true"===t.toLowerCase()||"1"===t}function i(t){var e=null;try{e=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(t){console.error(t),alert("Unable to initialize WebGL. Your browser may not support it.")}return window.gl=e,e}function u(){Ot=At.createBuffer();var t=new Float32Array([-1,1,-1,-1,1,-1,1,1,-1,1,1,-1]);At.bindBuffer(At.ARRAY_BUFFER,Ot),At.bufferData(At.ARRAY_BUFFER,t,At.STATIC_DRAW)}function l(){_(At.canvas);var t=At.canvas.clientWidth,e=At.canvas.clientHeight;Pt=At.createFramebuffer(),At.bindFramebuffer(At.FRAMEBUFFER,Pt),Pt.width=t,Pt.height=e,Ct=At.createTexture(),At.activeTexture(At.TEXTURE0),At.bindTexture(At.TEXTURE_2D,Ct),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_WRAP_S,At.CLAMP_TO_EDGE),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_WRAP_T,At.CLAMP_TO_EDGE),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_MAG_FILTER,At.LINEAR),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_MIN_FILTER,At.LINEAR),At.texImage2D(At.TEXTURE_2D,0,At.RGBA,Pt.width,Pt.height,0,At.RGBA,At.UNSIGNED_BYTE,null),At.framebufferTexture2D(At.FRAMEBUFFER,At.COLOR_ATTACHMENT0,At.TEXTURE_2D,Ct,0),At.bindFramebuffer(At.FRAMEBUFFER,null)}function s(){Ft=At.createTexture(),gt=new Image,gt.onload=function(){At.activeTexture(At.TEXTURE1),At.bindTexture(At.TEXTURE_2D,Ft),At.texImage2D(At.TEXTURE_2D,0,At.RGBA,At.RGBA,At.UNSIGNED_BYTE,gt),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_MAG_FILTER,At.LINEAR),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_MIN_FILTER,At.LINEAR),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_WRAP_S,At.CLAMP_TO_EDGE),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_WRAP_T,At.CLAMP_TO_EDGE),Et=!0},gt.src="public/images/alpha-star.png"}function c(){u(),s(),l()}function f(){_t=[];var t=Rt.getFrequencyBinCount(),e=8,n=e/t,a=.2*n,r=Rt.getFrequencyData(),o=e/2;if(r&&r.length>0)for(var i=0;i<r.length;i++){var u=r[i]/255,l=u,s=0,c=i*n-o,f=c+(n-a),h=1,d=[c,l,h,c,s,h,f,s,h,f,l,h,c,l,h,f,s,h];_t=_t.concat(d)}Dt=At.createBuffer(),At.bindBuffer(At.ARRAY_BUFFER,Dt),At.bufferData(At.ARRAY_BUFFER,new Float32Array(_t),At.STATIC_DRAW),At.useProgram(St.getProgram()),At.uniformMatrix4fv(St.getUniformLocation(Q.BAR_SHADER_CONFIG.uniforms.uPMatrix),!1,ft),At.uniformMatrix4fv(St.getUniformLocation(Q.BAR_SHADER_CONFIG.uniforms.uMVMatrix),!1,at.getModelViewMatrix());var M=tt.create(),m=nt.fromValues(0,-4,0,0);tt.translate(M,M,m),At.uniformMatrix4fv(St.getUniformLocation(Q.BAR_SHADER_CONFIG.uniforms.uMMatrix),!1,M),At.bindBuffer(At.ARRAY_BUFFER,Dt),At.enableVertexAttribArray(St.getAttribLocation(Q.BAR_SHADER_CONFIG.attributes.vertices)),At.vertexAttribPointer(St.getAttribLocation(Q.BAR_SHADER_CONFIG.attributes.vertices),3,At.FLOAT,!1,0,0),At.drawArrays(At.TRIANGLES,0,_t.length/3),At.disableVertexAttribArray(St.getAttribLocation(Q.BAR_SHADER_CONFIG.attributes.vertices))}function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=Rt.isPlaying()?0:5,a=30;At.useProgram(vt.getProgram()),At.uniformMatrix4fv(vt.getUniformLocation(Q.SHADER_GPU_PARTICLE_CONFIG.uniforms.modelMatrix),!1,dt),At.uniformMatrix4fv(vt.getUniformLocation(Q.SHADER_GPU_PARTICLE_CONFIG.uniforms.projectionMatrix),!1,ft),At.uniformMatrix4fv(vt.getUniformLocation(Q.SHADER_GPU_PARTICLE_CONFIG.uniforms.modelViewMatrix),!1,at.getModelViewMatrix()),At.uniform3fv(vt.getUniformLocation(Q.SHADER_GPU_PARTICLE_CONFIG.uniforms.position),[0,0,0]),At.uniform1f(vt.getUniformLocation(Q.SHADER_GPU_PARTICLE_CONFIG.uniforms.uTime),t.time),At.uniform1f(vt.getUniformLocation(Q.SHADER_GPU_PARTICLE_CONFIG.uniforms.uScale),n+a*e),At.uniform1i(vt.getUniformLocation(Q.SHADER_GPU_PARTICLE_CONFIG.uniforms.tSprite),1);var r=vt.getAttribLocation(Q.SHADER_GPU_PARTICLE_CONFIG.attributes.particlePositionsStartTime),o=vt.getAttribLocation(Q.SHADER_GPU_PARTICLE_CONFIG.attributes.particleVelColSizeLife);At.bindBuffer(At.ARRAY_BUFFER,t.geometryPosStartBuffer),At.enableVertexAttribArray(r),At.vertexAttribPointer(r,4,At.FLOAT,!1,0,0),At.bindBuffer(At.ARRAY_BUFFER,t.geometryVelColBuffer),At.enableVertexAttribArray(o),At.vertexAttribPointer(o,4,At.FLOAT,!1,0,0),At.drawArrays(At.POINTS,0,t.PARTICLE_COUNT),At.disableVertexAttribArray(r),At.disableVertexAttribArray(o)}function d(t,e,n,a){var r=10,o=100,i=w.clamp(e);Rt.isPlaying()&&(tt.rotateY(dt,dt,.01*i),tt.rotateZ(dt,dt,.009*i));for(var u=0;u<ut.length;u++){var l=ut[u],s=r*n,c=G.COLORS[u].toValue();l.update(e,t);for(var f=0;f<s&&f<o;f++){var h=2*u*Math.PI/ut.length,d=1.25,M=et.fromValues(d*Math.cos(h),d*Math.sin(h),0),m=et.normalize(et.create(),M);l.spawnParticle({position:M,velocity:m,velocityRandomness:.5,color:c,colorRandomness:0,lifetime:3,sizeRandomness:.4})}}}function M(){var t=tt.create(),e=ht.clientWidth/ht.clientHeight,n=50,a=.1,r=1e3;return tt.perspective(t,w.degreesToRadians(n),e,a,r),t}function m(){wt.loadPredefinedUrl(yt)}function v(){Tt&&Et&&(Tt=!1,m()),S(),D(),bt.begin();var t=1*it.getDelta();mt+=t,mt<0&&(mt=0);var e=Rt.getNormalizedFrequencyData()||{},n=[];if(Rt.isPlaying()&&e.bins&&(n=e.bins),t>0&&d(At,mt,t,n),xt.blur&&At.bindFramebuffer(At.FRAMEBUFFER,Pt),At.clear(At.COLOR_BUFFER_BIT|At.DEPTH_BUFFER_BIT),Et)for(var a=0;a<ut.length;a++)h(ut[a],n[a]);if(xt.blur){At.bindFramebuffer(At.FRAMEBUFFER,null),At.useProgram(pt.getProgram());var r=pt.getAttribLocation(Q.QUAD_SHADER_CONFIG.attributes.vertices);At.enableVertexAttribArray(r);var o=0;xt.blur&&(o=e.average||0),At.activeTexture(At.TEXTURE0),At.uniform1i(pt.getUniformLocation(Q.QUAD_SHADER_CONFIG.uniforms.texture),0),At.uniform1f(pt.getUniformLocation(Q.QUAD_SHADER_CONFIG.uniforms.width),ht.clientWidth),At.uniform1f(pt.getUniformLocation(Q.QUAD_SHADER_CONFIG.uniforms.height),ht.clientHeight),At.uniform1f(pt.getUniformLocation(Q.QUAD_SHADER_CONFIG.uniforms.volume),o),At.bindBuffer(At.ARRAY_BUFFER,Ot),At.vertexAttribPointer(r,2,At.FLOAT,!1,0,0),At.drawArrays(At.TRIANGLES,0,6),At.disableVertexAttribArray(r)}Rt&&Rt.isPlaying()&&xt.showBars&&f(),bt.end(),requestAnimationFrame(v)}function S(){var t=rt.getActiveActions();0!==t.length&&t.forEach(function(t){ot[t]&&ot[t]()})}function p(){$(document).on("mousemove",function(t){var e=t.clientX,n=t.clientY;st.x=e,st.y=n})}function x(){var t=$(document);t.on("keydown",function(t){var e=t.keyCode;rt.setKeyActive(e)}),t.on("keyup",function(t){var e=t.keyCode;rt.setKeyInactive(e)}),rt.registerKeyAction(K.VK_W,J.CAMERA_MOVE_POS_Z),rt.registerKeyAction(K.VK_S,J.CAMERA_MOVE_NEG_Z),rt.registerKeyAction(K.VK_A,J.CAMERA_MOVE_POS_X),rt.registerKeyAction(K.VK_D,J.CAMERA_MOVE_NEG_X),rt.registerKeyAction(K.VK_ARROW_LEFT,J.CAMERA_MOVE_NEG_YAW),rt.registerKeyAction(K.VK_ARROW_RIGHT,J.CAMERA_MOVE_POS_YAW),rt.registerKeyAction(K.VK_ARROW_UP,J.CAMERA_MOVE_POS_PITCH),rt.registerKeyAction(K.VK_ARROW_DOWN,J.CAMERA_MOVE_NEG_PITCH),ot[J.CAMERA_MOVE_POS_YAW]=function(){return at.updateYaw(1)},ot[J.CAMERA_MOVE_NEG_YAW]=function(){return at.updateYaw(-1)},ot[J.CAMERA_MOVE_POS_PITCH]=function(){return at.updatePitch(1)},ot[J.CAMERA_MOVE_NEG_PITCH]=function(){return at.updatePitch(-1)},ot[J.CAMERA_MOVE_POS_X]=function(){return at.updateX(1)},ot[J.CAMERA_MOVE_NEG_X]=function(){return at.updateX(-1)},ot[J.CAMERA_MOVE_POS_Y]=function(){return at.updateY(1)},ot[J.CAMERA_MOVE_NEG_Y]=function(){return at.updateY(-1)},ot[J.CAMERA_MOVE_POS_Z]=function(){return at.updateZ(1)},ot[J.CAMERA_MOVE_NEG_Z]=function(){return at.updateZ(-1)}}function I(){bt=new Stats,bt.setMode(0),bt.domElement.style.position="absolute",bt.domElement.style.right="0",bt.domElement.style.top="auto",bt.domElement.style.bottom="0",document.body.appendChild(bt.domElement)}function y(){vt.compile(At),St.compile(At),pt.compile(At)}function b(){ht=document.getElementById("canvas"),ft=M(),I(),p(),x(),wt.bind(),At=i(ht),c(),y();for(var t=0;t<ut.length;t++)ut[t].init(At);At.enable(At.BLEND),At.blendEquation(At.FUNC_ADD),At.blendFunc(At.SRC_ALPHA,At.ONE),At.viewport(0,0,At.drawingBufferWidth,At.drawingBufferHeight),At.clearColor(0,0,0,1),At.disable(At.DEPTH_TEST),At.clear(At.COLOR_BUFFER_BIT|At.DEPTH_BUFFER_BIT),requestAnimationFrame(v)}function _(t){var e=At.canvas,n=e.clientWidth,a=e.clientHeight,r=e.clientTop,o=e.clientLeft;ct.top=r,ct.left=o,ct.width=n,ct.height=a}function D(){_(At.canvas);var t=At.canvas.clientWidth,e=At.canvas.clientHeight;At.canvas.width==t&&At.canvas.height==e||(l(),At.canvas.width=t,At.canvas.height=e,At.viewport(0,0,At.drawingBufferWidth,At.drawingBufferHeight)),ft=M()}var A=n(5),g=r(A),F=n(6),E=r(F),R=n(16),w=a(R),P=n(17),C=a(P),O=n(18),T=r(O),L=n(19),N=r(L),k=n(27),U=r(k),z=n(29),V=r(z),Y=n(30),q=r(Y),B=n(32),j=r(B),G=n(33),H=n(34),X=r(H),Q=n(46),W=n(47),K=a(W),Z=n(48),J=a(Z);n(49),window.VISUAL_AUDIO={VERSION:window.VERSION},E.default.glMatrix.setMatrixArrayType(Float32Array);for(var tt=E.default.mat4,et=E.default.vec3,nt=E.default.vec4,at=new T.default,rt=new j.default,ot={},it=new V.default(!0),ut=[],lt=8,st={x:0,y:0},ct={top:0,left:0,width:0,height:0},ft=null,ht=null,dt=tt.create(),Mt=0;Mt<lt;Mt++)ut[Mt]=new q.default;var mt=0,vt=new X.default(Q.SHADER_GPU_PARTICLE_CONFIG),St=new X.default(Q.BAR_SHADER_CONFIG),pt=new X.default(Q.QUAD_SHADER_CONFIG),xt={maxParticles:5e3,emissionRate:2,blur:!1,showBars:!0},It=C.getQueryParams(),yt=It.media;try{It.max&&parseInt(It.max)&&parseInt(It.max)>0&&(xt.maxParticles=parseInt(It.max)),It.rate&&parseInt(It.rate)&&parseInt(It.rate)>0&&(xt.emissionRate=parseInt(It.rate)),It.bars&&(xt.showBars=o(It.bars)),It.blur&&(xt.blur=o(It.blur))}catch(t){console.error&&console.error(t)}(0,g.default)(),document.addEventListener("DOMContentLoaded",b);var bt=void 0,_t=void 0,Dt=void 0,At=void 0,gt=void 0,Ft=void 0,Et=!1,Rt=new U.default,wt=new N.default(Rt),Pt=void 0,Ct=void 0,Ot=void 0,Tt=!0},function(t,e){"use strict";function n(){window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext,window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,window.navigator.getUserMedia=window.navigator.getUserMedia||window.navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia||window.navigator.msGetUserMedia}t.exports=function(){n()}},function(t,e,n){e.glMatrix=n(7),e.mat2=n(8),e.mat2d=n(9),e.mat3=n(10),e.mat4=n(11),e.quat=n(12),e.vec2=n(15),e.vec3=n(13),e.vec4=n(14)},function(t,e){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.ENABLE_SIMD=!1,n.SIMD_AVAILABLE=n.ARRAY_TYPE===Float32Array&&"SIMD"in this,n.USE_SIMD=n.ENABLE_SIMD&&n.SIMD_AVAILABLE,n.setMatrixArrayType=function(t){n.ARRAY_TYPE=t};var a=Math.PI/180;n.toRadian=function(t){return t*a},n.equals=function(t,e){return Math.abs(t-e)<=n.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},t.exports=n},function(t,e,n){var a=n(7),r={};r.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.clone=function(t){var e=new a.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.fromValues=function(t,e,n,r){var o=new a.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o},r.set=function(t,e,n,a,r){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t},r.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},r.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n*o-r*a;return i?(i=1/i,t[0]=o*i,t[1]=-a*i,t[2]=-r*i,t[3]=n*i,t):null},r.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},r.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},r.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=n[0],l=n[1],s=n[2],c=n[3];return t[0]=a*u+o*l,t[1]=r*u+i*l,t[2]=a*s+o*c,t[3]=r*s+i*c,t},r.mul=r.multiply,r.rotate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(n),l=Math.cos(n);return t[0]=a*l+o*u,t[1]=r*l+i*u,t[2]=a*-u+o*l,t[3]=r*-u+i*l,t},r.scale=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=n[0],l=n[1];return t[0]=a*u,t[1]=r*u,t[2]=o*l,t[3]=i*l,t},r.fromRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=-n,t[3]=a,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},r.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},r.LDU=function(t,e,n,a){return t[2]=a[2]/a[0],n[0]=a[0],n[1]=a[1],n[3]=a[3]-t[2]*n[1],[t,e,n]},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},r.sub=r.subtract,r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=e[0],l=e[1],s=e[2],c=e[3];return Math.abs(n-u)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-l)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-s)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-c)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},r.multiplyScalarAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t},t.exports=r},function(t,e,n){var a=n(7),r={};r.create=function(){var t=new a.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.clone=function(t){var e=new a.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.fromValues=function(t,e,n,r,o,i){var u=new a.ARRAY_TYPE(6);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=o,u[5]=i,u},r.set=function(t,e,n,a,r,o,i){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t[4]=o,t[5]=i,t},r.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=n*o-a*r;return l?(l=1/l,t[0]=o*l,t[1]=-a*l,t[2]=-r*l,t[3]=n*l,t[4]=(r*u-o*i)*l,t[5]=(a*i-n*u)*l,t):null},r.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},r.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=n[0],c=n[1],f=n[2],h=n[3],d=n[4],M=n[5];return t[0]=a*s+o*c,t[1]=r*s+i*c,t[2]=a*f+o*h,t[3]=r*f+i*h,t[4]=a*d+o*M+u,t[5]=r*d+i*M+l,t},r.mul=r.multiply,r.rotate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=Math.sin(n),c=Math.cos(n);return t[0]=a*c+o*s,t[1]=r*c+i*s,t[2]=a*-s+o*c,t[3]=r*-s+i*c,t[4]=u,t[5]=l,t},r.scale=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=n[0],c=n[1];return t[0]=a*s,t[1]=r*s,t[2]=o*c,t[3]=i*c,t[4]=u,t[5]=l,t},r.translate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=n[0],c=n[1];return t[0]=a,t[1]=r,t[2]=o,t[3]=i,t[4]=a*s+o*c+u,t[5]=r*s+i*c+l,t},r.fromRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=-n,t[3]=a,t[4]=0,t[5]=0,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},r.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},r.multiplyScalarAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t[4]=e[4]+n[4]*a,t[5]=e[5]+n[5]*a,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=e[0],c=e[1],f=e[2],h=e[3],d=e[4],M=e[5];return Math.abs(n-s)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-c)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(o-f)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(i-h)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(u-d)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(d))&&Math.abs(l-M)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(M))},t.exports=r},function(t,e,n){var a=n(7),r={};r.create=function(){var t=new a.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},r.clone=function(t){var e=new a.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromValues=function(t,e,n,r,o,i,u,l,s){var c=new a.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=o,c[5]=i,c[6]=u,c[7]=l,c[8]=s,c},r.set=function(t,e,n,a,r,o,i,u,l,s){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t[4]=o,t[5]=i,t[6]=u,t[7]=l,t[8]=s,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.transpose=function(t,e){if(t===e){var n=e[1],a=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=a,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},r.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=c*i-u*s,h=-c*o+u*l,d=s*o-i*l,M=n*f+a*h+r*d;return M?(M=1/M,t[0]=f*M,t[1]=(-c*a+r*s)*M,t[2]=(u*a-r*i)*M,t[3]=h*M,t[4]=(c*n-r*l)*M,t[5]=(-u*n+r*o)*M,t[6]=d*M,t[7]=(-s*n+a*l)*M,t[8]=(i*n-a*o)*M,t):null},r.adjoint=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8];return t[0]=i*c-u*s,t[1]=r*s-a*c,t[2]=a*u-r*i,t[3]=u*l-o*c,t[4]=n*c-r*l,t[5]=r*o-n*u,t[6]=o*s-i*l,t[7]=a*l-n*s,t[8]=n*i-a*o,t},r.determinant=function(t){var e=t[0],n=t[1],a=t[2],r=t[3],o=t[4],i=t[5],u=t[6],l=t[7],s=t[8];return e*(s*o-i*l)+n*(-s*r+i*u)+a*(l*r-o*u)},r.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=n[0],d=n[1],M=n[2],m=n[3],v=n[4],S=n[5],p=n[6],x=n[7],I=n[8];return t[0]=h*a+d*i+M*s,t[1]=h*r+d*u+M*c,t[2]=h*o+d*l+M*f,t[3]=m*a+v*i+S*s,t[4]=m*r+v*u+S*c,t[5]=m*o+v*l+S*f,t[6]=p*a+x*i+I*s,t[7]=p*r+x*u+I*c,t[8]=p*o+x*l+I*f,t},r.mul=r.multiply,r.translate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=n[0],d=n[1];return t[0]=a,t[1]=r,t[2]=o,t[3]=i,t[4]=u,t[5]=l,t[6]=h*a+d*i+s,t[7]=h*r+d*u+c,t[8]=h*o+d*l+f,t},r.rotate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=Math.sin(n),d=Math.cos(n);return t[0]=d*a+h*i,t[1]=d*r+h*u,t[2]=d*o+h*l,t[3]=d*i-h*a,t[4]=d*u-h*r,t[5]=d*l-h*o,t[6]=s,t[7]=c,t[8]=f,t},r.scale=function(t,e,n){var a=n[0],r=n[1];return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},r.fromRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=0,t[3]=-n,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},r.fromQuat=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n+n,u=a+a,l=r+r,s=n*i,c=a*i,f=a*u,h=r*i,d=r*u,M=r*l,m=o*i,v=o*u,S=o*l;return t[0]=1-f-M,t[3]=c-S,t[6]=h+v,t[1]=c+S,t[4]=1-s-M,t[7]=d-m,t[2]=h-v,t[5]=d+m,t[8]=1-s-f,t},r.normalFromMat4=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=e[9],h=e[10],d=e[11],M=e[12],m=e[13],v=e[14],S=e[15],p=n*u-a*i,x=n*l-r*i,I=n*s-o*i,y=a*l-r*u,b=a*s-o*u,_=r*s-o*l,D=c*m-f*M,A=c*v-h*M,g=c*S-d*M,F=f*v-h*m,E=f*S-d*m,R=h*S-d*v,w=p*R-x*E+I*F+y*g-b*A+_*D;return w?(w=1/w,t[0]=(u*R-l*E+s*F)*w,t[1]=(l*g-i*R-s*A)*w,t[2]=(i*E-u*g+s*D)*w,t[3]=(r*E-a*R-o*F)*w,t[4]=(n*R-r*g+o*A)*w,t[5]=(a*g-n*E-o*D)*w,t[6]=(m*_-v*b+S*y)*w,t[7]=(v*I-M*_-S*x)*w,t[8]=(M*b-m*I+S*p)*w,t):null},r.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},r.multiplyScalarAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t[4]=e[4]+n[4]*a,t[5]=e[5]+n[5]*a,t[6]=e[6]+n[6]*a,t[7]=e[7]+n[7]*a,t[8]=e[8]+n[8]*a,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=t[6],c=t[7],f=t[8],h=e[0],d=e[1],M=e[2],m=e[3],v=e[4],S=e[5],p=t[6],x=e[7],I=e[8];return Math.abs(n-h)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-d)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(o-M)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(i-m)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(u-v)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(l-S)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(s-p)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(c-x)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(f-I)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(I))},t.exports=r},function(t,e,n){var a=n(7),r={scalar:{},SIMD:{}};r.create=function(){var t=new a.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.clone=function(t){var e=new a.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.fromValues=function(t,e,n,r,o,i,u,l,s,c,f,h,d,M,m,v){var S=new a.ARRAY_TYPE(16);return S[0]=t,S[1]=e,S[2]=n,S[3]=r,S[4]=o,S[5]=i,S[6]=u,S[7]=l,S[8]=s,S[9]=c,S[10]=f,S[11]=h,S[12]=d,S[13]=M,S[14]=m,S[15]=v,S},r.set=function(t,e,n,a,r,o,i,u,l,s,c,f,h,d,M,m,v){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t[4]=o,t[5]=i,t[6]=u,t[7]=l,t[8]=s,t[9]=c,t[10]=f,t[11]=h,t[12]=d,t[13]=M,t[14]=m,t[15]=v,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.scalar.transpose=function(t,e){if(t===e){var n=e[1],a=e[2],r=e[3],o=e[6],i=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=a,t[9]=o,t[11]=e[14],t[12]=r,t[13]=i,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},r.SIMD.transpose=function(t,e){var n,a,r,o,i,u,l,s,c,f;return n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),r=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),i=SIMD.Float32x4.shuffle(n,a,0,1,4,5),u=SIMD.Float32x4.shuffle(r,o,0,1,4,5),l=SIMD.Float32x4.shuffle(i,u,0,2,4,6),s=SIMD.Float32x4.shuffle(i,u,1,3,5,7),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,s),i=SIMD.Float32x4.shuffle(n,a,2,3,6,7),u=SIMD.Float32x4.shuffle(r,o,2,3,6,7),c=SIMD.Float32x4.shuffle(i,u,0,2,4,6),f=SIMD.Float32x4.shuffle(i,u,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,f),t},r.transpose=a.USE_SIMD?r.SIMD.transpose:r.scalar.transpose,r.scalar.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=e[9],h=e[10],d=e[11],M=e[12],m=e[13],v=e[14],S=e[15],p=n*u-a*i,x=n*l-r*i,I=n*s-o*i,y=a*l-r*u,b=a*s-o*u,_=r*s-o*l,D=c*m-f*M,A=c*v-h*M,g=c*S-d*M,F=f*v-h*m,E=f*S-d*m,R=h*S-d*v,w=p*R-x*E+I*F+y*g-b*A+_*D;return w?(w=1/w,t[0]=(u*R-l*E+s*F)*w,t[1]=(r*E-a*R-o*F)*w,t[2]=(m*_-v*b+S*y)*w,t[3]=(h*b-f*_-d*y)*w,t[4]=(l*g-i*R-s*A)*w,t[5]=(n*R-r*g+o*A)*w,t[6]=(v*I-M*_-S*x)*w,t[7]=(c*_-h*I+d*x)*w,t[8]=(i*E-u*g+s*D)*w,t[9]=(a*g-n*E-o*D)*w,t[10]=(M*b-m*I+S*p)*w,t[11]=(f*I-c*b-d*p)*w,t[12]=(u*A-i*F-l*D)*w,t[13]=(n*F-a*A+r*D)*w,t[14]=(m*x-M*y-v*p)*w,t[15]=(c*y-f*x+h*p)*w,t):null},r.SIMD.invert=function(t,e){var n,a,r,o,i,u,l,s,c,f,h=SIMD.Float32x4.load(e,0),d=SIMD.Float32x4.load(e,4),M=SIMD.Float32x4.load(e,8),m=SIMD.Float32x4.load(e,12);return i=SIMD.Float32x4.shuffle(h,d,0,1,4,5),a=SIMD.Float32x4.shuffle(M,m,0,1,4,5),n=SIMD.Float32x4.shuffle(i,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,i,1,3,5,7),i=SIMD.Float32x4.shuffle(h,d,2,3,6,7),o=SIMD.Float32x4.shuffle(M,m,2,3,6,7),r=SIMD.Float32x4.shuffle(i,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,i,1,3,5,7),i=SIMD.Float32x4.mul(r,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.mul(a,i),l=SIMD.Float32x4.mul(n,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),u),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),i=SIMD.Float32x4.mul(a,r),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),u),c=SIMD.Float32x4.mul(n,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,i)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),i=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,3,0,1),o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),r=SIMD.Float32x4.swizzle(r,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),u),s=SIMD.Float32x4.mul(n,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(r,i)),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),i=SIMD.Float32x4.mul(n,a),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),s),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),c),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),s),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(r,i)),i=SIMD.Float32x4.mul(n,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,i)),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),s),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),l),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(a,i)),i=SIMD.Float32x4.mul(n,r),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(a,i)),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(o,i)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),c),f=SIMD.Float32x4.mul(n,u),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f),i=SIMD.Float32x4.reciprocalApproximation(f),f=SIMD.Float32x4.sub(SIMD.Float32x4.add(i,i),SIMD.Float32x4.mul(f,SIMD.Float32x4.mul(i,i))),(f=SIMD.Float32x4.swizzle(f,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(f,u)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(f,l)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(f,s)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(f,c)),t):null},r.invert=a.USE_SIMD?r.SIMD.invert:r.scalar.invert,r.scalar.adjoint=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=e[9],h=e[10],d=e[11],M=e[12],m=e[13],v=e[14],S=e[15];return t[0]=u*(h*S-d*v)-f*(l*S-s*v)+m*(l*d-s*h),t[1]=-(a*(h*S-d*v)-f*(r*S-o*v)+m*(r*d-o*h)),t[2]=a*(l*S-s*v)-u*(r*S-o*v)+m*(r*s-o*l),t[3]=-(a*(l*d-s*h)-u*(r*d-o*h)+f*(r*s-o*l)),t[4]=-(i*(h*S-d*v)-c*(l*S-s*v)+M*(l*d-s*h)),t[5]=n*(h*S-d*v)-c*(r*S-o*v)+M*(r*d-o*h),t[6]=-(n*(l*S-s*v)-i*(r*S-o*v)+M*(r*s-o*l)),t[7]=n*(l*d-s*h)-i*(r*d-o*h)+c*(r*s-o*l),t[8]=i*(f*S-d*m)-c*(u*S-s*m)+M*(u*d-s*f),t[9]=-(n*(f*S-d*m)-c*(a*S-o*m)+M*(a*d-o*f)),t[10]=n*(u*S-s*m)-i*(a*S-o*m)+M*(a*s-o*u),t[11]=-(n*(u*d-s*f)-i*(a*d-o*f)+c*(a*s-o*u)),t[12]=-(i*(f*v-h*m)-c*(u*v-l*m)+M*(u*h-l*f)),t[13]=n*(f*v-h*m)-c*(a*v-r*m)+M*(a*h-r*f),t[14]=-(n*(u*v-l*m)-i*(a*v-r*m)+M*(a*l-r*u)),t[15]=n*(u*h-l*f)-i*(a*h-r*f)+c*(a*l-r*u),t},r.SIMD.adjoint=function(t,e){var n,a,r,o,i,u,l,s,c,f,h,d,M,n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),r=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12);return c=SIMD.Float32x4.shuffle(n,a,0,1,4,5),u=SIMD.Float32x4.shuffle(r,o,0,1,4,5),i=SIMD.Float32x4.shuffle(c,u,0,2,4,6),u=SIMD.Float32x4.shuffle(u,c,1,3,5,7),c=SIMD.Float32x4.shuffle(n,a,2,3,6,7),s=SIMD.Float32x4.shuffle(r,o,2,3,6,7),l=SIMD.Float32x4.shuffle(c,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,c,1,3,5,7),c=SIMD.Float32x4.mul(l,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.mul(u,c),h=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),f),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.mul(u,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),f),M=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(s,c)),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,3,0,1),s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),l=SIMD.Float32x4.swizzle(l,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),f),d=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(i,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),d),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),M),c=SIMD.Float32x4.swizzle(c,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),d),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(l,c)),c=SIMD.Float32x4.mul(i,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(i,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),h),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(u,c)),
c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(s,c)),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),M),SIMD.Float32x4.store(t,0,f),SIMD.Float32x4.store(t,4,h),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,M),t},r.adjoint=a.USE_SIMD?r.SIMD.adjoint:r.scalar.adjoint,r.determinant=function(t){var e=t[0],n=t[1],a=t[2],r=t[3],o=t[4],i=t[5],u=t[6],l=t[7],s=t[8],c=t[9],f=t[10],h=t[11],d=t[12],M=t[13],m=t[14],v=t[15],S=e*i-n*o,p=e*u-a*o,x=e*l-r*o,I=n*u-a*i,y=n*l-r*i,b=a*l-r*u,_=s*M-c*d,D=s*m-f*d,A=s*v-h*d,g=c*m-f*M,F=c*v-h*M,E=f*v-h*m;return S*E-p*F+x*g+I*A-y*D+b*_},r.SIMD.multiply=function(t,e,n){var a=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4.load(n,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),i))));SIMD.Float32x4.store(t,0,l);var s=SIMD.Float32x4.load(n,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),i))));SIMD.Float32x4.store(t,4,c);var f=SIMD.Float32x4.load(n,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),i))));SIMD.Float32x4.store(t,8,h);var d=SIMD.Float32x4.load(n,12),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),i))));return SIMD.Float32x4.store(t,12,M),t},r.scalar.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=e[9],d=e[10],M=e[11],m=e[12],v=e[13],S=e[14],p=e[15],x=n[0],I=n[1],y=n[2],b=n[3];return t[0]=x*a+I*u+y*f+b*m,t[1]=x*r+I*l+y*h+b*v,t[2]=x*o+I*s+y*d+b*S,t[3]=x*i+I*c+y*M+b*p,x=n[4],I=n[5],y=n[6],b=n[7],t[4]=x*a+I*u+y*f+b*m,t[5]=x*r+I*l+y*h+b*v,t[6]=x*o+I*s+y*d+b*S,t[7]=x*i+I*c+y*M+b*p,x=n[8],I=n[9],y=n[10],b=n[11],t[8]=x*a+I*u+y*f+b*m,t[9]=x*r+I*l+y*h+b*v,t[10]=x*o+I*s+y*d+b*S,t[11]=x*i+I*c+y*M+b*p,x=n[12],I=n[13],y=n[14],b=n[15],t[12]=x*a+I*u+y*f+b*m,t[13]=x*r+I*l+y*h+b*v,t[14]=x*o+I*s+y*d+b*S,t[15]=x*i+I*c+y*M+b*p,t},r.multiply=a.USE_SIMD?r.SIMD.multiply:r.scalar.multiply,r.mul=r.multiply,r.scalar.translate=function(t,e,n){var a,r,o,i,u,l,s,c,f,h,d,M,m=n[0],v=n[1],S=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*S+e[12],t[13]=e[1]*m+e[5]*v+e[9]*S+e[13],t[14]=e[2]*m+e[6]*v+e[10]*S+e[14],t[15]=e[3]*m+e[7]*v+e[11]*S+e[15]):(a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],h=e[9],d=e[10],M=e[11],t[0]=a,t[1]=r,t[2]=o,t[3]=i,t[4]=u,t[5]=l,t[6]=s,t[7]=c,t[8]=f,t[9]=h,t[10]=d,t[11]=M,t[12]=a*m+u*v+f*S+e[12],t[13]=r*m+l*v+h*S+e[13],t[14]=o*m+s*v+d*S+e[14],t[15]=i*m+c*v+M*S+e[15]),t},r.SIMD.translate=function(t,e,n){var a=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4(n[0],n[1],n[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(u,0,0,0,0)),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(u,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(u,2,2,2,2));var l=SIMD.Float32x4.add(a,SIMD.Float32x4.add(r,SIMD.Float32x4.add(o,i)));return SIMD.Float32x4.store(t,12,l),t},r.translate=a.USE_SIMD?r.SIMD.translate:r.scalar.translate,r.scalar.scale=function(t,e,n){var a=n[0],r=n[1],o=n[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.SIMD.scale=function(t,e,n){var a,r,o,i=SIMD.Float32x4(n[0],n[1],n[2],0);return a=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(i,0,0,0,0))),r=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(i,1,1,1,1))),o=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(i,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.scale=a.USE_SIMD?r.SIMD.scale:r.scalar.scale,r.rotate=function(t,e,n,r){var o,i,u,l,s,c,f,h,d,M,m,v,S,p,x,I,y,b,_,D,A,g,F,E,R=r[0],w=r[1],P=r[2],C=Math.sqrt(R*R+w*w+P*P);return Math.abs(C)<a.EPSILON?null:(C=1/C,R*=C,w*=C,P*=C,o=Math.sin(n),i=Math.cos(n),u=1-i,l=e[0],s=e[1],c=e[2],f=e[3],h=e[4],d=e[5],M=e[6],m=e[7],v=e[8],S=e[9],p=e[10],x=e[11],I=R*R*u+i,y=w*R*u+P*o,b=P*R*u-w*o,_=R*w*u-P*o,D=w*w*u+i,A=P*w*u+R*o,g=R*P*u+w*o,F=w*P*u-R*o,E=P*P*u+i,t[0]=l*I+h*y+v*b,t[1]=s*I+d*y+S*b,t[2]=c*I+M*y+p*b,t[3]=f*I+m*y+x*b,t[4]=l*_+h*D+v*A,t[5]=s*_+d*D+S*A,t[6]=c*_+M*D+p*A,t[7]=f*_+m*D+x*A,t[8]=l*g+h*F+v*E,t[9]=s*g+d*F+S*E,t[10]=c*g+M*F+p*E,t[11]=f*g+m*F+x*E,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},r.scalar.rotateX=function(t,e,n){var a=Math.sin(n),r=Math.cos(n),o=e[4],i=e[5],u=e[6],l=e[7],s=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+s*a,t[5]=i*r+c*a,t[6]=u*r+f*a,t[7]=l*r+h*a,t[8]=s*r-o*a,t[9]=c*r-i*a,t[10]=f*r-u*a,t[11]=h*r-l*a,t},r.SIMD.rotateX=function(t,e,n){var a=SIMD.Float32x4.splat(Math.sin(n)),r=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,a))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,r),SIMD.Float32x4.mul(o,a))),t},r.rotateX=a.USE_SIMD?r.SIMD.rotateX:r.scalar.rotateX,r.scalar.rotateY=function(t,e,n){var a=Math.sin(n),r=Math.cos(n),o=e[0],i=e[1],u=e[2],l=e[3],s=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-s*a,t[1]=i*r-c*a,t[2]=u*r-f*a,t[3]=l*r-h*a,t[8]=o*a+s*r,t[9]=i*a+c*r,t[10]=u*a+f*r,t[11]=l*a+h*r,t},r.SIMD.rotateY=function(t,e,n){var a=SIMD.Float32x4.splat(Math.sin(n)),r=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,a))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,r))),t},r.rotateY=a.USE_SIMD?r.SIMD.rotateY:r.scalar.rotateY,r.scalar.rotateZ=function(t,e,n){var a=Math.sin(n),r=Math.cos(n),o=e[0],i=e[1],u=e[2],l=e[3],s=e[4],c=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+s*a,t[1]=i*r+c*a,t[2]=u*r+f*a,t[3]=l*r+h*a,t[4]=s*r-o*a,t[5]=c*r-i*a,t[6]=f*r-u*a,t[7]=h*r-l*a,t},r.SIMD.rotateZ=function(t,e,n){var a=SIMD.Float32x4.splat(Math.sin(n)),r=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,a))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,r),SIMD.Float32x4.mul(o,a))),t},r.rotateZ=a.USE_SIMD?r.SIMD.rotateZ:r.scalar.rotateZ,r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotation=function(t,e,n){var r,o,i,u=n[0],l=n[1],s=n[2],c=Math.sqrt(u*u+l*l+s*s);return Math.abs(c)<a.EPSILON?null:(c=1/c,u*=c,l*=c,s*=c,r=Math.sin(e),o=Math.cos(e),i=1-o,t[0]=u*u*i+o,t[1]=l*u*i+s*r,t[2]=s*u*i-l*r,t[3]=0,t[4]=u*l*i-s*r,t[5]=l*l*i+o,t[6]=s*l*i+u*r,t[7]=0,t[8]=u*s*i+l*r,t[9]=l*s*i-u*r,t[10]=s*s*i+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},r.fromXRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromYRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromZRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotationTranslation=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=a+a,l=r+r,s=o+o,c=a*u,f=a*l,h=a*s,d=r*l,M=r*s,m=o*s,v=i*u,S=i*l,p=i*s;return t[0]=1-(d+m),t[1]=f+p,t[2]=h-S,t[3]=0,t[4]=f-p,t[5]=1-(c+m),t[6]=M+v,t[7]=0,t[8]=h+S,t[9]=M-v,t[10]=1-(c+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},r.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},r.getRotation=function(t,e){var n=e[0]+e[5]+e[10],a=0;return n>0?(a=2*Math.sqrt(n+1),t[3]=.25*a,t[0]=(e[6]-e[9])/a,t[1]=(e[8]-e[2])/a,t[2]=(e[1]-e[4])/a):e[0]>e[5]&e[0]>e[10]?(a=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/a,t[0]=.25*a,t[1]=(e[1]+e[4])/a,t[2]=(e[8]+e[2])/a):e[5]>e[10]?(a=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/a,t[0]=(e[1]+e[4])/a,t[1]=.25*a,t[2]=(e[6]+e[9])/a):(a=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/a,t[0]=(e[8]+e[2])/a,t[1]=(e[6]+e[9])/a,t[2]=.25*a),t},r.fromRotationTranslationScale=function(t,e,n,a){var r=e[0],o=e[1],i=e[2],u=e[3],l=r+r,s=o+o,c=i+i,f=r*l,h=r*s,d=r*c,M=o*s,m=o*c,v=i*c,S=u*l,p=u*s,x=u*c,I=a[0],y=a[1],b=a[2];return t[0]=(1-(M+v))*I,t[1]=(h+x)*I,t[2]=(d-p)*I,t[3]=0,t[4]=(h-x)*y,t[5]=(1-(f+v))*y,t[6]=(m+S)*y,t[7]=0,t[8]=(d+p)*b,t[9]=(m-S)*b,t[10]=(1-(f+M))*b,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},r.fromRotationTranslationScaleOrigin=function(t,e,n,a,r){var o=e[0],i=e[1],u=e[2],l=e[3],s=o+o,c=i+i,f=u+u,h=o*s,d=o*c,M=o*f,m=i*c,v=i*f,S=u*f,p=l*s,x=l*c,I=l*f,y=a[0],b=a[1],_=a[2],D=r[0],A=r[1],g=r[2];return t[0]=(1-(m+S))*y,t[1]=(d+I)*y,t[2]=(M-x)*y,t[3]=0,t[4]=(d-I)*b,t[5]=(1-(h+S))*b,t[6]=(v+p)*b,t[7]=0,t[8]=(M+x)*_,t[9]=(v-p)*_,t[10]=(1-(h+m))*_,t[11]=0,t[12]=n[0]+D-(t[0]*D+t[4]*A+t[8]*g),t[13]=n[1]+A-(t[1]*D+t[5]*A+t[9]*g),t[14]=n[2]+g-(t[2]*D+t[6]*A+t[10]*g),t[15]=1,t},r.fromQuat=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n+n,u=a+a,l=r+r,s=n*i,c=a*i,f=a*u,h=r*i,d=r*u,M=r*l,m=o*i,v=o*u,S=o*l;return t[0]=1-f-M,t[1]=c+S,t[2]=h-v,t[3]=0,t[4]=c-S,t[5]=1-s-M,t[6]=d+m,t[7]=0,t[8]=h+v,t[9]=d-m,t[10]=1-s-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.frustum=function(t,e,n,a,r,o,i){var u=1/(n-e),l=1/(r-a),s=1/(o-i);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(r+a)*l,t[10]=(i+o)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*s,t[15]=0,t},r.perspective=function(t,e,n,a,r){var o=1/Math.tan(e/2),i=1/(a-r);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+a)*i,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*a*i,t[15]=0,t},r.perspectiveFromFieldOfView=function(t,e,n,a){var r=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),l=2/(i+u),s=2/(r+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-((i-u)*l*.5),t[9]=(r-o)*s*.5,t[10]=a/(n-a),t[11]=-1,t[12]=0,t[13]=0,t[14]=a*n/(n-a),t[15]=0,t},r.ortho=function(t,e,n,a,r,o,i){var u=1/(e-n),l=1/(a-r),s=1/(o-i);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(e+n)*u,t[13]=(r+a)*l,t[14]=(i+o)*s,t[15]=1,t},r.lookAt=function(t,e,n,o){var i,u,l,s,c,f,h,d,M,m,v=e[0],S=e[1],p=e[2],x=o[0],I=o[1],y=o[2],b=n[0],_=n[1],D=n[2];return Math.abs(v-b)<a.EPSILON&&Math.abs(S-_)<a.EPSILON&&Math.abs(p-D)<a.EPSILON?r.identity(t):(h=v-b,d=S-_,M=p-D,m=1/Math.sqrt(h*h+d*d+M*M),h*=m,d*=m,M*=m,i=I*M-y*d,u=y*h-x*M,l=x*d-I*h,m=Math.sqrt(i*i+u*u+l*l),m?(m=1/m,i*=m,u*=m,l*=m):(i=0,u=0,l=0),s=d*l-M*u,c=M*i-h*l,f=h*u-d*i,m=Math.sqrt(s*s+c*c+f*f),m?(m=1/m,s*=m,c*=m,f*=m):(s=0,c=0,f=0),t[0]=i,t[1]=s,t[2]=h,t[3]=0,t[4]=u,t[5]=c,t[6]=d,t[7]=0,t[8]=l,t[9]=f,t[10]=M,t[11]=0,t[12]=-(i*v+u*S+l*p),t[13]=-(s*v+c*S+f*p),t[14]=-(h*v+d*S+M*p),t[15]=1,t)},r.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},r.multiplyScalarAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t[4]=e[4]+n[4]*a,t[5]=e[5]+n[5]*a,t[6]=e[6]+n[6]*a,t[7]=e[7]+n[7]*a,t[8]=e[8]+n[8]*a,t[9]=e[9]+n[9]*a,t[10]=e[10]+n[10]*a,t[11]=e[11]+n[11]*a,t[12]=e[12]+n[12]*a,t[13]=e[13]+n[13]*a,t[14]=e[14]+n[14]*a,t[15]=e[15]+n[15]*a,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=t[6],c=t[7],f=t[8],h=t[9],d=t[10],M=t[11],m=t[12],v=t[13],S=t[14],p=t[15],x=e[0],I=e[1],y=e[2],b=e[3],_=e[4],D=e[5],A=e[6],g=e[7],F=e[8],E=e[9],R=e[10],w=e[11],P=e[12],C=e[13],O=e[14],T=e[15];return Math.abs(n-x)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(r-I)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(I))&&Math.abs(o-y)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(i-b)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(u-_)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(l-D)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(D))&&Math.abs(s-A)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(c-g)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(f-F)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(F))&&Math.abs(h-E)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(d-R)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(M-w)<=a.EPSILON*Math.max(1,Math.abs(M),Math.abs(w))&&Math.abs(m-P)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(v-C)<=a.EPSILON*Math.max(1,Math.abs(v),Math.abs(C))&&Math.abs(S-O)<=a.EPSILON*Math.max(1,Math.abs(S),Math.abs(O))&&Math.abs(p-T)<=a.EPSILON*Math.max(1,Math.abs(p),Math.abs(T))},t.exports=r},function(t,e,n){var a=n(7),r=n(10),o=n(13),i=n(14),u={};u.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),n=o.fromValues(0,1,0);return function(a,r,i){var l=o.dot(r,i);return l<-.999999?(o.cross(t,e,r),o.length(t)<1e-6&&o.cross(t,n,r),o.normalize(t,t),u.setAxisAngle(a,t,Math.PI),a):l>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(o.cross(t,r,i),a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=1+l,u.normalize(a,a))}}(),u.setAxes=function(){var t=r.create();return function(e,n,a,r){return t[0]=a[0],t[3]=a[1],t[6]=a[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],u.normalize(e,u.fromMat3(e,t))}}(),u.clone=i.clone,u.fromValues=i.fromValues,u.copy=i.copy,u.set=i.set,u.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.setAxisAngle=function(t,e,n){n*=.5;var a=Math.sin(n);return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=Math.cos(n),t},u.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),a=Math.sin(n/2);return 0!=a?(t[0]=e[0]/a,t[1]=e[1]/a,t[2]=e[2]/a):(t[0]=1,t[1]=0,t[2]=0),n},u.add=i.add,u.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=n[0],l=n[1],s=n[2],c=n[3];return t[0]=a*c+i*u+r*s-o*l,t[1]=r*c+i*l+o*u-a*s,t[2]=o*c+i*s+a*l-r*u,t[3]=i*c-a*u-r*l-o*s,t},u.mul=u.multiply,u.scale=i.scale,u.rotateX=function(t,e,n){n*=.5;var a=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(n),l=Math.cos(n);return t[0]=a*l+i*u,t[1]=r*l+o*u,t[2]=o*l-r*u,t[3]=i*l-a*u,t},u.rotateY=function(t,e,n){n*=.5;var a=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(n),l=Math.cos(n);return t[0]=a*l-o*u,t[1]=r*l+i*u,t[2]=o*l+a*u,t[3]=i*l-r*u,t},u.rotateZ=function(t,e,n){n*=.5;var a=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(n),l=Math.cos(n);return t[0]=a*l+r*u,t[1]=r*l-a*u,t[2]=o*l+i*u,t[3]=i*l-o*u,t},u.calculateW=function(t,e){var n=e[0],a=e[1],r=e[2];return t[0]=n,t[1]=a,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-a*a-r*r)),t},u.dot=i.dot,u.lerp=i.lerp,u.slerp=function(t,e,n,a){var r,o,i,u,l,s=e[0],c=e[1],f=e[2],h=e[3],d=n[0],M=n[1],m=n[2],v=n[3];return o=s*d+c*M+f*m+h*v,o<0&&(o=-o,d=-d,M=-M,m=-m,v=-v),1-o>1e-6?(r=Math.acos(o),i=Math.sin(r),u=Math.sin((1-a)*r)/i,l=Math.sin(a*r)/i):(u=1-a,l=a),t[0]=u*s+l*d,t[1]=u*c+l*M,t[2]=u*f+l*m,t[3]=u*h+l*v,t},u.sqlerp=function(){var t=u.create(),e=u.create();return function(n,a,r,o,i,l){return u.slerp(t,a,i,l),u.slerp(e,r,o,l),u.slerp(n,t,e,2*l*(1-l)),n}}(),u.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n*n+a*a+r*r+o*o,u=i?1/i:0;return t[0]=-n*u,t[1]=-a*u,t[2]=-r*u,t[3]=o*u,t},u.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},u.length=i.length,u.len=u.length,u.squaredLength=i.squaredLength,u.sqrLen=u.squaredLength,u.normalize=i.normalize,u.fromMat3=function(t,e){var n,a=e[0]+e[4]+e[8];if(a>0)n=Math.sqrt(a+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,i=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*i+i]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*o+i]-e[3*i+o])*n,t[o]=(e[3*o+r]+e[3*r+o])*n,t[i]=(e[3*i+r]+e[3*r+i])*n}return t},u.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},u.exactEquals=i.exactEquals,u.equals=i.equals,t.exports=u},function(t,e,n){var a=n(7),r={};r.create=function(){var t=new a.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},r.clone=function(t){var e=new a.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},r.fromValues=function(t,e,n){var r=new a.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=n,r},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},r.set=function(t,e,n,a){return t[0]=e,t[1]=n,t[2]=a,t},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},r.sub=r.subtract,r.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},r.mul=r.multiply,r.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},r.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},r.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},r.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},r.scaleAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t},r.distance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(n*n+a*a+r*r)},r.dist=r.distance,r.squaredDistance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2];return n*n+a*a+r*r},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],n=t[1],a=t[2];return Math.sqrt(e*e+n*n+a*a)},r.len=r.length,r.squaredLength=function(t){var e=t[0],n=t[1],a=t[2];return e*e+n*n+a*a},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},r.normalize=function(t,e){var n=e[0],a=e[1],r=e[2],o=n*n+a*a+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},r.cross=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=n[0],u=n[1],l=n[2];return t[0]=r*l-o*u,t[1]=o*i-a*l,t[2]=a*u-r*i,t},r.lerp=function(t,e,n,a){var r=e[0],o=e[1],i=e[2];return t[0]=r+a*(n[0]-r),t[1]=o+a*(n[1]-o),t[2]=i+a*(n[2]-i),t},r.hermite=function(t,e,n,a,r,o){var i=o*o,u=i*(2*o-3)+1,l=i*(o-2)+o,s=i*(o-1),c=i*(3-2*o);return t[0]=e[0]*u+n[0]*l+a[0]*s+r[0]*c,t[1]=e[1]*u+n[1]*l+a[1]*s+r[1]*c,t[2]=e[2]*u+n[2]*l+a[2]*s+r[2]*c,t},r.bezier=function(t,e,n,a,r,o){var i=1-o,u=i*i,l=o*o,s=u*i,c=3*o*u,f=3*l*i,h=l*o;return t[0]=e[0]*s+n[0]*c+a[0]*f+r[0]*h,t[1]=e[1]*s+n[1]*c+a[1]*f+r[1]*h,t[2]=e[2]*s+n[2]*c+a[2]*f+r[2]*h,t},r.random=function(t,e){e=e||1;var n=2*a.RANDOM()*Math.PI,r=2*a.RANDOM()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=r*e,t},r.transformMat4=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=n[3]*a+n[7]*r+n[11]*o+n[15];return i=i||1,t[0]=(n[0]*a+n[4]*r+n[8]*o+n[12])/i,t[1]=(n[1]*a+n[5]*r+n[9]*o+n[13])/i,t[2]=(n[2]*a+n[6]*r+n[10]*o+n[14])/i,t},r.transformMat3=function(t,e,n){var a=e[0],r=e[1],o=e[2];return t[0]=a*n[0]+r*n[3]+o*n[6],t[1]=a*n[1]+r*n[4]+o*n[7],t[2]=a*n[2]+r*n[5]+o*n[8],t},r.transformQuat=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=n[0],u=n[1],l=n[2],s=n[3],c=s*a+u*o-l*r,f=s*r+l*a-i*o,h=s*o+i*r-u*a,d=-i*a-u*r-l*o;return t[0]=c*s+d*-i+f*-l-h*-u,t[1]=f*s+d*-u+h*-i-c*-l,t[2]=h*s+d*-l+c*-u-f*-i,t},r.rotateX=function(t,e,n,a){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(a)-r[2]*Math.sin(a),o[2]=r[1]*Math.sin(a)+r[2]*Math.cos(a),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},r.rotateY=function(t,e,n,a){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(a)+r[0]*Math.cos(a),o[1]=r[1],o[2]=r[2]*Math.cos(a)-r[0]*Math.sin(a),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},r.rotateZ=function(t,e,n,a){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(a)-r[1]*Math.sin(a),o[1]=r[0]*Math.sin(a)+r[1]*Math.cos(a),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},r.forEach=function(){var t=r.create();return function(e,n,a,r,o,i){var u,l;for(n||(n=3),a||(a=0),l=r?Math.min(r*n+a,e.length):e.length,u=a;u<l;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}(),r.angle=function(t,e){var n=r.fromValues(t[0],t[1],t[2]),a=r.fromValues(e[0],e[1],e[2]);r.normalize(n,n),r.normalize(a,a);var o=r.dot(n,a);return o>1?0:Math.acos(o)},r.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=e[0],u=e[1],l=e[2];return Math.abs(n-i)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-u)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-l)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},t.exports=r},function(t,e,n){var a=n(7),r={};r.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},r.clone=function(t){var e=new a.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.fromValues=function(t,e,n,r){var o=new a.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.set=function(t,e,n,a,r){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},r.sub=r.subtract,r.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},r.mul=r.multiply,r.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},r.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},r.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},r.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},r.scaleAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t},r.distance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+a*a+r*r+o*o)},r.dist=r.distance,r.squaredDistance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return n*n+a*a+r*r+o*o},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],n=t[1],a=t[2],r=t[3];return Math.sqrt(e*e+n*n+a*a+r*r)},r.len=r.length,r.squaredLength=function(t){var e=t[0],n=t[1],a=t[2],r=t[3];return e*e+n*n+a*a+r*r},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},r.normalize=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n*n+a*a+r*r+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=n*i,t[1]=a*i,t[2]=r*i,t[3]=o*i),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},r.lerp=function(t,e,n,a){var r=e[0],o=e[1],i=e[2],u=e[3];return t[0]=r+a*(n[0]-r),t[1]=o+a*(n[1]-o),t[2]=i+a*(n[2]-i),t[3]=u+a*(n[3]-u),t},r.random=function(t,e){return e=e||1,t[0]=a.RANDOM(),t[1]=a.RANDOM(),t[2]=a.RANDOM(),t[3]=a.RANDOM(),r.normalize(t,t),r.scale(t,t,e),t},r.transformMat4=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3];return t[0]=n[0]*a+n[4]*r+n[8]*o+n[12]*i,t[1]=n[1]*a+n[5]*r+n[9]*o+n[13]*i,t[2]=n[2]*a+n[6]*r+n[10]*o+n[14]*i,t[3]=n[3]*a+n[7]*r+n[11]*o+n[15]*i,t},r.transformQuat=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=n[0],u=n[1],l=n[2],s=n[3],c=s*a+u*o-l*r,f=s*r+l*a-i*o,h=s*o+i*r-u*a,d=-i*a-u*r-l*o;return t[0]=c*s+d*-i+f*-l-h*-u,t[1]=f*s+d*-u+h*-i-c*-l,t[2]=h*s+d*-l+c*-u-f*-i,t[3]=e[3],t},r.forEach=function(){var t=r.create();return function(e,n,a,r,o,i){var u,l;for(n||(n=4),a||(a=0),l=r?Math.min(r*n+a,e.length):e.length,u=a;u<l;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}(),r.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=e[0],l=e[1],s=e[2],c=e[3];return Math.abs(n-u)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-l)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-s)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-c)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},t.exports=r},function(t,e,n){var a=n(7),r={};r.create=function(){var t=new a.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},r.clone=function(t){var e=new a.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},r.fromValues=function(t,e){var n=new a.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},r.set=function(t,e,n){return t[0]=e,t[1]=n,t},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},r.sub=r.subtract,r.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},r.mul=r.multiply,r.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},r.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},r.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},r.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},r.scaleAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t},r.distance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1];return Math.sqrt(n*n+a*a)},r.dist=r.distance,r.squaredDistance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1];return n*n+a*a},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},r.len=r.length,r.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},r.normalize=function(t,e){var n=e[0],a=e[1],r=n*n+a*a;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},r.cross=function(t,e,n){var a=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=a,t},r.lerp=function(t,e,n,a){var r=e[0],o=e[1];return t[0]=r+a*(n[0]-r),t[1]=o+a*(n[1]-o),t},r.random=function(t,e){e=e||1;var n=2*a.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},r.transformMat2=function(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[2]*r,t[1]=n[1]*a+n[3]*r,t},r.transformMat2d=function(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[2]*r+n[4],t[1]=n[1]*a+n[3]*r+n[5],t},r.transformMat3=function(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[3]*r+n[6],t[1]=n[1]*a+n[4]*r+n[7],t},r.transformMat4=function(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[4]*r+n[12],t[1]=n[1]*a+n[5]*r+n[13],t},r.forEach=function(){var t=r.create();return function(e,n,a,r,o,i){var u,l;for(n||(n=2),a||(a=0),l=r?Math.min(r*n+a,e.length):e.length,u=a;u<l;u+=n)t[0]=e[u],t[1]=e[u+1],o(t,t,i),e[u]=t[0],e[u+1]=t[1];return e}}(),r.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},r.equals=function(t,e){var n=t[0],r=t[1],o=e[0],i=e[1];return Math.abs(n-o)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-i)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))},t.exports=r},function(t,e){"use strict";function n(t){return t*(Math.PI/180)}function a(t){return t*(180/Math.PI)}function r(t,e){return Math.floor(Math.random()*(e-t+1))+t}function o(t,e){return Math.random()*(e-t)+t}function i(t,e,n,a){return d[0]=Math.floor(a),d[1]=Math.floor(n),d[2]=Math.floor(e),d[3]=Math.floor(t),M[0]}function u(t){var e=t.toString(16);return 1==e.length?"0"+e:e}function l(t,e,n){return"#"+u(t)+u(e)+u(n)}function s(t,e,n){return(t<<16)+(e<<8)+n}function c(t){var e=t>>16,n=(65280&t)>>8,a=255&t;
return e>0&&e--,n>0&&n--,a>0&&a--,[e,n,a]}function f(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e===n?1:(t-e)/(n-e)}function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t>=n?n:t<=e?e:t}Object.defineProperty(e,"__esModule",{value:!0}),e.degreesToRadians=n,e.radiansToDegrees=a,e.getRandomInt=r,e.getRandom=o,e.decodeFloat=i,e.componentToHex=u,e.rgbToHex=l,e.rgbToValue=s,e.hexToRgb=c,e.normalize=f,e.clamp=h;var d=new Uint8Array(4),M=new Float32Array(d.buffer)},function(t,e){"use strict";function n(){var t=window.location.search.substring(1)||"";if(""===t)return{};for(var e={},n=t.split("&"),a=0;a<n.length;a++){var r=n[a].split("=",2);1==r.length?e[r[0]]="":e[r[0]]=decodeURIComponent(r[1].replace(/\+/g," "))}return e}Object.defineProperty(e,"__esModule",{value:!0}),e.getQueryParams=n},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(6),i=o.mat4,u=.05,l=.05,s=[.5,.5,.5],c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-10;a(this,t),this.position=[e,n,r],this.pitch=0,this.yaw=0}return r(t,[{key:"moveTo",value:function(t,e,n){this.position=[t,e,n]}},{key:"getModelViewMatrix",value:function(){var t=i.create();return i.rotateX(t,t,-this.pitch),i.rotateY(t,t,this.yaw),i.translate(t,t,this.position),t}},{key:"updatePitch",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.pitch+=u*t}},{key:"updateYaw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.yaw+=l*t}},{key:"updateX",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.position[0]=this.position[0]+s[0]*t}},{key:"updateY",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.position[1]=this.position[1]+s[1]*t}},{key:"updateZ",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.position[2]=this.position[2]+s[2]*t}}]),t}();e.default=c},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n(20),u=a(i),l=n(22),s=a(l),c=n(23),f=a(c),h=n(26),d=a(h),M=n(27),m=n(21),v="#media-player",S="#audio-chooser",p="#file-chooser",x="#voice-chooser",I=".media-btn",y="#urlSource",b="#urlSourceForm",_=/soundcloud.com/,D=function(){function t(e){r(this,t),this.audioManager=e}return o(t,[{key:"bind",value:function(){var t=this;this.audioManager.registerStateListener(this.onAudioStateChange.bind(this)),this.audioManager.registerQueueListener(this.onQueueChanged.bind(this));var e=$(p),n=$(x),a=$("#media-controls [data-control='play']"),r=$("#media-controls [data-control='pause']"),o=$("#media-controls [data-control='stop']"),i=$("#media-controls [data-control='next']"),u=$(y),l=$(b);e.on("change",function(e){t.onFileChosen(e)}),n.on("click",function(e){t.onVoiceChosen(e)}),a.on("click",function(e){t.onPlayClicked(e)}),r.on("click",function(e){t.onPauseClicked(e)}),o.on("click",function(e){t.onStopClicked(e)}),i.on("click",function(e){t.onNextClicked(e)}),u.on("keyup, keydown",function(t){t.stopPropagation()}),u.on("input",function(e){e.stopPropagation(),t.matchUrlSources(u.val()),t.updateUrlHasText()}),u.on("blur",function(e){t.updateUrlHasText()}),l.on("submit",function(e){e.preventDefault(),e.stopPropagation(),t.onUrlInputUpdated(u.val()),u.blur()}),$("body").on("click","#media-queue [data-queue-index].close",function(e){return t.onRemoveQueueItem(e)}),this.init()}},{key:"init",value:function(){var t="public/samples/Broke_For_Free_-_01_-_Night_Owl.mp3";$(y).val(t),this.updateUrlHasText()}},{key:"loadPredefinedUrl",value:function(t){var e=this;t&&t.trim()&&($("body").addClass("has-predefined-media"),$("#start").one("click",function(){e.onUrlInputUpdated(t),$("body").removeClass("has-predefined-media")}))}},{key:"updateUrlHasText",value:function(){var t=$(y),e=t.val();e&&e.trim()?t.addClass("__hasText"):t.removeClass("__hasText")}},{key:"matchUrlSources",value:function(t){var e="active";$(".url-icons i.fa-soundcloud").toggleClass(e,_.test(t))}},{key:"onAudioStateChange",value:function(t,e){console.log("on state change %s %s",t,e);var n=this.audioManager.getCurrentSourceInfo();if(n&&n.type===m.SOURCE_TYPES.MIC)return void this.setMicControls();switch(t===M.AUDIO_STATE.OFF&&e===M.AUDIO_STATE.PLAYING&&(this.setControlsToStarted(),this.setQueueControls()),e){case M.AUDIO_STATE.OFF:this.setControlsToStopped(),this.setNowPlaying(null),this.resetQueueControls();break;case M.AUDIO_STATE.PLAYING:this.setControlsToPlaying(),this.displayCurrentSong();break;case M.AUDIO_STATE.PAUSED:this.setControlsToPaused()}this.renderMediaQueue()}},{key:"displayCurrentSong",value:function(){var t=this.audioManager.getCurrentSourceInfo()||{};this.setNowPlaying(t.label)}},{key:"onQueueChanged",value:function(){this.displayCurrentSong(),this.renderMediaQueue()}},{key:"addSource",value:function(t){var e=this;t.onLoaded(function(){console.log("SUCCESS"),e.audioManager.addMediaSource(t)},function(t){console.error("ERROR",t)})}},{key:"onFileChosen",value:function(t){var e=this;if(0!==t.target.files.length){var n=this.audioManager.getAudioContext(),a=Array.prototype.slice.call(t.target.files);a.forEach(function(t){var a=new u.default(n,t);e.addSource(a)}),this.resetFileChooser()}}},{key:"onVoiceChosen",value:function(){var t=this.audioManager.getCurrentSourceInfo();if(t&&t.type===m.SOURCE_TYPES.MIC)this.resetMicControls(),this.audioManager.stop();else{var e=this.audioManager.getAudioContext(),n=new s.default(e);this.addSource(n)}}},{key:"onPlayClicked",value:function(){this.audioManager.resume()}},{key:"onPauseClicked",value:function(){this.audioManager.pause()}},{key:"onStopClicked",value:function(t){this.audioManager.stop()}},{key:"onNextClicked",value:function(t){this.audioManager.playNext()}},{key:"setNowPlaying",value:function(t){$("#now-playing").text(t)}},{key:"setControlsToStarted",value:function(){$(v).removeClass("off").addClass("on")}},{key:"setControlsToStopped",value:function(){$(v).addClass("off").removeClass("on"),$(S).removeClass("no-select")}},{key:"resetFileChooser",value:function(){var t=$(S);t.wrap("<form>").closest("form").get(0).reset(),t.unwrap()}},{key:"setControlsToPaused",value:function(){var t=$(v);t.removeClass("playing"),t.addClass("paused")}},{key:"setControlsToPlaying",value:function(){var t=$(v);t.removeClass("paused"),t.addClass("playing")}},{key:"setMicControls",value:function(){var t=$(x),e=$(p),n=$(y);n.attr("disabled","disabled"),e.find("input, .media-btn").attr("disabled","disabled"),t.addClass("active")}},{key:"setQueueControls",value:function(){var t=$(x);t.find(""+I).attr("disabled","disabled")}},{key:"resetQueueControls",value:function(){var t=$(x);t.find(""+I).removeAttr("disabled")}},{key:"resetMicControls",value:function(){var t=$(x),e=$(p),n=$(y);n.removeAttr("disabled"),e.find("input, "+I).removeAttr("disabled"),t.removeClass("active")}},{key:"renderMediaSource",value:function(t,e){var n='<button type="button" class="close" data-queue-index='+e+' aria-label="Remove"><span aria-hidden="true"></span></button>';return"<li>"+n+'<span class="title" data-index="'+e+'">'+t.label+"</span></li>"}},{key:"onRemoveQueueItem",value:function(t){var e=$(t.target).attr("data-queue-index");this.audioManager.removeQueueIndex(e)}},{key:"renderMediaQueue",value:function(){var t=this,e=$("#media-queue"),n=this.audioManager.getQueueInfo().map(function(e,n){return t.renderMediaSource(e,n)}),a=$("<ul></ul>").append(n);e.empty().append(a)}},{key:"onUrlInputUpdated",value:function(t){var e=$(y);if(e.val(""),t&&t.trim()){var n=t.trim(),a=null,r=this.audioManager.getAudioContext();a=_.test(n)?new f.default(r,n):new d.default(r,n),a&&this.addSource(a)}}}]),t}();e.default=D},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t){return new Promise(function(e,n){var a=new FileReader;a.onload=function(t){var n=t.target.result;e(n)},a.onerror=function(t){console.error(t),n(t)},a.readAsArrayBuffer(t)})}function u(t,e){var n=t.createBufferSource();return n.buffer=e,n.start||(n.start=n.noteOn,n.stop=n.noteOff),n}function l(t,e){return new Promise(function(n,a){t.decodeAudioData(e,function(e){var a=u(t,e);n(a)},function(t){console.error(t),a(t)})})}Object.defineProperty(e,"__esModule",{value:!0});var s=n(21),c=function(t){function e(t,n){a(this,e);var o=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s.SOURCE_TYPES.FILE,t,!0));return o.file=n,o.fileName=n.name,o.label=o.fileName,o.isLoaded=!1,o.fileLoaderPromise=i(n).then(function(e){return l(t,e)}).then(function(t){return o.isLoaded=!0,o.audioNode=t,Promise.resolve()}).catch(function(t){return Promise.reject(t)}),o}return o(e,t),e}(s.MediaSource);e.default=c},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=e.SOURCE_TYPES={AUDIO_ELEMENT:"AUDIO_ELEMENT",FILE:"FILE",MIC:"MIC",SOUNDCLOUD:"SOUNDCLOUD"},u=function(t){function e(t){n(this,e);var r=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.message=t,r.name=r.constructor.name,r}return r(e,t),e}(Error),l="Invalid source type";e.MediaSource=function(){function t(e,a){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(n(this,t),!(e in i))throw new u(l);this.sourceType=e,this.audioContext=a,this.useSpeakerDestination=r,this.allowQueuing=o,this.label=null,this.metaData=null,this.isLoaded=!0,this.audioNode=null,this.fileLoaderPromise=Promise.resolve()}return o(t,[{key:"isLoaded",value:function(){return this.isLoaded}},{key:"onLoaded",value:function(t,e){this.fileLoaderPromise.then(t,e)}},{key:"shouldConnectDestination",value:function(){return this.useSpeakerDestination}},{key:"shouldAllowQueueing",value:function(){return this.allowQueuing}},{key:"getLabel",value:function(){return this.label}},{key:"getMetaData",value:function(){return this.metaData}},{key:"getType",value:function(){return this.sourceType}},{key:"getAudioNode",value:function(){return this.audioNode}}]),t}()},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t){return new Promise(function(e,n){navigator.getUserMedia(l,function(n){var a=t.createMediaStreamSource(n);e(a)},function(t){console.error(t),n(t)})})}Object.defineProperty(e,"__esModule",{value:!0});var u=n(21),l={audio:!0},s=function(t){function e(t,n){a(this,e);var o=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,u.SOURCE_TYPES.MIC,t,!1,!1));return o.file=n,o.isLoaded=!1,o.fileLoaderPromise=i(t).then(function(t){return o.isLoaded=!0,o.audioNode=t,Promise.resolve()}).catch(function(t){return Promise.reject(t)}),o}return o(e,t),e}(u.MediaSource);e.default=s},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t){return new f.default(t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),s=n(21),c=n(24),f=a(c),h=n(25),d=a(h),M=5e3,m=function(t){function e(t,n){r(this,e);var a=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s.SOURCE_TYPES.SOUNDCLOUD,t,!0));return a.url=n,a.label=n,a.isLoaded=!1,a.error=!1,a.soundCloudPlayer=u(d.default.apis.soundCloud.clientKey),a.soundCloudTrackInfo=null,a.onEndedCallbacks=[],a.fileLoaderPromise=Promise.race([new Promise(function(e,r){a.soundCloudPlayer.resolve(n,function(n){if(a.error)return console.log("error",a.error),void r(a.error);a.soundCloudTrackInfo=n,console.log(n);var o=a.soundCloudPlayer.audio;o.crossOrigin="anonymous",a.isLoaded=!0,a.audioNode=t.createMediaElementSource(o),e()})}),new Promise(function(t,e){setTimeout(function(){var t="SoundCloud request timed out";a.error=t,e(t)},M)})]),a}return i(e,t),l(e,[{key:"onEnded",value:function(t){this.onEndedCallbacks.push(t)}},{key:"_onEnd",value:function(){for(var t=0;t<this.onEndedCallbacks.length;t++)this.onEndedCallbacks[t]();this.onEndedCallbacks.splice(0)}},{key:"play",value:function(){var t=this;this.soundCloudPlayer.on("ended",function(){return t._onEnd()}),this.soundCloudPlayer.play()}}]),e}(s.MediaSource);e.default=m},function(t,e){"use strict";function n(t){o||(o=document.createElement("a")),o.href=t||"";for(var e={},n=0,a=i.length;n<a;n++){var r=i[n];e[r]=o[r]}return e}function a(t,e,a){var r=n(t),o=/\?(?:.*)$/,i=o.test(r.search)?"&":"?",u=r.protocol+"//"+r.host+r.port+r.pathname+r.search+i+e+"="+a+r.hash;return u}function r(t){if(!(this instanceof r))return new r(t);if(!t)throw new Error("SoundCloud API clientId is required, get it - https://developers.soundcloud.com/");this._events={},this._clientId=t,this._baseUrl="https://api.soundcloud.com",this.playing=!1,this.duration=0,this.audio=document.createElement("audio")}var o,i="protocol hostname host pathname port search hash href".split(" ");r.prototype.resolve=function(t,e){if(!t)throw new Error("SoundCloud track or playlist url is required");var a=this._baseUrl+"/resolve.json?url="+encodeURIComponent(t)+"&client_id="+this._clientId;this._json(a,function(a){if(this.cleanData(),Array.isArray(a)){var r=a;a={tracks:r},this._playlist=a}else if(a.tracks)this._playlist=a;else{this._track=a;var o=n(t);this._track.stream_url+=o.hash}this.duration=a.duration&&!isNaN(a.duration)?a.duration/1e3:0,e(a)}.bind(this))},r.prototype._jsonp=function(t,e){var n=document.getElementsByTagName("script")[0]||document.head,r=document.createElement("script"),o="jsonp_callback_"+(new Date).valueOf()+Math.floor(1e3*Math.random());window[o]=function(t){r.parentNode&&r.parentNode.removeChild(r),window[o]=function(){},e(t)},r.src=a(t,"callback",o),n.parentNode.insertBefore(r,n)},r.prototype._json=function(t,e){var n=new XMLHttpRequest;n.open("GET",t),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var t={};try{t=JSON.parse(n.responseText)}catch(t){}e(t)}},n.send(null)},r.prototype.on=function(t,e){this._events[t]=e,this.audio.addEventListener(t,e,!1)},r.prototype.off=function(t,e){this._events[t]=null,this.audio.removeEventListener(t,e)},r.prototype.unbindAll=function(){for(var t in this._events){var e=this._events[t];e&&this.off(t,e)}},r.prototype.preload=function(t){this._track={stream_url:t},this.audio.src=a(t,"client_id",this._clientId)},r.prototype.play=function(t){t=t||{};var e;if(t.streamUrl)e=t.streamUrl;else if(this._playlist){var n=this._playlist.tracks.length;if(n){if(this._playlistIndex=t.playlistIndex||0,this._playlistIndex>=n||this._playlistIndex<0)return void(this._playlistIndex=0);e=this._playlist.tracks[this._playlistIndex].stream_url}}else this._track&&(e=this._track.stream_url);if(!e)throw new Error("There is no tracks to play, use `streamUrl` option or `load` method");e=a(e,"client_id",this._clientId),e!==this.audio.src&&(this.audio.src=e),this.playing=e,this.audio.play()},r.prototype.pause=function(){this.audio.pause(),this.playing=!1},r.prototype.stop=function(){this.audio.pause(),this.audio.currentTime=0,this.playing=!1},r.prototype.next=function(){var t=this._playlist.tracks.length;this._playlistIndex>=t-1||this._playlist&&t&&this.play({playlistIndex:++this._playlistIndex})},r.prototype.previous=function(){this._playlistIndex<=0||this._playlist&&this._playlist.tracks.length&&this.play({playlistIndex:--this._playlistIndex})},r.prototype.seek=function(t){if(!this.audio.readyState)return!1;var e=t.offsetX/t.target.offsetWidth||(t.layerX-t.target.offsetLeft)/t.target.offsetWidth;this.audio.currentTime=e*(this.audio.duration||0)},r.prototype.cleanData=function(){this._track=void 0,this._playlist=void 0},t.exports=r},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={apis:{soundCloud:{clientKey:"59dfd35daaba9223150507c5d9d30da9"}}}},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(21),u=function(t){function e(t,n){a(this,e);var o=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i.SOURCE_TYPES.AUDIO_ELEMENT,t,!0));return o.url=n,o.label=n,o.isLoaded=!1,o.fileLoaderPromise=new Promise(function(e,a){var r=document.getElementById("audio");return r?(r.src=n,r.play(),e(t.createMediaElementSource(r))):a("Cannot init audio tag source")}).then(function(t){return o.isLoaded=!0,o.audioNode=t,Promise.resolve()}).catch(function(t){return Promise.reject(t)}),o}return o(e,t),e}(i.MediaSource);e.default=u},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.AUDIO_STATE=void 0;var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n(28),u=a(i),l=e.AUDIO_STATE={OFF:"OFF",PLAYING:"PLAYING",PAUSED:"PAUSED"},s=.85,c=function(){function t(){r(this,t),this.mediaQueue=new u.default,this.audioContext=new AudioContext,this.analyser=null,this.state=l.OFF,this.currentMediaSource=null,this.stateListeners=[],this.queueListeners=[]}return o(t,[{key:"getAudioContext",value:function(){return this.audioContext}},{key:"isPlaying",value:function(){return this.state===l.PLAYING}},{key:"addMediaSource",value:function(t){0!==this.mediaQueue.size()||this.isPlaying()?t.shouldAllowQueueing()?(this.mediaQueue.enqueue(t),this.notifyQueueListeners()):console.error("Attempt to enqueue source that doesn't allow queueing"):this.connectMediaSource(t)}},{key:"notifyQueueListeners",value:function(){for(var t=0;t<this.stateListeners.length;t++)this.queueListeners[t]()}},{key:"notifyStateListeners",value:function(t,e){for(var n=0;n<this.stateListeners.length;n++)this.stateListeners[n](t,e)}},{key:"setState",value:function(t){var e=this.state;this.state=t,this.notifyStateListeners(e,t)}},{key:"registerQueueListener",value:function(t){this.queueListeners.push(t)}},{key:"registerStateListener",value:function(t){this.stateListeners.push(t)}},{key:"getQueueInfo",value:function(){return this.mediaQueue.getDisplayValues()}},{key:"removeQueueIndex",value:function(t){this.mediaQueue.popIndex(t),this.notifyQueueListeners()}},{key:"getCurrentSourceInfo",value:function(){return this.currentMediaSource?{label:this.currentMediaSource.getLabel(),metadata:this.currentMediaSource.getMetaData(),type:this.currentMediaSource.getType()}:null}},{key:"playNext",value:function(){this.stop(!1),this.onMediaEnded()}},{key:"onMediaEnded",value:function(){if(console.log("song ended"),this.mediaQueue.size()>0){var t=this.mediaQueue.dequeue();this.notifyQueueListeners(),this.connectMediaSource(t)}else this.currentMediaSource=null,this.setState(l.OFF)}},{key:"connectMediaSource",value:function(t){var e=this;this.currentMediaSource=t;var n=this.currentMediaSource.getAudioNode();t.onEnded?t.onEnded(function(){return e.onMediaEnded()}):n.onended=function(){return e.onMediaEnded()};var a=void 0;this.currentMediaSource.shouldConnectDestination()&&(a=this.audioContext.destination),this.setupAudioNodes(n,a),n.start?n.start(0):t.play&&t.play(),this.setState(l.PLAYING)}},{key:"resume",value:function(){var t=this;"suspended"===this.audioContext.state&&this.audioContext.resume().then(function(){return t.setState(l.PLAYING)})}},{key:"pause",value:function(){var t=this;"running"===this.audioContext.state&&this.audioContext.suspend().then(function(){return t.setState(l.PAUSED)})}},{key:"stop",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.currentMediaSource;if(e&&e.getAudioNode()){var n=e.getAudioNode();if(n.mediaStream){var a=n.mediaStream;if(a.getAudioTracks())for(var r=0;r<a.getAudioTracks().length;r++)a.getAudioTracks()[r].stop&&a.getAudioTracks()[r].stop()}else n.stop&&n.stop();n.disconnect()}this.currentMediaSource=null,t&&(this.clearQueue(),this.setState(l.OFF))}},{key:"clearQueue",value:function(){this.mediaQueue.clear()}},{key:"createDefaultAnalyser",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,n=this.audioContext.createAnalyser();return n.smoothingTimeConstant=e,n.fftSize=t,n}},{key:"setupAudioNodes",value:function(t,e){var n=this.createDefaultAnalyser();t.connect(n),e&&n.connect(e),this.analyser=n}},{key:"getFrequencyBinCount",value:function(){return this.analyser.frequencyBinCount}},{key:"getNormalizedFrequencyData",value:function(){if(this.isPlaying()){var t=this.getFrequencyData();if(t&&t.length){for(var e=t.length,n={average:0,bins:[],max:0,min:255},a=8,r=e/a,o=0,i=0;i<e;i++){var u=Math.floor(i/r);n.bins[u]?n.bins[u]+=t[i]:n.bins[u]=t[i],t[i]>n.max&&(n.max=t[i]),t[i]<n.min&&(n.min=t[i]),o+=t[i]}for(var l=0;l<n.bins.length;l++)n.bins[l]=n.bins[l]/255/r;return n.max/=255,n.min/=255,n.average=o/255/e,n}}return null}},{key:"getFrequencyData",value:function(){var t=this.analyser;if(!t)return console.warn("no analyser"),null;var e=t.frequencyBinCount,n=new Uint8Array(e);return t.getByteFrequencyData(n),n}},{key:"getTimeDomainData",value:function(){var t=this.analyser,e=t.frequencyBinCount,n=new Uint8Array(e);return t.getByteTimeDomainData(n),n}}]),t}();e.default=c},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=function(){function t(){n(this,t),this.mediaSources=[]}return a(t,[{key:"enqueue",value:function(t){this.mediaSources.push(t)}},{key:"dequeue",value:function(){return this.popIndex(0)}},{key:"size",value:function(){return this.mediaSources.length}},{key:"popIndex",value:function(t){return this.mediaSources.splice(t,1)[0]}},{key:"clear",value:function(){this.mediaSources.splice(0,this.mediaSources.length)}},{key:"getDisplayValues",value:function(){return this.mediaSources.map(function(t){return{label:t.getLabel(),metadata:t.getMetaData(),type:t.getType()}})}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n(this,t),this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return a(t,[{key:"start",value:function(){this.startTime=Date.now(),this.oldTime=this.startTime,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1}},{key:"getElapsedTime",value:function(){return this.elapsedTime+=this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=Date.now();t=.001*(e-this.oldTime),this.oldTime=e,this.elapsedTime+=t}return t}}]),t}();e.default=r},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),u=n(16),l=r(u),s=n(31),c=a(s),f=1e5,h=window.devicePixelRatio,d=function(){function t(e){o(this,t),this.PARTICLE_COUNT=e||f,this.PARTICLE_CURSOR=0,this.time=0,this.randomsStore=new c.default(function(){return l.getRandom(-1,1)}),this.particles=[],this.deadParticles=[],this.particlesAvailableSlot=[],this.particleUpdate=!1,this.particleBuffers={vertices:new Float32Array(3*this.PARTICLE_COUNT),positionsStartTime:new Float32Array(4*this.PARTICLE_COUNT),velColSizeLife:new Float32Array(4*this.PARTICLE_COUNT)},this.geometryPosStart=new Float32Array(4*this.PARTICLE_COUNT),this.geometryVelCol=new Float32Array(4*this.PARTICLE_COUNT),this.offset=0,this.count=0}return i(t,[{key:"init",value:function(t){this.geometryPosStartBuffer=t.createBuffer(),this.geometryVelColBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.geometryPosStartBuffer),t.bufferData(t.ARRAY_BUFFER,this.geometryPosStart,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.geometryVelColBuffer),t.bufferData(t.ARRAY_BUFFER,this.geometryVelCol,t.DYNAMIC_DRAW);for(var e=this.particleBuffers,n=e.vertices,a=e.positionsStartTime,r=e.velColSizeLife,o=0;o<this.PARTICLE_COUNT;o++){var i=4*o,u=3*o;a[i]=0,a[i+1]=0,a[i+2]=0,a[i+3]=0,n[u]=0,n[u+1]=0,n[u+2]=0,r[i]=l.decodeFloat(128,128,0,0),r[i+1]=l.decodeFloat(0,255,0,255),r[i+2]=1,r[i+3]=0}}},{key:"spawnParticle",value:function(t){t=t||{};var e=[0,0,0],n=[0,0,0],a=0,r=0,o=16777215,i=0,u=0,s=0,c=0,f=0,d=void 0,M=2,m=250;e=void 0!==t.position?t.position:e,n=void 0!==t.velocity?t.velocity:n,a=void 0!==t.positionRandomness?t.positionRandomness:0,r=void 0!==t.velocityRandomness?t.velocityRandomness:0,o=void 0!==t.color?t.color:16777215,i=void 0!==t.colorRandomness?t.colorRandomness:1,u=void 0!==t.turbulence?t.turbulence:1,s=void 0!==t.lifetime?t.lifetime:5,c=void 0!==t.size?t.size:10,f=void 0!==t.sizeRandomness?t.sizeRandomness:0,d=void 0!==t.smoothPosition&&t.smoothPosition,void 0!==h&&(c*=h);var v=this.PARTICLE_CURSOR;this.geometryPosStart[4*v+0]=e[0]+this.randomsStore.random()*a,this.geometryPosStart[4*v+1]=e[1]+this.randomsStore.random()*a,this.geometryPosStart[4*v+2]=e[2]+this.randomsStore.random()*a,this.geometryPosStart[4*v+3]=this.time,d===!0&&(this.geometryPosStart[4*v+0]+=-(n[0]*this.randomsStore.random()),this.geometryPosStart[4*v+1]+=-(n[1]*this.randomsStore.random()),this.geometryPosStart[4*v+2]+=-(n[2]*this.randomsStore.random()));var S=n[0]+this.randomsStore.random()*r,p=n[1]+this.randomsStore.random()*r,x=n[2]+this.randomsStore.random()*r;u=Math.floor(255*u),S=Math.floor(m*((S- -M)/(M- -M))),p=Math.floor(m*((p- -M)/(M- -M))),x=Math.floor(m*((x- -M)/(M- -M))),this.geometryVelCol[4*v+0]=l.decodeFloat(S,p,x,u);for(var I=l.hexToRgb(o),y=0;y<I.length;y++)I[y]=Math.floor(I[y]+this.randomsStore.random()*i*255),I[y]>=255&&(I[y]=255),I[y]<=0&&(I[y]=0);this.geometryVelCol[4*v+1]=l.decodeFloat(I[0],I[1],I[2],255),this.geometryVelCol[4*v+2]=c+this.randomsStore.random()*f,this.geometryVelCol[4*v+3]=s,0==this.offset&&(this.offset=this.PARTICLE_CURSOR),this.count++,this.PARTICLE_CURSOR++,this.PARTICLE_CURSOR>=this.PARTICLE_COUNT&&(this.PARTICLE_CURSOR=0),this.particleUpdate=!0}},{key:"update",value:function(t,e){this.time=t,this.geometryUpdate(e)}},{key:"geometryUpdate",value:function(t){if(1==this.particleUpdate){if(this.particleUpdate=!1,this.count<this.PARTICLE_COUNT){var e=4*this.offset,n=e+4*this.count,a=4*e;t.bindBuffer(t.ARRAY_BUFFER,this.geometryPosStartBuffer),t.bufferSubData(t.ARRAY_BUFFER,a,this.geometryPosStart.subarray(e,n)),t.bindBuffer(t.ARRAY_BUFFER,this.geometryVelColBuffer),t.bufferSubData(t.ARRAY_BUFFER,a,this.geometryVelCol.subarray(e,n))}else t.bufferData(t.ARRAY_BUFFER,this.geometryPosStart,t.DYNAMIC_DRAW),t.bufferData(t.ARRAY_BUFFER,this.geometryVelColBuffer,t.DYNAMIC_DRAW);this.offset=0,this.count=0}}}]),t}();e.default=d},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");
}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=e.DEFAULT_MAX_RANDOMS=1e4,o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;n(this,t),this.MAX_RANDOMS=a,this.randoms=new Float32Array(this.MAX_RANDOMS),this.init(e),this.cursor=0}return a(t,[{key:"init",value:function(t){for(var e=0;e<this.randoms.length;e++)this.randoms[e]=t()}},{key:"random",value:function(){return this.cursor>=this.randoms.length&&(this.cursor=0),this.randoms[this.cursor++]}}]),t}();e.default=o},function(t,e){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=function(){function t(){a(this,t),this.keyStatus={},this.keysToActions={}}return r(t,[{key:"setKeyActive",value:function(t){this.keyStatus[t]=!0}},{key:"setKeyInactive",value:function(t){this.keyStatus[t]=!1}},{key:"isKeyActive",value:function(t){return!!this.keyStatus[t]}},{key:"registerKeyAction",value:function(t,e){this.keysToActions[t]=e}},{key:"getActiveActions",value:function(){var t=this,e=Object.keys(this.keyStatus).filter(function(e){return t.isKeyActive(e)}),a=new Set;return e.forEach(function(e){t.keysToActions[e]&&a.add(t.keysToActions[e])}),[].concat(n(a))}}]),t}();e.default=o},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.COLORS=e.COLOR_NAMES=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(16),i=function(){function t(e,n,r){a(this,t),this.r=e,this.g=n,this.b=r}return r(t,[{key:"toHexString",value:function(){var t=this.r,e=this.g,n=this.b;return(0,o.rgbToHex)(t,e,n)}},{key:"toValue",value:function(){var t=this.r,e=this.g,n=this.b;return(0,o.rgbToValue)(t,e,n)}},{key:"toArray",value:function(){var t=this.r,e=this.g,n=this.b;return[t,e,n]}}]),t}(),u=e.COLOR_NAMES={red:new i(244,67,54),purple:new i(156,39,176),blue:new i(33,150,243),green:new i(76,175,80),yellow:new i(255,235,59),orange:new i(255,152,0),cyan:new i(0,172,193),hotPink:new i(255,105,180),nightVision:new i(62,241,165)};e.COLORS=[u.purple,u.blue,u.cyan,u.green,u.yellow,u.orange,u.hotPink,u.red]},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e,n,a){var r=t.createShader(a);return t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.log("An error occurred compiling the shaders: ",t.getShaderInfoLog(r),e),null)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n(35),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t),this.config=e,this.attribute={},this.uniform={},this.program=null}return o(t,[{key:"compile",value:function(t){var e=this,n=this.config,a=i.VERTEX_SOURCES[n.vertex],o=i.FRAGMENT_SOURCES[n.fragment],u=r(t,n.vertex,a,t.VERTEX_SHADER),l=r(t,n.fragment,o,t.FRAGMENT_SHADER),s=t.createProgram();this.program=s,t.attachShader(s,u),t.attachShader(s,l),t.linkProgram(s),t.useProgram(s),n.attributes&&Object.keys(n.attributes).forEach(function(a){var r=n.attributes[a],o=t.getAttribLocation(s,r);e.attribute[r]=o}),n.uniforms&&Object.keys(n.uniforms).forEach(function(a){var r=n.uniforms[a],o=t.getUniformLocation(s,r);e.uniform[r]=o})}},{key:"getUniformLocation",value:function(t){return this.uniform[t]}},{key:"getAttribLocation",value:function(t){return this.attribute[t]}},{key:"getProgram",value:function(){return this.program}}]),t}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.FRAGMENT_SOURCES={simpleShader:n(36),lineShader:n(37),barShader:n(38),quadShader:n(39),gpuParticleShader:n(40)},e.VERTEX_SOURCES={simpleShader:n(41),lineShader:n(42),barShader:n(43),quadShader:n(44),gpuParticleShader:n(45)}},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nvarying lowp vec4 vColor;\n      \nvoid main(void) {\n  gl_FragColor = vColor;\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n      \nvoid main(void) {\n  gl_FragColor = vec4(1,0,0,1);\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nvoid main(void) {\n  gl_FragColor = vec4(0.24,0.94,0.644,1.0);\n}\n"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\nprecision mediump float;\n\nuniform sampler2D inTexture;\nuniform float inWidth;\nuniform float inHeight;\nuniform float inVolume;\n\nvarying vec2 coord;\n\n\nvoid main(void) {\n  // gl_FragColor = texture2D(inTexture, coord);\n  vec2 center = vec2(0.5, 0.5);\n  vec2 offsetRatio = vec2(1.0 / inWidth, 1.0 / inHeight);\n  float intensity = 20.0 * inVolume;\n  if (inVolume <= 0.0) {\n    intensity = 1.0;\n  }\n\n  vec2 blurVec = (coord - center) * intensity;\n  vec4 pixel = vec4(0.0);\n  for (float i = 0.0; i < 4.0 ; i++){\n    vec2 offset =  blurVec * (i - 4.0) * offsetRatio;\n    float weight = (4.0 - i) / 8.0;\n    pixel += weight * texture2D(inTexture, coord + offset);\n  }\n  gl_FragColor = vec4(pixel.rgb, 1.0);\n}\n"},function(t,e){t.exports="precision highp float;\n\nfloat scaleLinear(float value, vec2 valueDomain) {\n  return (value - valueDomain.x) / (valueDomain.y - valueDomain.x);\n}\n\nfloat scaleLinear(float value, vec2 valueDomain, vec2 valueRange) {\n  return mix(valueRange.x, valueRange.y, scaleLinear(value, valueDomain));\n}\n\nvarying vec4 vColor;\nvarying float lifeLeft;\n\nuniform sampler2D tSprite;\n\nvoid main() {\n\n  float alpha = 0.;\n\n  if (lifeLeft > .995 ) {\n    alpha = scaleLinear( lifeLeft, vec2(1., .995), vec2(0., 1.)); //mix( 0., 1., ( lifeLeft - .95 ) * 100. ) * .75;\n  } else {\n    alpha = lifeLeft * .75;\n  }\n\n  vec4 tex = texture2D( tSprite, gl_PointCoord );\n\n  gl_FragColor = vec4( vColor.rgb * tex.rgb, alpha * tex.a);\n}\n"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nattribute vec3 aVertexPosition;\nattribute vec4 aVertexColor;\n\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform mat4 uMMatrix;\n\nvarying lowp vec4 vColor;\n\nvoid main(void) {\n  gl_Position = uPMatrix * uMVMatrix * uMMatrix * vec4(aVertexPosition, 1.0);\n  vColor = aVertexColor;\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nattribute vec3 inCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\n\n\nvoid main(void) {\n  gl_Position = uPMatrix * uMVMatrix * vec4(inCoord, 1.0);\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nattribute vec3 aVertexPosition;\n\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform mat4 uMMatrix;\n\nvarying lowp vec4 vColor;\n\nvoid main(void) {\n  gl_Position = uPMatrix * uMVMatrix * uMMatrix * vec4(aVertexPosition, 1.0);\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nattribute vec2 inCoord;\n\nvarying vec2 coord;\n\nvoid main(void) {\n  gl_Position = vec4((inCoord * 2.0) - vec2(1.0), 0.0, 1.0);\n  coord = inCoord;\n}"},function(t,e){t.exports="precision highp float;\n\nconst vec4 bitSh = vec4(256. * 256. * 256., 256. * 256., 256., 1.);\nconst vec4 bitMsk = vec4(0.,vec3(1./256.0));\nconst vec4 bitShifts = vec4(1.) / bitSh;\n\n#define FLOAT_MAX\t1.70141184e38\n#define FLOAT_MIN\t1.17549435e-38\n\nlowp vec4 encode_float(highp float v) {\n  highp float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n  return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n  return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n  return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  highp vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  highp float e = floor(log2(av));\n  highp float m = av * pow(2.0, -e) - 1.0;\n\n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n\n  //Unpack exponent\n  highp float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0;\n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nvec4 pack(const in float depth) {\n  const vec4 bit_shift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n  const vec4 bit_mask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n  vec4 res = mod(depth*bit_shift*vec4(255), vec4(256))/vec4(255);\n  res -= res.xxyz * bit_mask;\n  return res;\n}\n\nfloat unpack(const in vec4 rgba_depth) {\n  const vec4 bit_shift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n  float depth = dot(rgba_depth, bit_shift);\n  return depth;\n}\n\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelMatrix;\nuniform vec3 position;\n\n\nuniform float uTime;\nuniform float uScale;\n// uniform sampler2D tNoise;\n\nattribute vec4 particlePositionsStartTime;\nattribute vec4 particleVelColSizeLife;\n\nvarying vec4 vColor;\nvarying float lifeLeft;\n\nvoid main() {\n\n  // unpack things from our attributes\n  vColor = encode_float( particleVelColSizeLife.y );\n\n  // convert our velocity back into a value we can use\n  vec4 velTurb = encode_float( particleVelColSizeLife.x );\n  vec3 velocity = vec3( velTurb.xyz );\n  float turbulence = velTurb.w;\n\n  vec3 newPosition;\n\n  float timeElapsed = uTime - particlePositionsStartTime.a;\n\n  lifeLeft = 1. - (timeElapsed / particleVelColSizeLife.w);\n\n  gl_PointSize = ( uScale * particleVelColSizeLife.z ) * lifeLeft;\n\n  velocity.x = ( velocity.x - .5 ) * 3.;\n  velocity.y = ( velocity.y - .5 ) * 3.;\n  velocity.z = ( velocity.z - .5 ) * 3.;\n\n  newPosition = particlePositionsStartTime.xyz + ( velocity * 10. ) * ( uTime - particlePositionsStartTime.a );\n\n  // vec3 noise = texture2D( tNoise, vec2( newPosition.x * .015 + (uTime * .05), newPosition.y * .02 + (uTime * .015) )).rgb;\n  // vec3 noiseVel = ( noise.rgb - .5 ) * 30.;\n\n  newPosition = mix(newPosition, newPosition /* + vec3(noiseVel * ( turbulence * 5. ) ) */, (timeElapsed / particleVelColSizeLife.a) );\n\n  if (velocity.y > 0. && velocity.y < .05) {\n    lifeLeft = 0.;\n  }\n\n  if (velocity.x < -1.45 ) {\n    lifeLeft = 0.0;\n  }\n\n  if (timeElapsed > 0.0) {\n    gl_Position = projectionMatrix * modelViewMatrix * modelMatrix * vec4( newPosition, 1.0 );\n  } else {\n    gl_Position = projectionMatrix * modelViewMatrix * modelMatrix * vec4( position, 1.0 );\n    lifeLeft = 0.0;\n    gl_PointSize = 0.0;\n  }\n}\n"},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.SHADER_GPU_PARTICLE_CONFIG={vertex:"gpuParticleShader",fragment:"gpuParticleShader",uniforms:{projectionMatrix:"projectionMatrix",modelViewMatrix:"modelViewMatrix",modelMatrix:"modelMatrix",position:"position",uTime:"uTime",uScale:"uScale",tSprite:"tSprite"},attributes:{particlePositionsStartTime:"particlePositionsStartTime",particleVelColSizeLife:"particleVelColSizeLife"}},e.QUAD_SHADER_CONFIG={vertex:"quadShader",fragment:"quadShader",uniforms:{width:"inWidth",height:"inHeight",volume:"inVolume",texture:"inTexture"},attributes:{vertices:"inCoord"}},e.BAR_SHADER_CONFIG={vertex:"barShader",fragment:"barShader",uniforms:{uPMatrix:"uPMatrix",uMVMatrix:"uMVMatrix",uMMatrix:"uMMatrix"},attributes:{vertices:"aVertexPosition"}}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.VK_W=87,e.VK_A=65,e.VK_S=83,e.VK_D=68,e.VK_ARROW_LEFT=37,e.VK_ARROW_UP=38,e.VK_ARROW_RIGHT=39,e.VK_ARROW_DOWN=40},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.CAMERA_MOVE_POS_YAW="CAMERA_MOVE_POS_YAW",e.CAMERA_MOVE_NEG_YAW="CAMERA_MOVE_NEG_YAW",e.CAMERA_MOVE_POS_PITCH="CAMERA_MOVE_POS_PITCH",e.CAMERA_MOVE_NEG_PITCH="CAMERA_MOVE_NEG_PITCH",e.CAMERA_MOVE_POS_X="CAMERA_MOVE_POS_X",e.CAMERA_MOVE_NEG_X="CAMERA_MOVE_NEG_X",e.CAMERA_MOVE_POS_Y="CAMERA_MOVE_POS_Y",e.CAMERA_MOVE_NEG_Y="CAMERA_MOVE_NEG_Y",e.CAMERA_MOVE_POS_Z="CAMERA_MOVE_POS_Z",e.CAMERA_MOVE_NEG_Z="CAMERA_MOVE_NEG_Z"},function(t,e){}])});
//# sourceMappingURL=visual-audio.js.map