!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var a=e();for(var n in a)("object"==typeof exports?exports:t)[n]=a[n]}}(this,function(){return function(t){function e(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){t.exports=a(4)},,,,function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e["default"]=t,e}var o=a(5),i=r(o),u=a(6),l=r(u),s=a(7),c=n(s),f=a(11),M=n(f);a(13),window.VISUAL_AUDIO={VERSION:"2016-07-21T23:37:56.949Z"},function(){function t(t){return"boolean"==typeof t&&t||"true"===t.toLowerCase()||"1"===t}function e(t){var e;try{e=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(a){}return e||(alert("Unable to initialize WebGL. Your browser may not support it."),e=null),window.gl=e,e}function n(t,e){return Math.random()*(e-t)+t}function r(){var t=_.canvas.clientWidth,e=_.canvas.clientHeight;G=_.createFramebuffer(),_.bindFramebuffer(_.FRAMEBUFFER,G),G.width=t,G.height=e,W=_.createTexture(),_.bindTexture(_.TEXTURE_2D,W),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texImage2D(_.TEXTURE_2D,0,_.RGBA,G.width,G.height,0,_.RGBA,_.UNSIGNED_BYTE,null),_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,W,0),_.bindTexture(_.TEXTURE_2D,null),_.bindFramebuffer(_.FRAMEBUFFER,null),H=_.createBuffer();var a=new Float32Array([-1,1,-1,-1,1,-1,1,1,-1,1,1,-1]);_.bindBuffer(_.ARRAY_BUFFER,H),_.bufferData(_.ARRAY_BUFFER,a,_.STATIC_DRAW)}function o(){j=_.createTexture(),V=new Image,V.onload=function(){_.bindTexture(_.TEXTURE_2D,j),_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,V),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.bindTexture(_.TEXTURE_2D,null),it=!0},V.src="public/images/star.png"}function u(){for(var t=at[0],e=0,a=t.rate,r=y.velocityMultiplier,o=et.alive.length,i={x:0,y:-15e-6,z:0},u=0;o>u;u++){var l=3*u;if(et.alive[u]===rt){if(a>e){var s=t.position,c={x:n(t.minDirection.x,t.maxDirection.x),y:n(t.minDirection.y,t.maxDirection.y),z:n(t.minDirection.z,t.maxDirection.z)};1!==r&&(c.x*=r,c.y*=r,c.z*=r),et.positions[l]=s.x,et.positions[l+1]=s.y,et.positions[l+2]=s.z,et.velocities[l]=c.x,et.velocities[l+1]=c.y,et.velocities[l+2]=c.z,et.alive[u]=nt,et.ages[u]=0,et.lifespans[u]=t.lifespan,et.type[u]=et.nextType,et.nextType=(et.nextType+1)%8,e++}}else y.useAcceleration?(et.positions[l]+=et.velocities[l]+i.x*et.ages[u],et.positions[l+1]+=et.velocities[l+1]+i.y*et.ages[u],et.positions[l+2]+=et.velocities[l+2]):(et.positions[l]+=et.velocities[l],et.positions[l+1]+=et.velocities[l+1],et.positions[l+2]+=et.velocities[l+2]),et.ages[u]>et.lifespans[u]&&(et.alive[u]=rt),et.ages[u]++}_.bindBuffer(_.ARRAY_BUFFER,C),_.bufferData(_.ARRAY_BUFFER,et.positions,_.STATIC_DRAW),_.bindBuffer(_.ARRAY_BUFFER,z),_.bufferData(_.ARRAY_BUFFER,et.alive,_.STATIC_DRAW),_.bindBuffer(_.ARRAY_BUFFER,O),_.bufferData(_.ARRAY_BUFFER,et.ages,_.STATIC_DRAW),_.bindBuffer(_.ARRAY_BUFFER,U),_.bufferData(_.ARRAY_BUFFER,et.type,_.STATIC_DRAW)}function s(){var t=y.maxParticles;et.positions=new Float32Array(3*t),et.velocities=new Float32Array(3*t),et.type=new Float32Array(t),et.alive=new Float32Array(t),et.ages=new Float32Array(t),et.lifespans=new Float32Array(t),K=new Float32Array(3*tt.length);for(var e=0;e<tt.length;e++)K[3*e]=tt[e].r/255,K[3*e+1]=tt[e].g/255,K[3*e+2]=tt[e].b/255;for(var e=0,a=0;t>e;e++,a+=3){var n={x:0,y:0,z:0},r={x:0,y:0,z:0},o=rt;et.positions[a]=n.x,et.positions[a+1]=n.y,et.positions[a+2]=n.z,et.velocities[a]=r.x,et.velocities[a+1]=r.y,et.velocities[a+2]=r.z,et.type[a]=0,et.alive[a]=o}C=_.createBuffer(),z=_.createBuffer(),O=_.createBuffer(),U=_.createBuffer(),_.bindBuffer(_.ARRAY_BUFFER,U),_.bufferData(_.ARRAY_BUFFER,et.type,_.STATIC_DRAW),_.bindBuffer(_.ARRAY_BUFFER,C),_.bufferData(_.ARRAY_BUFFER,et.positions,_.STATIC_DRAW),_.bindBuffer(_.ARRAY_BUFFER,z),_.bufferData(_.ARRAY_BUFFER,et.alive,_.STATIC_DRAW),_.bindBuffer(_.ARRAY_BUFFER,O),_.bufferData(_.ARRAY_BUFFER,et.ages,_.STATIC_DRAW)}function f(){o(),s(),r()}function h(t){_.useProgram(N);var e=_.getUniformLocation(N,"uPMatrix");_.uniformMatrix4fv(e,!1,P);var a=_.getUniformLocation(N,"uMVMatrix");_.uniformMatrix4fv(a,!1,st.getModelViewMatrix());var n=_.getUniformLocation(N,"inFrame");_.uniform1f(n,window.frameCount);var r=_.getUniformLocation(N,"intensity");t&&t.bins?(_.uniform1f(r,t.max),_.uniform1fv(_.getUniformLocation(N,"inFreqs"),t.bins)):(_.uniform1f(r,-1),_.uniform1fv(_.getUniformLocation(N,"inFreqs"),[0,0,0,0,0,0,0,0])),_.activeTexture(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,j),_.uniform1i(_.getUniformLocation(N,"inTexture"),0),_.uniform3fv(_.getUniformLocation(N,"inColors"),K),_.uniform1f(_.getUniformLocation(N,"isPlaying"),ut.isPlaying()?1:0),_.bindBuffer(_.ARRAY_BUFFER,C),_.enableVertexAttribArray(B),_.vertexAttribPointer(B,3,_.FLOAT,!1,0,0),_.bindBuffer(_.ARRAY_BUFFER,z),_.enableVertexAttribArray(k),_.vertexAttribPointer(k,1,_.FLOAT,!1,0,0),_.bindBuffer(_.ARRAY_BUFFER,O),_.enableVertexAttribArray(q),_.vertexAttribPointer(q,1,_.FLOAT,!1,0,0),_.bindBuffer(_.ARRAY_BUFFER,U),_.enableVertexAttribArray(Y),_.vertexAttribPointer(Y,1,_.FLOAT,!1,0,0),_.drawArrays(_.POINTS,0,et.positions.length/3),_.disableVertexAttribArray(Y),_.disableVertexAttribArray(q),_.disableVertexAttribArray(k),_.disableVertexAttribArray(B)}function d(){u()}function m(){R=[];var t=ut.getFrequencyBinCount(),e=8,a=e/t,n=.2*a,r=ut.getFrequencyData(),o=e/2;if(r&&r.length>0)for(var i=0;i<r.length;i++){var u=r[i]/255,l=u,s=0,c=i*a-o,f=c+(a-n),M=1,h=[c,l,M,c,s,M,f,s,M,f,l,M,c,l,M,f,s,M];R=R.concat(h)}T=_.createBuffer(),_.bindBuffer(_.ARRAY_BUFFER,T),_.bufferData(_.ARRAY_BUFFER,new Float32Array(R),_.STATIC_DRAW),function(){_.useProgram(Q);var t=_.getUniformLocation(Q,"uPMatrix");_.uniformMatrix4fv(t,!1,P);var e=_.getUniformLocation(Q,"uMVMatrix");_.uniformMatrix4fv(e,!1,st.getModelViewMatrix());var a=_.getUniformLocation(Q,"uMMatrix"),n=b.create(),r=g.fromValues(0,-4,0,0);b.translate(n,n,r),_.uniformMatrix4fv(a,!1,n),_.bindBuffer(_.ARRAY_BUFFER,T),_.enableVertexAttribArray(X),_.vertexAttribPointer(X,3,_.FLOAT,!1,0,0),_.drawArrays(_.TRIANGLES,0,R.length/3),_.disableVertexAttribArray(X)}()}function x(){F(),E.begin(),setTimeout(function(){window.frameCount+=1},0),_.bindFramebuffer(_.FRAMEBUFFER,G),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT);var t=canvas.clientWidth/canvas.clientHeight;P=b.create(),b.perspective(P,i.degreesToRadians(50),t,.1,100);var e=ut.getNormalizedFrequencyData()||{};if(it){h(e);var a=(new Date).getTime();if(L){var n=a-L;n>ot&&(L=a,window.animationCount++,d())}else L=a}_.bindFramebuffer(_.FRAMEBUFFER,null),_.useProgram(J),_.enableVertexAttribArray(Z),_.activeTexture(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,W);var r=_.getUniformLocation(J,"inTexture");_.uniform1i(r,0);var o=0;y.blur&&(o=e.average||0),_.uniform1f(_.getUniformLocation(J,"inWidth"),canvas.clientWidth),_.uniform1f(_.getUniformLocation(J,"inHeight"),canvas.clientHeight),_.uniform1f(_.getUniformLocation(J,"inVolume"),o),_.bindBuffer(_.ARRAY_BUFFER,H),_.vertexAttribPointer(Z,2,_.FLOAT,!1,0,0),_.drawArrays(_.TRIANGLES,0,6),_.disableVertexAttribArray(Z),ut&&ut.isPlaying()&&y.showBars&&m(),E.end(),requestAnimationFrame(x)}function S(t){var e=t.keyCode,a={37:{id:"left_arrow",action:"minus_yaw"},38:{id:"up_arrow",action:"plus_pitch"},39:{id:"right_arrow",action:"plus_yaw"},40:{id:"down_arrow",action:"minus_pitch"},87:{id:"W",action:"move_forward"},65:{id:"A",action:"move_left"},83:{id:"S",action:"move_backward"},68:{id:"D",action:"move_right"}},n=.1,r=.1,o=[.2,.5,.5];if(a[e])switch(a[e].action){case"minus_pitch":st.pitch-=n;break;case"plus_pitch":st.pitch+=n;break;case"plus_yaw":st.yaw+=r;break;case"minus_yaw":st.yaw-=r;break;case"move_forward":st.position[2]+=o[2];break;case"move_backward":st.position[2]-=o[2];break;case"move_left":st.position[0]+=o[0];break;case"move_right":st.position[0]-=o[0]}}function v(){this.position=[0,0,-10],this.pitch=0,this.yaw=0}function I(){$(document).on("keydown",S),E=new Stats,E.setMode(0),E.domElement.style.position="absolute",E.domElement.style.right="0px",E.domElement.style.top="0px",document.body.appendChild(E.domElement);var t=a(28),n=new t;lt.bind(),st=window.camera=new v;var r=document.getElementById("canvas");_=e(r),n.compileShaders(_),f(),N=_.createProgram(),_.attachShader(N,n.vertex.particleShader),_.attachShader(N,n.fragment.particleShader),_.linkProgram(N),Q=_.createProgram(),_.attachShader(Q,n.vertex.barShader),_.attachShader(Q,n.fragment.barShader),_.linkProgram(Q),J=_.createProgram(),_.attachShader(J,n.vertex.quadShader),_.attachShader(J,n.fragment.quadShader),_.linkProgram(J),_.enable(_.BLEND),_.blendEquation(_.FUNC_ADD),_.blendFunc(_.SRC_ALPHA,_.ONE),_.useProgram(N),B=_.getAttribLocation(N,"inCoord"),k=_.getAttribLocation(N,"inAlive"),q=_.getAttribLocation(N,"inAge"),Y=_.getAttribLocation(N,"inType"),_.useProgram(Q),X=_.getAttribLocation(Q,"aVertexPosition"),_.useProgram(J),Z=_.getAttribLocation(J,"inCoord"),_.viewport(0,0,_.drawingBufferWidth,_.drawingBufferHeight),_&&(_.clearColor(0,0,0,1),_.disable(_.DEPTH_TEST),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT),requestAnimationFrame(x))}function F(){var t=_.canvas.clientWidth,e=_.canvas.clientHeight;(_.canvas.width!=t||_.canvas.height!=e)&&(r(),_.canvas.width=t,_.canvas.height=e,_.viewport(0,0,_.drawingBufferWidth,_.drawingBufferHeight))}var D=a(17),p=a(18);p.glMatrix.setMatrixArrayType(Float32Array);var b=p.mat4,g=p.vec4,y={maxParticles:5e3,useAcceleration:!0,emissionRate:2,particleLifespan:1e3,velocityMultiplier:2,blur:!1,showBars:!0},A=l.getQueryParams();try{A.max&&parseInt(A.max)&&parseInt(A.max)>0&&(y.maxParticles=parseInt(A.max)),A.rate&&parseInt(A.rate)&&parseInt(A.rate)>0&&(y.emissionRate=parseInt(A.rate)),A.life&&parseInt(A.life)&&parseInt(A.life)>0&&(y.particleLifespan=parseInt(A.life)),A.speed&&parseInt(A.speed)&&parseInt(A.speed)>0&&(y.velocityMultiplier=parseInt(A.speed)),A.accel&&(y.useAcceleration=t(A.accel)),A.bars&&(y.showBars=t(A.bars)),A.blur&&(y.blur=t(A.blur))}catch(w){console.error&&console.error(w)}D(),document.addEventListener("DOMContentLoaded",I);var E,R,T,P,_,L,C,z,O,U,N,k,q,Y,B,V,j,Q,X,G,W,H,Z,J,K,tt=[{name:"red",r:244,g:67,b:54},{name:"purple",r:156,g:39,b:176},{name:"blue",r:33,g:150,b:243},{name:"green",r:76,g:175,b:80},{name:"yellow",r:255,g:235,b:59},{name:"orange",r:255,g:152,b:0},{name:"cyan",r:0,g:172,b:193},{name:"pink",r:233,g:30,b:99}],et={positions:null,velocities:null,alive:null,ages:null,lifespans:null,nextType:0},at=[{rate:y.emissionRate,lastEmit:null,lifespan:y.particleLifespan,minDirection:{x:-.01,y:-.01,z:-.01},maxDirection:{x:.01,y:.01,z:.01},position:{x:0,y:0,z:0}}],nt=1,rt=0,ot=1e3/60,it=!1,ut=new M["default"],lt=new c["default"](ut);window.frameCount=0,window.animationCount=0,v.prototype.getModelViewMatrix=function(){var t=b.create();return b.rotateX(t,t,-this.pitch),b.rotateY(t,t,this.yaw),b.translate(t,t,this.position),t};var st}()},function(t,e){"use strict";function a(t){return t*(Math.PI/180)}function n(t){return t*(180/Math.PI)}Object.defineProperty(e,"__esModule",{value:!0}),e.degreesToRadians=a,e.radiansToDegrees=n},function(t,e){"use strict";function a(){var t=window.location.search.substring(1)||"";if(""===t)return{};for(var e={},a=t.split("&"),n=0;n<a.length;n++){var r=a[n].split("=",2);1==r.length?e[r[0]]="":e[r[0]]=decodeURIComponent(r[1].replace(/\+/g," "))}return e}Object.defineProperty(e,"__esModule",{value:!0}),e.getQueryParams=a},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a(8),u=n(i),l=a(10),s=n(l),c=a(11),f=a(9),M="#media-player",h="#audio-chooser",d="#file-chooser",m="#voice-chooser",x=".media-btn",S=function(){function t(e){r(this,t),this.audioManager=e}return o(t,[{key:"bind",value:function(){var t=this;this.audioManager.registerStateListener(this.onAudioStateChange.bind(this)),this.audioManager.registerQueueListener(this.onQueueChanged.bind(this));var e=$(d),a=$(m),n=$("#media-controls [data-control='play']"),r=$("#media-controls [data-control='pause']"),o=$("#media-controls [data-control='stop']");e.on("change",function(e){t.onFileChosen(e)}),a.on("click",function(e){t.onVoiceChosen(e)}),n.on("click",function(e){t.onPlayClicked(e)}),r.on("click",function(e){t.onPauseClicked(e)}),o.on("click",function(e){t.onStopClicked(e)}),$("body").on("click","#media-queue [data-queue-index].close",function(e){return t.onRemoveQueueItem(e)})}},{key:"onAudioStateChange",value:function(t,e){console.log("on state change %s %s",t,e);var a=this.audioManager.getCurrentSourceInfo();if(a&&a.type===f.SOURCE_TYPES.MIC)return void this.setMicControls();switch(t===c.AUDIO_STATE.OFF&&e===c.AUDIO_STATE.PLAYING&&(this.setControlsToStarted(),this.setQueueControls()),e){case c.AUDIO_STATE.OFF:this.setControlsToStopped(),this.setNowPlaying(null),this.resetQueueControls();break;case c.AUDIO_STATE.PLAYING:this.setControlsToPlaying(),this.displayCurrentSong();break;case c.AUDIO_STATE.PAUSED:this.setControlsToPaused()}this.renderMediaQueue()}},{key:"displayCurrentSong",value:function(){var t=this.audioManager.getCurrentSourceInfo();this.setNowPlaying(t.label)}},{key:"onQueueChanged",value:function(){this.displayCurrentSong(),this.renderMediaQueue()}},{key:"addSource",value:function(t){var e=this;t.onLoaded(function(){console.log("SUCCESS"),e.audioManager.addMediaSource(t)},function(){console.log("ERROR")})}},{key:"onFileChosen",value:function(t){if(0!==t.target.files.length){var e=this.audioManager.getAudioContext(),a=t.target.files[0],n=new u["default"](e,a);this.addSource(n),this.resetFileChooser()}}},{key:"onVoiceChosen",value:function(){var t=this.audioManager.getCurrentSourceInfo();if(t&&t.type===f.SOURCE_TYPES.MIC)this.resetMicControls(),this.audioManager.stop();else{var e=this.audioManager.getAudioContext(),a=new s["default"](e);this.addSource(a)}}},{key:"onPlayClicked",value:function(){this.audioManager.resume()}},{key:"onPauseClicked",value:function(){this.audioManager.pause()}},{key:"onStopClicked",value:function(t){this.audioManager.stop()}},{key:"setNowPlaying",value:function(t){$("#now-playing").text(t)}},{key:"setControlsToStarted",value:function(){$(M).removeClass("off").addClass("on")}},{key:"setControlsToStopped",value:function(){$(M).addClass("off").removeClass("on"),$(h).removeClass("no-select")}},{key:"resetFileChooser",value:function(){var t=$(h);t.wrap("<form>").closest("form").get(0).reset(),t.unwrap()}},{key:"setControlsToPaused",value:function(){var t=$(M);t.removeClass("playing"),t.addClass("paused")}},{key:"setControlsToPlaying",value:function(){var t=$(M);t.removeClass("paused"),t.addClass("playing")}},{key:"setMicControls",value:function(){var t=$(m),e=$(d);e.find("input, .media-btn").attr("disabled","disabled"),t.addClass("active")}},{key:"setQueueControls",value:function(){var t=$(m);t.find(""+x).attr("disabled","disabled")}},{key:"resetQueueControls",value:function(){var t=$(m);t.find(""+x).removeAttr("disabled")}},{key:"resetMicControls",value:function(){var t=$(m),e=$(d);e.find("input, "+x).removeAttr("disabled"),t.removeClass("active")}},{key:"renderMediaSource",value:function(t,e){var a='<button type="button" class="close" data-queue-index='+e+' aria-label="Remove"><span aria-hidden="true">×</span></button>';return"<li>"+a+'<span class="title" data-index="'+e+'">'+t.label+"</span></li>"}},{key:"onRemoveQueueItem",value:function(t){var e=$(t.target).attr("data-queue-index");this.audioManager.removeQueueIndex(e)}},{key:"renderMediaQueue",value:function(){var t=this,e=$("#media-queue"),a=this.audioManager.getQueueInfo().map(function(e,a){return t.renderMediaSource(e,a)}),n=$("<ul></ul>").append(a);e.empty().append(n)}}]),t}();e["default"]=S},function(t,e,a){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t){return new Promise(function(e,a){var n=new FileReader;n.onload=function(t){var a=t.target.result;e(a)},n.onerror=function(t){console.error(t),a(t)},n.readAsArrayBuffer(t)})}function u(t,e){var a=t.createBufferSource();return a.buffer=e,a.start||(a.start=a.noteOn,a.stop=a.noteOff),a}function l(t,e){return new Promise(function(a,n){t.decodeAudioData(e,function(e){var n=u(t,e);a(n)},function(t){console.error(t),n(t)})})}Object.defineProperty(e,"__esModule",{value:!0});var s=a(9),c=function(t){function e(t,a){n(this,e);var o=r(this,Object.getPrototypeOf(e).call(this,s.SOURCE_TYPES.FILE,t,!0));return o.file=a,o.fileName=a.name,o.label=o.fileName,o.isLoaded=!1,o.fileLoaderPromise=i(a).then(function(e){return l(t,e)}).then(function(t){return o.isLoaded=!0,o.audioNode=t,Promise.resolve()})["catch"](function(t){return Promise.reject(t)}),o}return o(e,t),e}(s.MediaSource);e["default"]=c},function(t,e){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=e.SOURCE_TYPES={FILE:"FILE",MIC:"MIC"},u=function(t){function e(t){a(this,e);var r=n(this,Object.getPrototypeOf(e).call(this,t));return r.message=t,r.name=r.constructor.name,r}return r(e,t),e}(Error),l="Invalid source type";e.MediaSource=function(){function t(e,n){var r=arguments.length<=2||void 0===arguments[2]?!0:arguments[2],o=arguments.length<=3||void 0===arguments[3]?!0:arguments[3];if(a(this,t),!(e in i))throw new u(l);this.sourceType=e,this.audioContext=n,this.useSpeakerDestination=r,this.allowQueuing=o,this.label=null,this.metaData=null,this.isLoaded=!0,this.audioNode=null,this.fileLoaderPromise=Promise.resolve()}return o(t,[{key:"isLoaded",value:function(){return this.isLoaded}},{key:"onLoaded",value:function(t,e){this.fileLoaderPromise.then(t,e)}},{key:"shouldConnectDestination",value:function(){return this.useSpeakerDestination}},{key:"shouldAllowQueueing",value:function(){return this.allowQueuing}},{key:"getLabel",value:function(){return this.label}},{key:"getMetaData",value:function(){return this.metaData}},{key:"getType",value:function(){return this.sourceType}},{key:"getAudioNode",value:function(){return this.audioNode}}]),t}()},function(t,e,a){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t){return new Promise(function(e,a){navigator.getUserMedia(l,function(a){var n=t.createMediaStreamSource(a);e(n)},function(t){console.error(t),a(t)})})}Object.defineProperty(e,"__esModule",{value:!0});var u=a(9),l={audio:!0},s=function(t){function e(t,a){n(this,e);var o=r(this,Object.getPrototypeOf(e).call(this,u.SOURCE_TYPES.MIC,t,!1,!1));return o.file=a,o.isLoaded=!1,o.fileLoaderPromise=i(t).then(function(t){return o.isLoaded=!0,o.audioNode=t,Promise.resolve()})["catch"](function(t){return Promise.reject(t)}),o}return o(e,t),e}(u.MediaSource);e["default"]=s},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.AUDIO_STATE=void 0;var o=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a(12),u=n(i),l=e.AUDIO_STATE={OFF:"OFF",PLAYING:"PLAYING",PAUSED:"PAUSED"},s=function(){function t(){r(this,t),this.mediaQueue=new u["default"],this.audioContext=new AudioContext,this.analyser=null,this.state=l.OFF,this.currentMediaSource=null,this.stateListeners=[],this.queueListeners=[]}return o(t,[{key:"getAudioContext",value:function(){return this.audioContext}},{key:"isPlaying",value:function(){return this.state===l.PLAYING}},{key:"addMediaSource",value:function(t){0!==this.mediaQueue.size()||this.isPlaying()?t.shouldAllowQueueing()?(this.mediaQueue.enqueue(t),this.notifyQueueListeners()):console.error("Attempt to enqueue source that doesn't allow queueing"):this.connectMediaSource(t)}},{key:"notifyQueueListeners",value:function(){for(var t=0;t<this.stateListeners.length;t++)this.queueListeners[t]()}},{key:"notifyStateListeners",value:function(t,e){for(var a=0;a<this.stateListeners.length;a++)this.stateListeners[a](t,e)}},{key:"setState",value:function(t){var e=this.state;this.state=t,this.notifyStateListeners(e,t)}},{key:"registerQueueListener",value:function(t){this.queueListeners.push(t)}},{key:"registerStateListener",value:function(t){this.stateListeners.push(t)}},{key:"getQueueInfo",value:function(){return this.mediaQueue.getDisplayValues()}},{key:"removeQueueIndex",value:function(t){this.mediaQueue.popIndex(t),this.notifyQueueListeners()}},{key:"getCurrentSourceInfo",value:function(){return this.currentMediaSource?{label:this.currentMediaSource.getLabel(),metadata:this.currentMediaSource.getMetaData(),type:this.currentMediaSource.getType()}:null}},{key:"connectMediaSource",value:function(t){var e=this;this.currentMediaSource=t;var a=this.currentMediaSource.getAudioNode();a.onended=function(){if(console.log("song ended"),e.mediaQueue.size()>0){var t=e.mediaQueue.dequeue();e.notifyQueueListeners,e.connectMediaSource(t)}else e.currentMediaSource=null,e.setState(l.OFF)};var n=void 0;this.currentMediaSource.shouldConnectDestination()&&(n=this.audioContext.destination),this.setupAudioNodes(a,n),a.start&&a.start(0),this.setState(l.PLAYING)}},{key:"resume",value:function(){var t=this;"suspended"===this.audioContext.state&&this.audioContext.resume().then(function(){return t.setState(l.PLAYING)})}},{key:"pause",value:function(){var t=this;"running"===this.audioContext.state&&this.audioContext.suspend().then(function(){return t.setState(l.PAUSED)})}},{key:"stop",value:function(){if(this.currentMediaSource&&this.currentMediaSource.getAudioNode())if(this.currentMediaSource.getAudioNode().mediaStream){var t=this.currentMediaSource.getAudioNode().mediaStream;if(t.getAudioTracks())for(var e=0;e<t.getAudioTracks().length;e++)t.getAudioTracks()[e].stop&&t.getAudioTracks()[e].stop()}else this.currentMediaSource.getAudioNode().stop();this.currentMediaSource=null,this.mediaQueue.clear(),this.setState(l.OFF)}},{key:"createDefaultAnalyser",value:function(){var t=arguments.length<=0||void 0===arguments[0]?256:arguments[0],e=arguments.length<=1||void 0===arguments[1]?.85:arguments[1],a=this.audioContext.createAnalyser();return a.smoothingTimeConstant=e,a.fftSize=t,a}},{key:"setupAudioNodes",value:function(t,e){var a=this.createDefaultAnalyser();t.connect(a),e&&a.connect(e),this.analyser=a}},{key:"getFrequencyBinCount",value:function(){return this.analyser.frequencyBinCount}},{key:"getNormalizedFrequencyData",value:function(){if(this.isPlaying()){var t=this.getFrequencyData();if(t&&t.length){for(var e=t.length,a={average:0,bins:[],max:0,min:255},n=8,r=e/n,o=0,i=0;e>i;i++){var u=Math.floor(i/r);a.bins[u]?a.bins[u]+=t[i]:a.bins[u]=t[i],t[i]>a.max&&(a.max=t[i]),t[i]<a.min&&(a.min=t[i]),o+=t[i]}for(var l=0;l<a.bins.length;l++)a.bins[l]=a.bins[l]/255/r;return a.max/=255,a.min/=255,a.average=o/255/e,a}}return null}},{key:"getFrequencyData",value:function(){var t=this.analyser;if(!t)return console.warn("no analyser"),null;var e=t.frequencyBinCount,a=new Uint8Array(e);return t.getByteFrequencyData(a),a}},{key:"getTimeDomainData",value:function(){var t=this.analyser,e=t.frequencyBinCount,a=new Uint8Array(e);return t.getByteTimeDomainData(a),a}}]),t}();e["default"]=s},function(t,e){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),r=function(){function t(){a(this,t),this.mediaSources=[]}return n(t,[{key:"enqueue",value:function(t){this.mediaSources.push(t)}},{key:"dequeue",value:function(){return this.popIndex(0)}},{key:"size",value:function(){return this.mediaSources.length}},{key:"popIndex",value:function(t){return this.mediaSources.splice(t,1)[0]}},{key:"clear",value:function(){this.mediaSources.splice(0,this.mediaSources.length)}},{key:"getDisplayValues",value:function(){return this.mediaSources.map(function(t){return{label:t.getLabel(),metadata:t.getMetaData(),type:t.getType()}})}}]),t}();e["default"]=r},function(t,e){},,,,function(t,e){"use strict";function a(){window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext,window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,window.navigator.getUserMedia=window.navigator.getUserMedia||window.navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia||window.navigator.msGetUserMedia}t.exports=function(){a()}},function(t,e,a){e.glMatrix=a(19),e.mat2=a(20),e.mat2d=a(21),e.mat3=a(22),e.mat4=a(23),e.quat=a(24),e.vec2=a(27),e.vec3=a(25),e.vec4=a(26)},function(t,e){var a={};a.EPSILON=1e-6,a.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,a.RANDOM=Math.random,a.ENABLE_SIMD=!1,a.SIMD_AVAILABLE=a.ARRAY_TYPE===Float32Array&&"SIMD"in this,a.USE_SIMD=a.ENABLE_SIMD&&a.SIMD_AVAILABLE,a.setMatrixArrayType=function(t){a.ARRAY_TYPE=t};var n=Math.PI/180;a.toRadian=function(t){return t*n},a.equals=function(t,e){return Math.abs(t-e)<=a.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},t.exports=a},function(t,e,a){var n=a(19),r={};r.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.fromValues=function(t,e,a,r){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=a,o[3]=r,o},r.set=function(t,e,a,n,r){return t[0]=e,t[1]=a,t[2]=n,t[3]=r,t},r.transpose=function(t,e){if(t===e){var a=e[1];t[1]=e[2],t[2]=a}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},r.invert=function(t,e){var a=e[0],n=e[1],r=e[2],o=e[3],i=a*o-r*n;return i?(i=1/i,t[0]=o*i,t[1]=-n*i,t[2]=-r*i,t[3]=a*i,t):null},r.adjoint=function(t,e){var a=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=a,t},r.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},r.multiply=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3],u=a[0],l=a[1],s=a[2],c=a[3];return t[0]=n*u+o*l,t[1]=r*u+i*l,t[2]=n*s+o*c,t[3]=r*s+i*c,t},r.mul=r.multiply,r.rotate=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(a),l=Math.cos(a);return t[0]=n*l+o*u,t[1]=r*l+i*u,t[2]=n*-u+o*l,t[3]=r*-u+i*l,t},r.scale=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3],u=a[0],l=a[1];return t[0]=n*u,t[1]=r*u,t[2]=o*l,t[3]=i*l,t},r.fromRotation=function(t,e){var a=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=a,t[2]=-a,t[3]=n,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},r.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},r.LDU=function(t,e,a,n){return t[2]=n[2]/n[0],a[0]=n[0],a[1]=n[1],a[3]=n[3]-t[2]*a[1],[t,e,a]},r.add=function(t,e,a){return t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t[3]=e[3]+a[3],t},r.subtract=function(t,e,a){return t[0]=e[0]-a[0],t[1]=e[1]-a[1],t[2]=e[2]-a[2],t[3]=e[3]-a[3],t},r.sub=r.subtract,r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var a=t[0],r=t[1],o=t[2],i=t[3],u=e[0],l=e[1],s=e[2],c=e[3];return Math.abs(a-u)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(r-l)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-s)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-c)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},r.multiplyScalar=function(t,e,a){return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t},r.multiplyScalarAndAdd=function(t,e,a,n){return t[0]=e[0]+a[0]*n,t[1]=e[1]+a[1]*n,t[2]=e[2]+a[2]*n,t[3]=e[3]+a[3]*n,t},t.exports=r},function(t,e,a){var n=a(19),r={};r.create=function(){var t=new n.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.fromValues=function(t,e,a,r,o,i){var u=new n.ARRAY_TYPE(6);return u[0]=t,u[1]=e,u[2]=a,u[3]=r,u[4]=o,u[5]=i,u},r.set=function(t,e,a,n,r,o,i){return t[0]=e,t[1]=a,t[2]=n,t[3]=r,t[4]=o,t[5]=i,t},r.invert=function(t,e){var a=e[0],n=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=a*o-n*r;return l?(l=1/l,t[0]=o*l,t[1]=-n*l,t[2]=-r*l,t[3]=a*l,t[4]=(r*u-o*i)*l,t[5]=(n*i-a*u)*l,t):null},r.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},r.multiply=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=a[0],c=a[1],f=a[2],M=a[3],h=a[4],d=a[5];return t[0]=n*s+o*c,t[1]=r*s+i*c,
t[2]=n*f+o*M,t[3]=r*f+i*M,t[4]=n*h+o*d+u,t[5]=r*h+i*d+l,t},r.mul=r.multiply,r.rotate=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=Math.sin(a),c=Math.cos(a);return t[0]=n*c+o*s,t[1]=r*c+i*s,t[2]=n*-s+o*c,t[3]=r*-s+i*c,t[4]=u,t[5]=l,t},r.scale=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=a[0],c=a[1];return t[0]=n*s,t[1]=r*s,t[2]=o*c,t[3]=i*c,t[4]=u,t[5]=l,t},r.translate=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=a[0],c=a[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=i,t[4]=n*s+o*c+u,t[5]=r*s+i*c+l,t},r.fromRotation=function(t,e){var a=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=a,t[2]=-a,t[3]=n,t[4]=0,t[5]=0,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},r.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},r.add=function(t,e,a){return t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t[3]=e[3]+a[3],t[4]=e[4]+a[4],t[5]=e[5]+a[5],t},r.subtract=function(t,e,a){return t[0]=e[0]-a[0],t[1]=e[1]-a[1],t[2]=e[2]-a[2],t[3]=e[3]-a[3],t[4]=e[4]-a[4],t[5]=e[5]-a[5],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,a){return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*a,t[5]=e[5]*a,t},r.multiplyScalarAndAdd=function(t,e,a,n){return t[0]=e[0]+a[0]*n,t[1]=e[1]+a[1]*n,t[2]=e[2]+a[2]*n,t[3]=e[3]+a[3]*n,t[4]=e[4]+a[4]*n,t[5]=e[5]+a[5]*n,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},r.equals=function(t,e){var a=t[0],r=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=e[0],c=e[1],f=e[2],M=e[3],h=e[4],d=e[5];return Math.abs(a-s)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(r-c)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(o-f)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(i-M)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(u-h)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(h))&&Math.abs(l-d)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(d))},t.exports=r},function(t,e,a){var n=a(19),r={};r.create=function(){var t=new n.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},r.clone=function(t){var e=new n.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromValues=function(t,e,a,r,o,i,u,l,s){var c=new n.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=a,c[3]=r,c[4]=o,c[5]=i,c[6]=u,c[7]=l,c[8]=s,c},r.set=function(t,e,a,n,r,o,i,u,l,s){return t[0]=e,t[1]=a,t[2]=n,t[3]=r,t[4]=o,t[5]=i,t[6]=u,t[7]=l,t[8]=s,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.transpose=function(t,e){if(t===e){var a=e[1],n=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=a,t[5]=e[7],t[6]=n,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},r.invert=function(t,e){var a=e[0],n=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=c*i-u*s,M=-c*o+u*l,h=s*o-i*l,d=a*f+n*M+r*h;return d?(d=1/d,t[0]=f*d,t[1]=(-c*n+r*s)*d,t[2]=(u*n-r*i)*d,t[3]=M*d,t[4]=(c*a-r*l)*d,t[5]=(-u*a+r*o)*d,t[6]=h*d,t[7]=(-s*a+n*l)*d,t[8]=(i*a-n*o)*d,t):null},r.adjoint=function(t,e){var a=e[0],n=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8];return t[0]=i*c-u*s,t[1]=r*s-n*c,t[2]=n*u-r*i,t[3]=u*l-o*c,t[4]=a*c-r*l,t[5]=r*o-a*u,t[6]=o*s-i*l,t[7]=n*l-a*s,t[8]=a*i-n*o,t},r.determinant=function(t){var e=t[0],a=t[1],n=t[2],r=t[3],o=t[4],i=t[5],u=t[6],l=t[7],s=t[8];return e*(s*o-i*l)+a*(-s*r+i*u)+n*(l*r-o*u)},r.multiply=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],M=a[0],h=a[1],d=a[2],m=a[3],x=a[4],S=a[5],v=a[6],I=a[7],F=a[8];return t[0]=M*n+h*i+d*s,t[1]=M*r+h*u+d*c,t[2]=M*o+h*l+d*f,t[3]=m*n+x*i+S*s,t[4]=m*r+x*u+S*c,t[5]=m*o+x*l+S*f,t[6]=v*n+I*i+F*s,t[7]=v*r+I*u+F*c,t[8]=v*o+I*l+F*f,t},r.mul=r.multiply,r.translate=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],M=a[0],h=a[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=i,t[4]=u,t[5]=l,t[6]=M*n+h*i+s,t[7]=M*r+h*u+c,t[8]=M*o+h*l+f,t},r.rotate=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],M=Math.sin(a),h=Math.cos(a);return t[0]=h*n+M*i,t[1]=h*r+M*u,t[2]=h*o+M*l,t[3]=h*i-M*n,t[4]=h*u-M*r,t[5]=h*l-M*o,t[6]=s,t[7]=c,t[8]=f,t},r.scale=function(t,e,a){var n=a[0],r=a[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},r.fromRotation=function(t,e){var a=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=a,t[2]=0,t[3]=-a,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},r.fromQuat=function(t,e){var a=e[0],n=e[1],r=e[2],o=e[3],i=a+a,u=n+n,l=r+r,s=a*i,c=n*i,f=n*u,M=r*i,h=r*u,d=r*l,m=o*i,x=o*u,S=o*l;return t[0]=1-f-d,t[3]=c-S,t[6]=M+x,t[1]=c+S,t[4]=1-s-d,t[7]=h-m,t[2]=M-x,t[5]=h+m,t[8]=1-s-f,t},r.normalFromMat4=function(t,e){var a=e[0],n=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=e[9],M=e[10],h=e[11],d=e[12],m=e[13],x=e[14],S=e[15],v=a*u-n*i,I=a*l-r*i,F=a*s-o*i,D=n*l-r*u,p=n*s-o*u,b=r*s-o*l,g=c*m-f*d,y=c*x-M*d,A=c*S-h*d,w=f*x-M*m,E=f*S-h*m,R=M*S-h*x,T=v*R-I*E+F*w+D*A-p*y+b*g;return T?(T=1/T,t[0]=(u*R-l*E+s*w)*T,t[1]=(l*A-i*R-s*y)*T,t[2]=(i*E-u*A+s*g)*T,t[3]=(r*E-n*R-o*w)*T,t[4]=(a*R-r*A+o*y)*T,t[5]=(n*A-a*E-o*g)*T,t[6]=(m*b-x*p+S*D)*T,t[7]=(x*F-d*b-S*I)*T,t[8]=(d*p-m*F+S*v)*T,t):null},r.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},r.add=function(t,e,a){return t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t[3]=e[3]+a[3],t[4]=e[4]+a[4],t[5]=e[5]+a[5],t[6]=e[6]+a[6],t[7]=e[7]+a[7],t[8]=e[8]+a[8],t},r.subtract=function(t,e,a){return t[0]=e[0]-a[0],t[1]=e[1]-a[1],t[2]=e[2]-a[2],t[3]=e[3]-a[3],t[4]=e[4]-a[4],t[5]=e[5]-a[5],t[6]=e[6]-a[6],t[7]=e[7]-a[7],t[8]=e[8]-a[8],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,a){return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*a,t},r.multiplyScalarAndAdd=function(t,e,a,n){return t[0]=e[0]+a[0]*n,t[1]=e[1]+a[1]*n,t[2]=e[2]+a[2]*n,t[3]=e[3]+a[3]*n,t[4]=e[4]+a[4]*n,t[5]=e[5]+a[5]*n,t[6]=e[6]+a[6]*n,t[7]=e[7]+a[7]*n,t[8]=e[8]+a[8]*n,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},r.equals=function(t,e){var a=t[0],r=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=t[6],c=t[7],f=t[8],M=e[0],h=e[1],d=e[2],m=e[3],x=e[4],S=e[5],v=t[6],I=e[7],F=e[8];return Math.abs(a-M)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(r-h)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(o-d)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(i-m)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(u-x)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(l-S)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(s-v)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(c-I)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(f-F)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(F))},t.exports=r},function(t,e,a){var n=a(19),r={scalar:{},SIMD:{}};r.create=function(){var t=new n.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.clone=function(t){var e=new n.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.fromValues=function(t,e,a,r,o,i,u,l,s,c,f,M,h,d,m,x){var S=new n.ARRAY_TYPE(16);return S[0]=t,S[1]=e,S[2]=a,S[3]=r,S[4]=o,S[5]=i,S[6]=u,S[7]=l,S[8]=s,S[9]=c,S[10]=f,S[11]=M,S[12]=h,S[13]=d,S[14]=m,S[15]=x,S},r.set=function(t,e,a,n,r,o,i,u,l,s,c,f,M,h,d,m,x){return t[0]=e,t[1]=a,t[2]=n,t[3]=r,t[4]=o,t[5]=i,t[6]=u,t[7]=l,t[8]=s,t[9]=c,t[10]=f,t[11]=M,t[12]=h,t[13]=d,t[14]=m,t[15]=x,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.scalar.transpose=function(t,e){if(t===e){var a=e[1],n=e[2],r=e[3],o=e[6],i=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=a,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=r,t[13]=i,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},r.SIMD.transpose=function(t,e){var a,n,r,o,i,u,l,s,c,f;return a=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),r=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),i=SIMD.Float32x4.shuffle(a,n,0,1,4,5),u=SIMD.Float32x4.shuffle(r,o,0,1,4,5),l=SIMD.Float32x4.shuffle(i,u,0,2,4,6),s=SIMD.Float32x4.shuffle(i,u,1,3,5,7),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,s),i=SIMD.Float32x4.shuffle(a,n,2,3,6,7),u=SIMD.Float32x4.shuffle(r,o,2,3,6,7),c=SIMD.Float32x4.shuffle(i,u,0,2,4,6),f=SIMD.Float32x4.shuffle(i,u,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,f),t},r.transpose=n.USE_SIMD?r.SIMD.transpose:r.scalar.transpose,r.scalar.invert=function(t,e){var a=e[0],n=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=e[9],M=e[10],h=e[11],d=e[12],m=e[13],x=e[14],S=e[15],v=a*u-n*i,I=a*l-r*i,F=a*s-o*i,D=n*l-r*u,p=n*s-o*u,b=r*s-o*l,g=c*m-f*d,y=c*x-M*d,A=c*S-h*d,w=f*x-M*m,E=f*S-h*m,R=M*S-h*x,T=v*R-I*E+F*w+D*A-p*y+b*g;return T?(T=1/T,t[0]=(u*R-l*E+s*w)*T,t[1]=(r*E-n*R-o*w)*T,t[2]=(m*b-x*p+S*D)*T,t[3]=(M*p-f*b-h*D)*T,t[4]=(l*A-i*R-s*y)*T,t[5]=(a*R-r*A+o*y)*T,t[6]=(x*F-d*b-S*I)*T,t[7]=(c*b-M*F+h*I)*T,t[8]=(i*E-u*A+s*g)*T,t[9]=(n*A-a*E-o*g)*T,t[10]=(d*p-m*F+S*v)*T,t[11]=(f*F-c*p-h*v)*T,t[12]=(u*y-i*w-l*g)*T,t[13]=(a*w-n*y+r*g)*T,t[14]=(m*I-d*D-x*v)*T,t[15]=(c*D-f*I+M*v)*T,t):null},r.SIMD.invert=function(t,e){var a,n,r,o,i,u,l,s,c,f,M=SIMD.Float32x4.load(e,0),h=SIMD.Float32x4.load(e,4),d=SIMD.Float32x4.load(e,8),m=SIMD.Float32x4.load(e,12);return i=SIMD.Float32x4.shuffle(M,h,0,1,4,5),n=SIMD.Float32x4.shuffle(d,m,0,1,4,5),a=SIMD.Float32x4.shuffle(i,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,i,1,3,5,7),i=SIMD.Float32x4.shuffle(M,h,2,3,6,7),o=SIMD.Float32x4.shuffle(d,m,2,3,6,7),r=SIMD.Float32x4.shuffle(i,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,i,1,3,5,7),i=SIMD.Float32x4.mul(r,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.mul(n,i),l=SIMD.Float32x4.mul(a,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),u),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),i=SIMD.Float32x4.mul(n,r),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),u),c=SIMD.Float32x4.mul(a,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,i)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),i=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),r=SIMD.Float32x4.swizzle(r,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),u),s=SIMD.Float32x4.mul(a,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(r,i)),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),i=SIMD.Float32x4.mul(a,n),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),s),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),c),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),s),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(r,i)),i=SIMD.Float32x4.mul(a,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,i)),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),s),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),l),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(n,i)),i=SIMD.Float32x4.mul(a,r),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(n,i)),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(o,i)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),c),f=SIMD.Float32x4.mul(a,u),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f),i=SIMD.Float32x4.reciprocalApproximation(f),f=SIMD.Float32x4.sub(SIMD.Float32x4.add(i,i),SIMD.Float32x4.mul(f,SIMD.Float32x4.mul(i,i))),(f=SIMD.Float32x4.swizzle(f,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(f,u)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(f,l)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(f,s)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(f,c)),t):null},r.invert=n.USE_SIMD?r.SIMD.invert:r.scalar.invert,r.scalar.adjoint=function(t,e){var a=e[0],n=e[1],r=e[2],o=e[3],i=e[4],u=e[5],l=e[6],s=e[7],c=e[8],f=e[9],M=e[10],h=e[11],d=e[12],m=e[13],x=e[14],S=e[15];return t[0]=u*(M*S-h*x)-f*(l*S-s*x)+m*(l*h-s*M),t[1]=-(n*(M*S-h*x)-f*(r*S-o*x)+m*(r*h-o*M)),t[2]=n*(l*S-s*x)-u*(r*S-o*x)+m*(r*s-o*l),t[3]=-(n*(l*h-s*M)-u*(r*h-o*M)+f*(r*s-o*l)),t[4]=-(i*(M*S-h*x)-c*(l*S-s*x)+d*(l*h-s*M)),t[5]=a*(M*S-h*x)-c*(r*S-o*x)+d*(r*h-o*M),t[6]=-(a*(l*S-s*x)-i*(r*S-o*x)+d*(r*s-o*l)),t[7]=a*(l*h-s*M)-i*(r*h-o*M)+c*(r*s-o*l),t[8]=i*(f*S-h*m)-c*(u*S-s*m)+d*(u*h-s*f),t[9]=-(a*(f*S-h*m)-c*(n*S-o*m)+d*(n*h-o*f)),t[10]=a*(u*S-s*m)-i*(n*S-o*m)+d*(n*s-o*u),t[11]=-(a*(u*h-s*f)-i*(n*h-o*f)+c*(n*s-o*u)),t[12]=-(i*(f*x-M*m)-c*(u*x-l*m)+d*(u*M-l*f)),t[13]=a*(f*x-M*m)-c*(n*x-r*m)+d*(n*M-r*f),t[14]=-(a*(u*x-l*m)-i*(n*x-r*m)+d*(n*l-r*u)),t[15]=a*(u*M-l*f)-i*(n*M-r*f)+c*(n*l-r*u),t},r.SIMD.adjoint=function(t,e){var a,n,r,o,i,u,l,s,c,f,M,h,d,a=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),r=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12);return c=SIMD.Float32x4.shuffle(a,n,0,1,4,5),u=SIMD.Float32x4.shuffle(r,o,0,1,4,5),i=SIMD.Float32x4.shuffle(c,u,0,2,4,6),u=SIMD.Float32x4.shuffle(u,c,1,3,5,7),c=SIMD.Float32x4.shuffle(a,n,2,3,6,7),s=SIMD.Float32x4.shuffle(r,o,2,3,6,7),l=SIMD.Float32x4.shuffle(c,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,c,1,3,5,7),c=SIMD.Float32x4.mul(l,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.mul(u,c),M=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),f),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),c=SIMD.Float32x4.mul(u,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),f),d=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(s,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,3,0,1),s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),l=SIMD.Float32x4.swizzle(l,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),f),h=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,c)),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.mul(i,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),h),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),h),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(l,c)),c=SIMD.Float32x4.mul(i,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(l,c)),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),h),c=SIMD.Float32x4.swizzle(c,2,3,0,1),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),M),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(i,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),M),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(s,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),d),SIMD.Float32x4.store(t,0,f),SIMD.Float32x4.store(t,4,M),SIMD.Float32x4.store(t,8,h),SIMD.Float32x4.store(t,12,d),t},r.adjoint=n.USE_SIMD?r.SIMD.adjoint:r.scalar.adjoint,r.determinant=function(t){var e=t[0],a=t[1],n=t[2],r=t[3],o=t[4],i=t[5],u=t[6],l=t[7],s=t[8],c=t[9],f=t[10],M=t[11],h=t[12],d=t[13],m=t[14],x=t[15],S=e*i-a*o,v=e*u-n*o,I=e*l-r*o,F=a*u-n*i,D=a*l-r*i,p=n*l-r*u,b=s*d-c*h,g=s*m-f*h,y=s*x-M*h,A=c*m-f*d,w=c*x-M*d,E=f*x-M*m;return S*E-v*w+I*A+F*y-D*g+p*b},r.SIMD.multiply=function(t,e,a){var n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4.load(a,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),i))));SIMD.Float32x4.store(t,0,l);var s=SIMD.Float32x4.load(a,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),i))));SIMD.Float32x4.store(t,4,c);var f=SIMD.Float32x4.load(a,8),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),i))));SIMD.Float32x4.store(t,8,M);var h=SIMD.Float32x4.load(a,12),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),i))));return SIMD.Float32x4.store(t,12,d),t},r.scalar.multiply=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],M=e[9],h=e[10],d=e[11],m=e[12],x=e[13],S=e[14],v=e[15],I=a[0],F=a[1],D=a[2],p=a[3];return t[0]=I*n+F*u+D*f+p*m,t[1]=I*r+F*l+D*M+p*x,t[2]=I*o+F*s+D*h+p*S,t[3]=I*i+F*c+D*d+p*v,I=a[4],F=a[5],D=a[6],p=a[7],t[4]=I*n+F*u+D*f+p*m,t[5]=I*r+F*l+D*M+p*x,t[6]=I*o+F*s+D*h+p*S,t[7]=I*i+F*c+D*d+p*v,I=a[8],F=a[9],D=a[10],p=a[11],t[8]=I*n+F*u+D*f+p*m,t[9]=I*r+F*l+D*M+p*x,t[10]=I*o+F*s+D*h+p*S,t[11]=I*i+F*c+D*d+p*v,I=a[12],F=a[13],D=a[14],p=a[15],t[12]=I*n+F*u+D*f+p*m,t[13]=I*r+F*l+D*M+p*x,t[14]=I*o+F*s+D*h+p*S,t[15]=I*i+F*c+D*d+p*v,t},r.multiply=n.USE_SIMD?r.SIMD.multiply:r.scalar.multiply,r.mul=r.multiply,r.scalar.translate=function(t,e,a){var n,r,o,i,u,l,s,c,f,M,h,d,m=a[0],x=a[1],S=a[2];return e===t?(t[12]=e[0]*m+e[4]*x+e[8]*S+e[12],t[13]=e[1]*m+e[5]*x+e[9]*S+e[13],t[14]=e[2]*m+e[6]*x+e[10]*S+e[14],t[15]=e[3]*m+e[7]*x+e[11]*S+e[15]):(n=e[0],r=e[1],o=e[2],i=e[3],u=e[4],l=e[5],s=e[6],c=e[7],f=e[8],M=e[9],h=e[10],d=e[11],t[0]=n,t[1]=r,t[2]=o,t[3]=i,t[4]=u,t[5]=l,t[6]=s,t[7]=c,t[8]=f,t[9]=M,t[10]=h,t[11]=d,t[12]=n*m+u*x+f*S+e[12],t[13]=r*m+l*x+M*S+e[13],t[14]=o*m+s*x+h*S+e[14],t[15]=i*m+c*x+d*S+e[15]),t},r.SIMD.translate=function(t,e,a){var n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4(a[0],a[1],a[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(u,0,0,0,0)),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(u,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(u,2,2,2,2));var l=SIMD.Float32x4.add(n,SIMD.Float32x4.add(r,SIMD.Float32x4.add(o,i)));return SIMD.Float32x4.store(t,12,l),t},r.translate=n.USE_SIMD?r.SIMD.translate:r.scalar.translate,r.scalar.scale=function(t,e,a){var n=a[0],r=a[1],o=a[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.SIMD.scale=function(t,e,a){var n,r,o,i=SIMD.Float32x4(a[0],a[1],a[2],0);return n=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(i,0,0,0,0))),r=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(i,1,1,1,1))),o=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(i,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.scale=n.USE_SIMD?r.SIMD.scale:r.scalar.scale,r.rotate=function(t,e,a,r){var o,i,u,l,s,c,f,M,h,d,m,x,S,v,I,F,D,p,b,g,y,A,w,E,R=r[0],T=r[1],P=r[2],_=Math.sqrt(R*R+T*T+P*P);return Math.abs(_)<n.EPSILON?null:(_=1/_,R*=_,T*=_,P*=_,o=Math.sin(a),i=Math.cos(a),u=1-i,l=e[0],s=e[1],c=e[2],f=e[3],M=e[4],h=e[5],d=e[6],m=e[7],x=e[8],S=e[9],v=e[10],I=e[11],F=R*R*u+i,D=T*R*u+P*o,p=P*R*u-T*o,b=R*T*u-P*o,g=T*T*u+i,y=P*T*u+R*o,A=R*P*u+T*o,w=T*P*u-R*o,E=P*P*u+i,t[0]=l*F+M*D+x*p,t[1]=s*F+h*D+S*p,t[2]=c*F+d*D+v*p,t[3]=f*F+m*D+I*p,t[4]=l*b+M*g+x*y,t[5]=s*b+h*g+S*y,t[6]=c*b+d*g+v*y,t[7]=f*b+m*g+I*y,t[8]=l*A+M*w+x*E,t[9]=s*A+h*w+S*E,t[10]=c*A+d*w+v*E,t[11]=f*A+m*w+I*E,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},r.scalar.rotateX=function(t,e,a){var n=Math.sin(a),r=Math.cos(a),o=e[4],i=e[5],u=e[6],l=e[7],s=e[8],c=e[9],f=e[10],M=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+s*n,t[5]=i*r+c*n,t[6]=u*r+f*n,t[7]=l*r+M*n,t[8]=s*r-o*n,t[9]=c*r-i*n,t[10]=f*r-u*n,t[11]=M*r-l*n,t},r.SIMD.rotateX=function(t,e,a){var n=SIMD.Float32x4.splat(Math.sin(a)),r=SIMD.Float32x4.splat(Math.cos(a));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,r),SIMD.Float32x4.mul(o,n))),t},r.rotateX=n.USE_SIMD?r.SIMD.rotateX:r.scalar.rotateX,r.scalar.rotateY=function(t,e,a){var n=Math.sin(a),r=Math.cos(a),o=e[0],i=e[1],u=e[2],l=e[3],s=e[8],c=e[9],f=e[10],M=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-s*n,t[1]=i*r-c*n,t[2]=u*r-f*n,t[3]=l*r-M*n,t[8]=o*n+s*r,t[9]=i*n+c*r,t[10]=u*n+f*r,t[11]=l*n+M*r,t},r.SIMD.rotateY=function(t,e,a){var n=SIMD.Float32x4.splat(Math.sin(a)),r=SIMD.Float32x4.splat(Math.cos(a));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(i,r))),t},r.rotateY=n.USE_SIMD?r.SIMD.rotateY:r.scalar.rotateY,r.scalar.rotateZ=function(t,e,a){var n=Math.sin(a),r=Math.cos(a),o=e[0],i=e[1],u=e[2],l=e[3],s=e[4],c=e[5],f=e[6],M=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+s*n,t[1]=i*r+c*n,t[2]=u*r+f*n,t[3]=l*r+M*n,t[4]=s*r-o*n,t[5]=c*r-i*n,t[6]=f*r-u*n,t[7]=M*r-l*n,t},r.SIMD.rotateZ=function(t,e,a){var n=SIMD.Float32x4.splat(Math.sin(a)),r=SIMD.Float32x4.splat(Math.cos(a));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,n))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,r),SIMD.Float32x4.mul(o,n))),t},r.rotateZ=n.USE_SIMD?r.SIMD.rotateZ:r.scalar.rotateZ,r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotation=function(t,e,a){var r,o,i,u=a[0],l=a[1],s=a[2],c=Math.sqrt(u*u+l*l+s*s);return Math.abs(c)<n.EPSILON?null:(c=1/c,u*=c,l*=c,s*=c,r=Math.sin(e),o=Math.cos(e),i=1-o,t[0]=u*u*i+o,t[1]=l*u*i+s*r,t[2]=s*u*i-l*r,t[3]=0,t[4]=u*l*i-s*r,t[5]=l*l*i+o,t[6]=s*l*i+u*r,t[7]=0,t[8]=u*s*i+l*r,t[9]=l*s*i-u*r,t[10]=s*s*i+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},r.fromXRotation=function(t,e){var a=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=a,t[7]=0,t[8]=0,t[9]=-a,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromYRotation=function(t,e){var a=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-a,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=a,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromZRotation=function(t,e){var a=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=a,t[2]=0,t[3]=0,t[4]=-a,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotationTranslation=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3],u=n+n,l=r+r,s=o+o,c=n*u,f=n*l,M=n*s,h=r*l,d=r*s,m=o*s,x=i*u,S=i*l,v=i*s;return t[0]=1-(h+m),t[1]=f+v,t[2]=M-S,t[3]=0,t[4]=f-v,t[5]=1-(c+m),t[6]=d+x,t[7]=0,t[8]=M+S,t[9]=d-x,t[10]=1-(c+h),t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},r.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},r.getRotation=function(t,e){var a=e[0]+e[5]+e[10],n=0;return a>0?(n=2*Math.sqrt(a+1),t[3]=.25*n,t[0]=(e[6]-e[9])/n,t[1]=(e[8]-e[2])/n,t[2]=(e[1]-e[4])/n):e[0]>e[5]&e[0]>e[10]?(n=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/n,t[0]=.25*n,t[1]=(e[1]+e[4])/n,t[2]=(e[8]+e[2])/n):e[5]>e[10]?(n=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/n,t[0]=(e[1]+e[4])/n,t[1]=.25*n,t[2]=(e[6]+e[9])/n):(n=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/n,t[0]=(e[8]+e[2])/n,t[1]=(e[6]+e[9])/n,t[2]=.25*n),t},r.fromRotationTranslationScale=function(t,e,a,n){var r=e[0],o=e[1],i=e[2],u=e[3],l=r+r,s=o+o,c=i+i,f=r*l,M=r*s,h=r*c,d=o*s,m=o*c,x=i*c,S=u*l,v=u*s,I=u*c,F=n[0],D=n[1],p=n[2];return t[0]=(1-(d+x))*F,t[1]=(M+I)*F,t[2]=(h-v)*F,t[3]=0,t[4]=(M-I)*D,t[5]=(1-(f+x))*D,t[6]=(m+S)*D,t[7]=0,t[8]=(h+v)*p,t[9]=(m-S)*p,t[10]=(1-(f+d))*p,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},r.fromRotationTranslationScaleOrigin=function(t,e,a,n,r){var o=e[0],i=e[1],u=e[2],l=e[3],s=o+o,c=i+i,f=u+u,M=o*s,h=o*c,d=o*f,m=i*c,x=i*f,S=u*f,v=l*s,I=l*c,F=l*f,D=n[0],p=n[1],b=n[2],g=r[0],y=r[1],A=r[2];return t[0]=(1-(m+S))*D,t[1]=(h+F)*D,t[2]=(d-I)*D,t[3]=0,t[4]=(h-F)*p,t[5]=(1-(M+S))*p,t[6]=(x+v)*p,t[7]=0,t[8]=(d+I)*b,t[9]=(x-v)*b,t[10]=(1-(M+m))*b,t[11]=0,t[12]=a[0]+g-(t[0]*g+t[4]*y+t[8]*A),t[13]=a[1]+y-(t[1]*g+t[5]*y+t[9]*A),t[14]=a[2]+A-(t[2]*g+t[6]*y+t[10]*A),t[15]=1,t},r.fromQuat=function(t,e){var a=e[0],n=e[1],r=e[2],o=e[3],i=a+a,u=n+n,l=r+r,s=a*i,c=n*i,f=n*u,M=r*i,h=r*u,d=r*l,m=o*i,x=o*u,S=o*l;return t[0]=1-f-d,t[1]=c+S,t[2]=M-x,t[3]=0,t[4]=c-S,t[5]=1-s-d,t[6]=h+m,t[7]=0,t[8]=M+x,t[9]=h-m,t[10]=1-s-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.frustum=function(t,e,a,n,r,o,i){var u=1/(a-e),l=1/(r-n),s=1/(o-i);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(a+e)*u,t[9]=(r+n)*l,t[10]=(i+o)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*s,t[15]=0,t},r.perspective=function(t,e,a,n,r){var o=1/Math.tan(e/2),i=1/(n-r);return t[0]=o/a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+n)*i,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*n*i,t[15]=0,t},r.perspectiveFromFieldOfView=function(t,e,a,n){var r=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),l=2/(i+u),s=2/(r+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-((i-u)*l*.5),t[9]=(r-o)*s*.5,t[10]=n/(a-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*a/(a-n),t[15]=0,t},r.ortho=function(t,e,a,n,r,o,i){var u=1/(e-a),l=1/(n-r),s=1/(o-i);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(e+a)*u,t[13]=(r+n)*l,t[14]=(i+o)*s,t[15]=1,t},r.lookAt=function(t,e,a,o){var i,u,l,s,c,f,M,h,d,m,x=e[0],S=e[1],v=e[2],I=o[0],F=o[1],D=o[2],p=a[0],b=a[1],g=a[2];return Math.abs(x-p)<n.EPSILON&&Math.abs(S-b)<n.EPSILON&&Math.abs(v-g)<n.EPSILON?r.identity(t):(M=x-p,h=S-b,d=v-g,m=1/Math.sqrt(M*M+h*h+d*d),M*=m,h*=m,d*=m,i=F*d-D*h,u=D*M-I*d,l=I*h-F*M,m=Math.sqrt(i*i+u*u+l*l),m?(m=1/m,i*=m,u*=m,l*=m):(i=0,u=0,l=0),s=h*l-d*u,c=d*i-M*l,f=M*u-h*i,m=Math.sqrt(s*s+c*c+f*f),m?(m=1/m,s*=m,c*=m,f*=m):(s=0,c=0,f=0),t[0]=i,t[1]=s,t[2]=M,t[3]=0,t[4]=u,t[5]=c,t[6]=h,t[7]=0,t[8]=l,t[9]=f,t[10]=d,t[11]=0,t[12]=-(i*x+u*S+l*v),t[13]=-(s*x+c*S+f*v),t[14]=-(M*x+h*S+d*v),t[15]=1,t)},r.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},r.add=function(t,e,a){return t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t[3]=e[3]+a[3],t[4]=e[4]+a[4],t[5]=e[5]+a[5],t[6]=e[6]+a[6],t[7]=e[7]+a[7],t[8]=e[8]+a[8],t[9]=e[9]+a[9],t[10]=e[10]+a[10],t[11]=e[11]+a[11],t[12]=e[12]+a[12],t[13]=e[13]+a[13],t[14]=e[14]+a[14],t[15]=e[15]+a[15],t},r.subtract=function(t,e,a){return t[0]=e[0]-a[0],t[1]=e[1]-a[1],t[2]=e[2]-a[2],t[3]=e[3]-a[3],t[4]=e[4]-a[4],t[5]=e[5]-a[5],t[6]=e[6]-a[6],t[7]=e[7]-a[7],t[8]=e[8]-a[8],t[9]=e[9]-a[9],t[10]=e[10]-a[10],t[11]=e[11]-a[11],t[12]=e[12]-a[12],t[13]=e[13]-a[13],t[14]=e[14]-a[14],t[15]=e[15]-a[15],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,a){return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12]*a,t[13]=e[13]*a,t[14]=e[14]*a,t[15]=e[15]*a,t},r.multiplyScalarAndAdd=function(t,e,a,n){return t[0]=e[0]+a[0]*n,t[1]=e[1]+a[1]*n,t[2]=e[2]+a[2]*n,t[3]=e[3]+a[3]*n,t[4]=e[4]+a[4]*n,t[5]=e[5]+a[5]*n,t[6]=e[6]+a[6]*n,t[7]=e[7]+a[7]*n,t[8]=e[8]+a[8]*n,t[9]=e[9]+a[9]*n,t[10]=e[10]+a[10]*n,t[11]=e[11]+a[11]*n,t[12]=e[12]+a[12]*n,t[13]=e[13]+a[13]*n,t[14]=e[14]+a[14]*n,t[15]=e[15]+a[15]*n,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},r.equals=function(t,e){var a=t[0],r=t[1],o=t[2],i=t[3],u=t[4],l=t[5],s=t[6],c=t[7],f=t[8],M=t[9],h=t[10],d=t[11],m=t[12],x=t[13],S=t[14],v=t[15],I=e[0],F=e[1],D=e[2],p=e[3],b=e[4],g=e[5],y=e[6],A=e[7],w=e[8],E=e[9],R=e[10],T=e[11],P=e[12],_=e[13],L=e[14],C=e[15];return Math.abs(a-I)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(I))&&Math.abs(r-F)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(F))&&Math.abs(o-D)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(i-p)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(u-b)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(l-g)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(s-y)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(c-A)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(f-w)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(M-E)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(E))&&Math.abs(h-R)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(d-T)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(m-P)<=n.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(x-_)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(_))&&Math.abs(S-L)<=n.EPSILON*Math.max(1,Math.abs(S),Math.abs(L))&&Math.abs(v-C)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(C));
},t.exports=r},function(t,e,a){var n=a(19),r=a(22),o=a(25),i=a(26),u={};u.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),a=o.fromValues(0,1,0);return function(n,r,i){var l=o.dot(r,i);return-.999999>l?(o.cross(t,e,r),o.length(t)<1e-6&&o.cross(t,a,r),o.normalize(t,t),u.setAxisAngle(n,t,Math.PI),n):l>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(o.cross(t,r,i),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+l,u.normalize(n,n))}}(),u.setAxes=function(){var t=r.create();return function(e,a,n,r){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-a[0],t[5]=-a[1],t[8]=-a[2],u.normalize(e,u.fromMat3(e,t))}}(),u.clone=i.clone,u.fromValues=i.fromValues,u.copy=i.copy,u.set=i.set,u.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.setAxisAngle=function(t,e,a){a=.5*a;var n=Math.sin(a);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(a),t},u.getAxisAngle=function(t,e){var a=2*Math.acos(e[3]),n=Math.sin(a/2);return 0!=n?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),a},u.add=i.add,u.multiply=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3],u=a[0],l=a[1],s=a[2],c=a[3];return t[0]=n*c+i*u+r*s-o*l,t[1]=r*c+i*l+o*u-n*s,t[2]=o*c+i*s+n*l-r*u,t[3]=i*c-n*u-r*l-o*s,t},u.mul=u.multiply,u.scale=i.scale,u.rotateX=function(t,e,a){a*=.5;var n=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(a),l=Math.cos(a);return t[0]=n*l+i*u,t[1]=r*l+o*u,t[2]=o*l-r*u,t[3]=i*l-n*u,t},u.rotateY=function(t,e,a){a*=.5;var n=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(a),l=Math.cos(a);return t[0]=n*l-o*u,t[1]=r*l+i*u,t[2]=o*l+n*u,t[3]=i*l-r*u,t},u.rotateZ=function(t,e,a){a*=.5;var n=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(a),l=Math.cos(a);return t[0]=n*l+r*u,t[1]=r*l-n*u,t[2]=o*l+i*u,t[3]=i*l-o*u,t},u.calculateW=function(t,e){var a=e[0],n=e[1],r=e[2];return t[0]=a,t[1]=n,t[2]=r,t[3]=Math.sqrt(Math.abs(1-a*a-n*n-r*r)),t},u.dot=i.dot,u.lerp=i.lerp,u.slerp=function(t,e,a,n){var r,o,i,u,l,s=e[0],c=e[1],f=e[2],M=e[3],h=a[0],d=a[1],m=a[2],x=a[3];return o=s*h+c*d+f*m+M*x,0>o&&(o=-o,h=-h,d=-d,m=-m,x=-x),1-o>1e-6?(r=Math.acos(o),i=Math.sin(r),u=Math.sin((1-n)*r)/i,l=Math.sin(n*r)/i):(u=1-n,l=n),t[0]=u*s+l*h,t[1]=u*c+l*d,t[2]=u*f+l*m,t[3]=u*M+l*x,t},u.sqlerp=function(){var t=u.create(),e=u.create();return function(a,n,r,o,i,l){return u.slerp(t,n,i,l),u.slerp(e,r,o,l),u.slerp(a,t,e,2*l*(1-l)),a}}(),u.invert=function(t,e){var a=e[0],n=e[1],r=e[2],o=e[3],i=a*a+n*n+r*r+o*o,u=i?1/i:0;return t[0]=-a*u,t[1]=-n*u,t[2]=-r*u,t[3]=o*u,t},u.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},u.length=i.length,u.len=u.length,u.squaredLength=i.squaredLength,u.sqrLen=u.squaredLength,u.normalize=i.normalize,u.fromMat3=function(t,e){var a,n=e[0]+e[4]+e[8];if(n>0)a=Math.sqrt(n+1),t[3]=.5*a,a=.5/a,t[0]=(e[5]-e[7])*a,t[1]=(e[6]-e[2])*a,t[2]=(e[1]-e[3])*a;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,i=(r+2)%3;a=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*i+i]+1),t[r]=.5*a,a=.5/a,t[3]=(e[3*o+i]-e[3*i+o])*a,t[o]=(e[3*o+r]+e[3*r+o])*a,t[i]=(e[3*i+r]+e[3*r+i])*a}return t},u.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},u.exactEquals=i.exactEquals,u.equals=i.equals,t.exports=u},function(t,e,a){var n=a(19),r={};r.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},r.fromValues=function(t,e,a){var r=new n.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=a,r},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},r.set=function(t,e,a,n){return t[0]=e,t[1]=a,t[2]=n,t},r.add=function(t,e,a){return t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t},r.subtract=function(t,e,a){return t[0]=e[0]-a[0],t[1]=e[1]-a[1],t[2]=e[2]-a[2],t},r.sub=r.subtract,r.multiply=function(t,e,a){return t[0]=e[0]*a[0],t[1]=e[1]*a[1],t[2]=e[2]*a[2],t},r.mul=r.multiply,r.divide=function(t,e,a){return t[0]=e[0]/a[0],t[1]=e[1]/a[1],t[2]=e[2]/a[2],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},r.min=function(t,e,a){return t[0]=Math.min(e[0],a[0]),t[1]=Math.min(e[1],a[1]),t[2]=Math.min(e[2],a[2]),t},r.max=function(t,e,a){return t[0]=Math.max(e[0],a[0]),t[1]=Math.max(e[1],a[1]),t[2]=Math.max(e[2],a[2]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},r.scale=function(t,e,a){return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t},r.scaleAndAdd=function(t,e,a,n){return t[0]=e[0]+a[0]*n,t[1]=e[1]+a[1]*n,t[2]=e[2]+a[2]*n,t},r.distance=function(t,e){var a=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(a*a+n*n+r*r)},r.dist=r.distance,r.squaredDistance=function(t,e){var a=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return a*a+n*n+r*r},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],a=t[1],n=t[2];return Math.sqrt(e*e+a*a+n*n)},r.len=r.length,r.squaredLength=function(t){var e=t[0],a=t[1],n=t[2];return e*e+a*a+n*n},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},r.normalize=function(t,e){var a=e[0],n=e[1],r=e[2],o=a*a+n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},r.cross=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=a[0],u=a[1],l=a[2];return t[0]=r*l-o*u,t[1]=o*i-n*l,t[2]=n*u-r*i,t},r.lerp=function(t,e,a,n){var r=e[0],o=e[1],i=e[2];return t[0]=r+n*(a[0]-r),t[1]=o+n*(a[1]-o),t[2]=i+n*(a[2]-i),t},r.hermite=function(t,e,a,n,r,o){var i=o*o,u=i*(2*o-3)+1,l=i*(o-2)+o,s=i*(o-1),c=i*(3-2*o);return t[0]=e[0]*u+a[0]*l+n[0]*s+r[0]*c,t[1]=e[1]*u+a[1]*l+n[1]*s+r[1]*c,t[2]=e[2]*u+a[2]*l+n[2]*s+r[2]*c,t},r.bezier=function(t,e,a,n,r,o){var i=1-o,u=i*i,l=o*o,s=u*i,c=3*o*u,f=3*l*i,M=l*o;return t[0]=e[0]*s+a[0]*c+n[0]*f+r[0]*M,t[1]=e[1]*s+a[1]*c+n[1]*f+r[1]*M,t[2]=e[2]*s+a[2]*c+n[2]*f+r[2]*M,t},r.random=function(t,e){e=e||1;var a=2*n.RANDOM()*Math.PI,r=2*n.RANDOM()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(a)*o,t[1]=Math.sin(a)*o,t[2]=r*e,t},r.transformMat4=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=a[3]*n+a[7]*r+a[11]*o+a[15];return i=i||1,t[0]=(a[0]*n+a[4]*r+a[8]*o+a[12])/i,t[1]=(a[1]*n+a[5]*r+a[9]*o+a[13])/i,t[2]=(a[2]*n+a[6]*r+a[10]*o+a[14])/i,t},r.transformMat3=function(t,e,a){var n=e[0],r=e[1],o=e[2];return t[0]=n*a[0]+r*a[3]+o*a[6],t[1]=n*a[1]+r*a[4]+o*a[7],t[2]=n*a[2]+r*a[5]+o*a[8],t},r.transformQuat=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=a[0],u=a[1],l=a[2],s=a[3],c=s*n+u*o-l*r,f=s*r+l*n-i*o,M=s*o+i*r-u*n,h=-i*n-u*r-l*o;return t[0]=c*s+h*-i+f*-l-M*-u,t[1]=f*s+h*-u+M*-i-c*-l,t[2]=M*s+h*-l+c*-u-f*-i,t},r.rotateX=function(t,e,a,n){var r=[],o=[];return r[0]=e[0]-a[0],r[1]=e[1]-a[1],r[2]=e[2]-a[2],o[0]=r[0],o[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),o[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t},r.rotateY=function(t,e,a,n){var r=[],o=[];return r[0]=e[0]-a[0],r[1]=e[1]-a[1],r[2]=e[2]-a[2],o[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),o[1]=r[1],o[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t},r.rotateZ=function(t,e,a,n){var r=[],o=[];return r[0]=e[0]-a[0],r[1]=e[1]-a[1],r[2]=e[2]-a[2],o[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),o[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),o[2]=r[2],t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t},r.forEach=function(){var t=r.create();return function(e,a,n,r,o,i){var u,l;for(a||(a=3),n||(n=0),l=r?Math.min(r*a+n,e.length):e.length,u=n;l>u;u+=a)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}(),r.angle=function(t,e){var a=r.fromValues(t[0],t[1],t[2]),n=r.fromValues(e[0],e[1],e[2]);r.normalize(a,a),r.normalize(n,n);var o=r.dot(a,n);return o>1?0:Math.acos(o)},r.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},r.equals=function(t,e){var a=t[0],r=t[1],o=t[2],i=e[0],u=e[1],l=e[2];return Math.abs(a-i)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(i))&&Math.abs(r-u)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-l)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},t.exports=r},function(t,e,a){var n=a(19),r={};r.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.fromValues=function(t,e,a,r){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=a,o[3]=r,o},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.set=function(t,e,a,n,r){return t[0]=e,t[1]=a,t[2]=n,t[3]=r,t},r.add=function(t,e,a){return t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t[3]=e[3]+a[3],t},r.subtract=function(t,e,a){return t[0]=e[0]-a[0],t[1]=e[1]-a[1],t[2]=e[2]-a[2],t[3]=e[3]-a[3],t},r.sub=r.subtract,r.multiply=function(t,e,a){return t[0]=e[0]*a[0],t[1]=e[1]*a[1],t[2]=e[2]*a[2],t[3]=e[3]*a[3],t},r.mul=r.multiply,r.divide=function(t,e,a){return t[0]=e[0]/a[0],t[1]=e[1]/a[1],t[2]=e[2]/a[2],t[3]=e[3]/a[3],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},r.min=function(t,e,a){return t[0]=Math.min(e[0],a[0]),t[1]=Math.min(e[1],a[1]),t[2]=Math.min(e[2],a[2]),t[3]=Math.min(e[3],a[3]),t},r.max=function(t,e,a){return t[0]=Math.max(e[0],a[0]),t[1]=Math.max(e[1],a[1]),t[2]=Math.max(e[2],a[2]),t[3]=Math.max(e[3],a[3]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},r.scale=function(t,e,a){return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t},r.scaleAndAdd=function(t,e,a,n){return t[0]=e[0]+a[0]*n,t[1]=e[1]+a[1]*n,t[2]=e[2]+a[2]*n,t[3]=e[3]+a[3]*n,t},r.distance=function(t,e){var a=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(a*a+n*n+r*r+o*o)},r.dist=r.distance,r.squaredDistance=function(t,e){var a=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return a*a+n*n+r*r+o*o},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],a=t[1],n=t[2],r=t[3];return Math.sqrt(e*e+a*a+n*n+r*r)},r.len=r.length,r.squaredLength=function(t){var e=t[0],a=t[1],n=t[2],r=t[3];return e*e+a*a+n*n+r*r},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},r.normalize=function(t,e){var a=e[0],n=e[1],r=e[2],o=e[3],i=a*a+n*n+r*r+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=a*i,t[1]=n*i,t[2]=r*i,t[3]=o*i),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},r.lerp=function(t,e,a,n){var r=e[0],o=e[1],i=e[2],u=e[3];return t[0]=r+n*(a[0]-r),t[1]=o+n*(a[1]-o),t[2]=i+n*(a[2]-i),t[3]=u+n*(a[3]-u),t},r.random=function(t,e){return e=e||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),r.normalize(t,t),r.scale(t,t,e),t},r.transformMat4=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=e[3];return t[0]=a[0]*n+a[4]*r+a[8]*o+a[12]*i,t[1]=a[1]*n+a[5]*r+a[9]*o+a[13]*i,t[2]=a[2]*n+a[6]*r+a[10]*o+a[14]*i,t[3]=a[3]*n+a[7]*r+a[11]*o+a[15]*i,t},r.transformQuat=function(t,e,a){var n=e[0],r=e[1],o=e[2],i=a[0],u=a[1],l=a[2],s=a[3],c=s*n+u*o-l*r,f=s*r+l*n-i*o,M=s*o+i*r-u*n,h=-i*n-u*r-l*o;return t[0]=c*s+h*-i+f*-l-M*-u,t[1]=f*s+h*-u+M*-i-c*-l,t[2]=M*s+h*-l+c*-u-f*-i,t[3]=e[3],t},r.forEach=function(){var t=r.create();return function(e,a,n,r,o,i){var u,l;for(a||(a=4),n||(n=0),l=r?Math.min(r*a+n,e.length):e.length,u=n;l>u;u+=a)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}(),r.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var a=t[0],r=t[1],o=t[2],i=t[3],u=e[0],l=e[1],s=e[2],c=e[3];return Math.abs(a-u)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(r-l)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-s)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-c)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},t.exports=r},function(t,e,a){var n=a(19),r={};r.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},r.fromValues=function(t,e){var a=new n.ARRAY_TYPE(2);return a[0]=t,a[1]=e,a},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},r.set=function(t,e,a){return t[0]=e,t[1]=a,t},r.add=function(t,e,a){return t[0]=e[0]+a[0],t[1]=e[1]+a[1],t},r.subtract=function(t,e,a){return t[0]=e[0]-a[0],t[1]=e[1]-a[1],t},r.sub=r.subtract,r.multiply=function(t,e,a){return t[0]=e[0]*a[0],t[1]=e[1]*a[1],t},r.mul=r.multiply,r.divide=function(t,e,a){return t[0]=e[0]/a[0],t[1]=e[1]/a[1],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},r.min=function(t,e,a){return t[0]=Math.min(e[0],a[0]),t[1]=Math.min(e[1],a[1]),t},r.max=function(t,e,a){return t[0]=Math.max(e[0],a[0]),t[1]=Math.max(e[1],a[1]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},r.scale=function(t,e,a){return t[0]=e[0]*a,t[1]=e[1]*a,t},r.scaleAndAdd=function(t,e,a,n){return t[0]=e[0]+a[0]*n,t[1]=e[1]+a[1]*n,t},r.distance=function(t,e){var a=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(a*a+n*n)},r.dist=r.distance,r.squaredDistance=function(t,e){var a=e[0]-t[0],n=e[1]-t[1];return a*a+n*n},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],a=t[1];return Math.sqrt(e*e+a*a)},r.len=r.length,r.squaredLength=function(t){var e=t[0],a=t[1];return e*e+a*a},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},r.normalize=function(t,e){var a=e[0],n=e[1],r=a*a+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},r.cross=function(t,e,a){var n=e[0]*a[1]-e[1]*a[0];return t[0]=t[1]=0,t[2]=n,t},r.lerp=function(t,e,a,n){var r=e[0],o=e[1];return t[0]=r+n*(a[0]-r),t[1]=o+n*(a[1]-o),t},r.random=function(t,e){e=e||1;var a=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(a)*e,t[1]=Math.sin(a)*e,t},r.transformMat2=function(t,e,a){var n=e[0],r=e[1];return t[0]=a[0]*n+a[2]*r,t[1]=a[1]*n+a[3]*r,t},r.transformMat2d=function(t,e,a){var n=e[0],r=e[1];return t[0]=a[0]*n+a[2]*r+a[4],t[1]=a[1]*n+a[3]*r+a[5],t},r.transformMat3=function(t,e,a){var n=e[0],r=e[1];return t[0]=a[0]*n+a[3]*r+a[6],t[1]=a[1]*n+a[4]*r+a[7],t},r.transformMat4=function(t,e,a){var n=e[0],r=e[1];return t[0]=a[0]*n+a[4]*r+a[12],t[1]=a[1]*n+a[5]*r+a[13],t},r.forEach=function(){var t=r.create();return function(e,a,n,r,o,i){var u,l;for(a||(a=2),n||(n=0),l=r?Math.min(r*a+n,e.length):e.length,u=n;l>u;u+=a)t[0]=e[u],t[1]=e[u+1],o(t,t,i),e[u]=t[0],e[u+1]=t[1];return e}}(),r.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},r.equals=function(t,e){var a=t[0],r=t[1],o=e[0],i=e[1];return Math.abs(a-o)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(r-i)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))},t.exports=r},function(t,e,a){"use strict";function n(t,e,a){var n=t.createShader(e);return t.shaderSource(n,a),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(console.log("An error occurred compiling the shaders: "+t.getShaderInfoLog(n)),null)}var r=a(29),o=function(){this.fragment={},this.vertex={}};o.prototype.compileShaders=function(t){for(var e=0;e<r.config.length;e++){var a,o,i=r.config[e];i.type===r.TYPE_VERTEX?(a=this.vertex,o=t.VERTEX_SHADER):(a=this.fragment,o=t.FRAGMENT_SHADER),a[i.name]=n(t,o,i.source)}},t.exports=o},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=e.TYPE_VERTEX=1,r=e.TYPE_FRAGMENT=2;e.config=[{name:"simpleShader",type:n,source:a(30)},{name:"simpleShader",type:r,source:a(31)},{name:"lineShader",type:n,source:a(32)},{name:"lineShader",type:r,source:a(33)},{name:"particleShader",type:n,source:a(34)},{name:"particleShader",type:r,source:a(35)},{name:"barShader",type:n,source:a(36)},{name:"barShader",type:r,source:a(37)},{name:"quadShader",type:n,source:a(38)},{name:"quadShader",type:r,source:a(39)}]},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nattribute vec3 aVertexPosition;\nattribute vec4 aVertexColor;\n\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform mat4 uMMatrix;\n\nvarying lowp vec4 vColor;\n\nvoid main(void) {\n  gl_Position = uPMatrix * uMVMatrix * uMMatrix * vec4(aVertexPosition, 1.0);\n  vColor = aVertexColor;\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nvarying lowp vec4 vColor;\n      \nvoid main(void) {\n  gl_FragColor = vColor;\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nattribute vec3 inCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\n\n\nvoid main(void) {\n  gl_Position = uPMatrix * uMVMatrix * vec4(inCoord, 1.0);\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n      \nvoid main(void) {\n  gl_FragColor = vec4(1,0,0,1);\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nattribute vec3 inCoord;\n// attribute vec3 inColor;\nattribute float inAlive;\nattribute float inAge;\nattribute float inType;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform float intensity;\nuniform vec3 inColors[8];\nuniform float inFreqs[8];\nuniform float isPlaying;\n\n\nvarying vec2 coord;\nvarying float alive;\nvarying vec3 color;\nvarying float age;\nvarying float particleType;\n\n\nvoid main(void) {\n  alive = inAlive;\n  age = inAge / 1000.0;\n  particleType = inType;\n\n  gl_Position = uPMatrix * uMVMatrix * vec4(inCoord, 1.0);\n  float value = 0.0;\n  // if (intensity >= 0.0) {\n  //  value = intensity;\n  // }\n  if (isPlaying > 0.0) {\n    value = inFreqs[int(particleType)];\n    gl_PointSize = 10.0 + (value * 90.0);\n  } else {\n    gl_PointSize = 40.0;\n  }\n\n  coord = inCoord.xy;\n\n  color = inColors[int(particleType)];\n\n}\n"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\nprecision mediump float;\n\nuniform float inFrame;\nvarying vec2 coord;\nvarying vec3 color;\n\nvarying float alive;\n\nvarying float age;\nvarying float particleType;\n\nuniform sampler2D inTexture;\n\n\nvoid main(void) {\n  if (alive != 1.0) {\n    discard;\n  }\n\n  float alpha = 1.0;\n\n  // if (intensity >= 0.0) {\n  //  alpha = intensity;\n  // }\n\n\n  alpha = (1.0 - age) * alpha;\n\n  // gl_FragColor = vec4(color, alpha);\n  gl_FragColor = vec4((texture2D(inTexture, gl_PointCoord.st).rgb * color), alpha);\n}\n"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nattribute vec3 aVertexPosition;\n\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform mat4 uMMatrix;\n\nvarying lowp vec4 vColor;\n\nvoid main(void) {\n  gl_Position = uPMatrix * uMVMatrix * uMMatrix * vec4(aVertexPosition, 1.0);\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n \nvoid main(void) {\n  gl_FragColor = vec4(0.4,1.0,1.0,1.0);\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nattribute vec2 inCoord;\n\nvarying vec2 coord;\n\nvoid main(void) {\n  gl_Position = vec4((inCoord * 2.0) - vec2(1.0), 0.0, 1.0);\n  coord = inCoord;\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\nprecision mediump float;\n\nuniform sampler2D inTexture;\nuniform float inWidth;\nuniform float inHeight;\nuniform float inVolume;\n\nvarying vec2 coord;\n\n      \nvoid main(void) {\n  // gl_FragColor = texture2D(inTexture, coord);\n  vec2 center = vec2(0.5, 0.5);\n  vec2 offsetRatio = vec2(1.0 / inWidth, 1.0 / inHeight);\n  float intensity = 20.0 * inVolume;\n  if (inVolume <= 0.0) {\n    intensity = 1.0;\n  }\n\n  vec2 blurVec = (coord - center) * intensity;\n  vec4 pixel = vec4(0.0);\n  for (float i = 0.0; i < 4.0 ; i++){\n    vec2 offset =  blurVec * (i - 4.0) * offsetRatio;\n    float weight = (4.0 - i) / 8.0;\n    pixel += weight * texture2D(inTexture, coord + offset);\n  }\n  gl_FragColor = vec4(pixel.rgb, 1.0);\n}"}])});
//# sourceMappingURL=visual-audio.js.map