!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var a in n)("object"==typeof exports?exports:t)[a]=n[a]}}(this,function(){return function(t){function e(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return t[a].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(4)},,,,function(t,e,n){"use strict";function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function r(t){return t&&t.__esModule?t:{"default":t}}var o=n(5),i=r(o),u=n(6),s=r(u),l=n(16),c=a(l),f=n(17),M=a(f),h=n(18),d=r(h),m=n(19),v=r(m),S=n(23),x=r(S),p=n(25),I=r(p),g=n(37),b=r(g),D=n(38),F=r(D),y=n(40),A=r(y),E=n(41),_=n(42),R=a(_),w=n(43),P=a(w);n(44),window.VISUAL_AUDIO={VERSION:window.VERSION},s["default"].glMatrix.setMatrixArrayType(Float32Array);var T=s["default"].mat4,C=s["default"].vec4;!function(){function t(t){return"boolean"==typeof t&&t||"true"===t.toLowerCase()||"1"===t}function e(t){var e=null;try{e=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(n){console.error(n),alert("Unable to initialize WebGL. Your browser may not support it.")}return window.gl=e,e}function n(){var t=H.canvas.clientWidth,e=H.canvas.clientHeight;rt=H.createFramebuffer(),H.bindFramebuffer(H.FRAMEBUFFER,rt),rt.width=t,rt.height=e,ot=H.createTexture(),H.bindTexture(H.TEXTURE_2D,ot),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_S,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_T,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,H.LINEAR),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,H.LINEAR),H.texImage2D(H.TEXTURE_2D,0,H.RGBA,rt.width,rt.height,0,H.RGBA,H.UNSIGNED_BYTE,null),H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,ot,0),H.bindTexture(H.TEXTURE_2D,null),H.bindFramebuffer(H.FRAMEBUFFER,null),it=H.createBuffer();var n=new Float32Array([-1,1,-1,-1,1,-1,1,1,-1,1,1,-1]);H.bindBuffer(H.ARRAY_BUFFER,it),H.bufferData(H.ARRAY_BUFFER,n,H.STATIC_DRAW)}function a(){Z=H.createTexture(),K=new Image,K.onload=function(){H.bindTexture(H.TEXTURE_2D,Z),H.texImage2D(H.TEXTURE_2D,0,H.RGBA,H.RGBA,H.UNSIGNED_BYTE,K),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,H.LINEAR),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,H.LINEAR),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_S,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_T,H.CLAMP_TO_EDGE),H.bindTexture(H.TEXTURE_2D,null),J=!0},K.src="public/images/star.png"}function r(){a(),n()}function o(){W=[];var t=nt.getFrequencyBinCount(),e=8,n=e/t,a=.2*n,r=nt.getFrequencyData(),o=e/2;if(r&&r.length>0)for(var i=0;i<r.length;i++){var u=r[i]/255,s=u,l=0,c=i*n-o,f=c+(n-a),M=1,h=[c,s,M,c,l,M,f,l,M,f,s,M,c,s,M,f,l,M];W=W.concat(h)}Q=H.createBuffer(),H.bindBuffer(H.ARRAY_BUFFER,Q),H.bufferData(H.ARRAY_BUFFER,new Float32Array(W),H.STATIC_DRAW),H.useProgram(tt);var d=H.getUniformLocation(tt,"uPMatrix");H.uniformMatrix4fv(d,!1,z);var m=H.getUniformLocation(tt,"uMVMatrix");H.uniformMatrix4fv(m,!1,D.getModelViewMatrix());var v=H.getUniformLocation(tt,"uMMatrix"),S=T.create(),x=C.fromValues(0,-4,0,0);T.translate(S,S,x),H.uniformMatrix4fv(v,!1,S),H.bindBuffer(H.ARRAY_BUFFER,Q),H.enableVertexAttribArray(et),H.vertexAttribPointer(et,3,H.FLOAT,!1,0,0),H.drawArrays(H.TRIANGLES,0,W.length/3),H.disableVertexAttribArray(et)}function u(t){var e=arguments.length<=1||void 0===arguments[1]?.5:arguments[1],n=5,a=20;H.useProgram(U);var r=H.getUniformLocation(U,"projectionMatrix");H.uniformMatrix4fv(r,!1,z);var o=H.getUniformLocation(U,"modelViewMatrix");H.uniformMatrix4fv(o,!1,D.getModelViewMatrix());var i=H.getUniformLocation(U,"position");H.uniform3fv(i,[0,0,0]);var u=H.getUniformLocation(U,"uTime");H.uniform1f(u,t.time);var s=H.getUniformLocation(U,"uScale");H.uniform1f(s,n+a*e),H.activeTexture(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,Z),H.uniform1i(H.getUniformLocation(U,"tSprite"),0),H.bindBuffer(H.ARRAY_BUFFER,t.geometryPosStartBuffer),H.enableVertexAttribArray(Y),H.vertexAttribPointer(Y,4,H.FLOAT,!1,0,0),H.bindBuffer(H.ARRAY_BUFFER,t.geometryVelColBuffer),H.enableVertexAttribArray(q),H.vertexAttribPointer(q,4,H.FLOAT,!1,0,0),H.drawArrays(H.POINTS,0,t.PARTICLE_COUNT),H.disableVertexAttribArray(Y),H.disableVertexAttribArray(q)}function s(t,e,n){for(var a=30,r=200,o=0;o<O.length;o++){var i=O[o];i.update(e,t);for(var u=0;a*n>u&&r>u;u++)i.spawnParticle({velocityRandomness:.4,color:E.COLORS[o].toValue(),colorRandomness:0,lifetime:6,sizeRandomness:.5})}}function l(){var t=T.create(),e=N.clientWidth/N.clientHeight,n=50,a=.1,r=1e3;return T.perspective(t,c.degreesToRadians(n),e,a,r),t}function f(){h(),g(),G.begin();var t=1*w.getDelta();V+=t,0>V&&(V=0),t>0&&s(H,V,t),H.bindFramebuffer(H.FRAMEBUFFER,rt),H.clear(H.COLOR_BUFFER_BIT|H.DEPTH_BUFFER_BIT);var e=nt.getNormalizedFrequencyData()||{};if(J)if(nt.isPlaying()&&e.bins)for(var n=0;n<O.length;n++)u(O[n],e.bins[n]);else for(var a=0;a<O.length;a++)u(O[a]);H.bindFramebuffer(H.FRAMEBUFFER,null),H.useProgram(st),H.enableVertexAttribArray(ut),H.activeTexture(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,ot);var r=H.getUniformLocation(st,"inTexture");H.uniform1i(r,0);var i=0;B.blur&&(i=e.average||0),H.uniform1f(H.getUniformLocation(st,"inWidth"),N.clientWidth),H.uniform1f(H.getUniformLocation(st,"inHeight"),N.clientHeight),H.uniform1f(H.getUniformLocation(st,"inVolume"),i),H.bindBuffer(H.ARRAY_BUFFER,it),H.vertexAttribPointer(ut,2,H.FLOAT,!1,0,0),H.drawArrays(H.TRIANGLES,0,6),H.disableVertexAttribArray(ut),nt&&nt.isPlaying()&&B.showBars&&o(),G.end(),requestAnimationFrame(f)}function h(){var t=y.getActiveActions();0!==t.length&&t.forEach(function(t){_[t]&&_[t]()})}function m(){var t=$(document);t.on("keydown",function(t){var e=t.keyCode;y.setKeyActive(e)}),t.on("keyup",function(t){var e=t.keyCode;y.setKeyInactive(e)}),y.registerKeyAction(R.VK_W,P.CAMERA_MOVE_POS_Z),y.registerKeyAction(R.VK_S,P.CAMERA_MOVE_NEG_Z),y.registerKeyAction(R.VK_A,P.CAMERA_MOVE_POS_X),y.registerKeyAction(R.VK_D,P.CAMERA_MOVE_NEG_X),y.registerKeyAction(R.VK_ARROW_LEFT,P.CAMERA_MOVE_NEG_YAW),y.registerKeyAction(R.VK_ARROW_RIGHT,P.CAMERA_MOVE_POS_YAW),y.registerKeyAction(R.VK_ARROW_UP,P.CAMERA_MOVE_POS_PITCH),y.registerKeyAction(R.VK_ARROW_DOWN,P.CAMERA_MOVE_NEG_PITCH),_[P.CAMERA_MOVE_POS_YAW]=function(){return D.updateYaw(1)},_[P.CAMERA_MOVE_NEG_YAW]=function(){return D.updateYaw(-1)},_[P.CAMERA_MOVE_POS_PITCH]=function(){return D.updatePitch(1)},_[P.CAMERA_MOVE_NEG_PITCH]=function(){return D.updatePitch(-1)},_[P.CAMERA_MOVE_POS_X]=function(){return D.updateX(1)},_[P.CAMERA_MOVE_NEG_X]=function(){return D.updateX(-1)},_[P.CAMERA_MOVE_POS_Y]=function(){return D.updateY(1)},_[P.CAMERA_MOVE_NEG_Y]=function(){return D.updateY(-1)},_[P.CAMERA_MOVE_POS_Z]=function(){return D.updateZ(1)},_[P.CAMERA_MOVE_NEG_Z]=function(){return D.updateZ(-1)}}function S(){G=new Stats,G.setMode(0),G.domElement.style.position="absolute",G.domElement.style.right="0px",G.domElement.style.top="0px",document.body.appendChild(G.domElement)}function p(){N=document.getElementById("canvas"),z=l(),S(),m();var t=new I["default"];at.bind(),H=e(N),t.compileShaders(H),r();for(var n=0;n<O.length;n++)O[n].init(H);U=H.createProgram(),H.attachShader(U,t.vertex.gpuParticleShader),H.attachShader(U,t.fragment.gpuParticleShader),H.linkProgram(U),tt=H.createProgram(),H.attachShader(tt,t.vertex.barShader),H.attachShader(tt,t.fragment.barShader),H.linkProgram(tt),st=H.createProgram(),H.attachShader(st,t.vertex.quadShader),H.attachShader(st,t.fragment.quadShader),H.linkProgram(st),H.enable(H.BLEND),H.blendEquation(H.FUNC_ADD),H.blendFunc(H.SRC_ALPHA,H.ONE),H.useProgram(U),Y=H.getAttribLocation(U,"particlePositionsStartTime"),q=H.getAttribLocation(U,"particleVelColSizeLife"),H.useProgram(tt),et=H.getAttribLocation(tt,"aVertexPosition"),H.useProgram(st),ut=H.getAttribLocation(st,"inCoord"),H.viewport(0,0,H.drawingBufferWidth,H.drawingBufferHeight),H.clearColor(0,0,0,1),H.disable(H.DEPTH_TEST),H.clear(H.COLOR_BUFFER_BIT|H.DEPTH_BUFFER_BIT),requestAnimationFrame(f)}function g(){var t=H.canvas.clientWidth,e=H.canvas.clientHeight;(H.canvas.width!=t||H.canvas.height!=e)&&(n(),H.canvas.width=t,H.canvas.height=e,H.viewport(0,0,H.drawingBufferWidth,H.drawingBufferHeight)),z=l()}for(var D=new d["default"],y=new A["default"],_={},w=new b["default"](!0),O=[],L=8,z=null,N=null,k=0;L>k;k++)O[k]=new F["default"];var V=0,U=void 0,Y=void 0,q=void 0,B={maxParticles:5e3,useAcceleration:!0,emissionRate:2,particleLifespan:1e3,velocityMultiplier:2,blur:!1,showBars:!0},j=M.getQueryParams();try{j.max&&parseInt(j.max)&&parseInt(j.max)>0&&(B.maxParticles=parseInt(j.max)),j.rate&&parseInt(j.rate)&&parseInt(j.rate)>0&&(B.emissionRate=parseInt(j.rate)),j.life&&parseInt(j.life)&&parseInt(j.life)>0&&(B.particleLifespan=parseInt(j.life)),j.speed&&parseInt(j.speed)&&parseInt(j.speed)>0&&(B.velocityMultiplier=parseInt(j.speed)),j.accel&&(B.useAcceleration=t(j.accel)),j.bars&&(B.showBars=t(j.bars)),j.blur&&(B.blur=t(j.blur))}catch(X){console.error&&console.error(X)}i["default"](),document.addEventListener("DOMContentLoaded",p);var G=void 0,W=void 0,Q=void 0,H=void 0,K=void 0,Z=void 0,J=!1,tt=void 0,et=void 0,nt=new x["default"],at=new v["default"](nt),rt=void 0,ot=void 0,it=void 0,ut=void 0,st=void 0}()},function(t,e){"use strict";function n(){window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext,window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,window.navigator.getUserMedia=window.navigator.getUserMedia||window.navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia||window.navigator.msGetUserMedia}t.exports=function(){n()}},function(t,e,n){e.glMatrix=n(7),e.mat2=n(8),e.mat2d=n(9),e.mat3=n(10),e.mat4=n(11),e.quat=n(12),e.vec2=n(15),e.vec3=n(13),e.vec4=n(14)},function(t,e){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.ENABLE_SIMD=!1,n.SIMD_AVAILABLE=n.ARRAY_TYPE===Float32Array&&"SIMD"in this,n.USE_SIMD=n.ENABLE_SIMD&&n.SIMD_AVAILABLE,n.setMatrixArrayType=function(t){n.ARRAY_TYPE=t};var a=Math.PI/180;n.toRadian=function(t){return t*a},n.equals=function(t,e){return Math.abs(t-e)<=n.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},t.exports=n},function(t,e,n){var a=n(7),r={};r.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.clone=function(t){var e=new a.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.fromValues=function(t,e,n,r){var o=new a.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o},r.set=function(t,e,n,a,r){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t},r.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},r.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n*o-r*a;return i?(i=1/i,t[0]=o*i,t[1]=-a*i,t[2]=-r*i,t[3]=n*i,t):null},r.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},r.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},r.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=n[0],s=n[1],l=n[2],c=n[3];return t[0]=a*u+o*s,t[1]=r*u+i*s,t[2]=a*l+o*c,t[3]=r*l+i*c,t},r.mul=r.multiply,r.rotate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=a*s+o*u,t[1]=r*s+i*u,t[2]=a*-u+o*s,t[3]=r*-u+i*s,t},r.scale=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=n[0],s=n[1];return t[0]=a*u,t[1]=r*u,t[2]=o*s,t[3]=i*s,t},r.fromRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=-n,t[3]=a,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},r.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},r.LDU=function(t,e,n,a){return t[2]=a[2]/a[0],n[0]=a[0],n[1]=a[1],n[3]=a[3]-t[2]*n[1],[t,e,n]},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},r.sub=r.subtract,r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=e[0],s=e[1],l=e[2],c=e[3];return Math.abs(n-u)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-s)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(o-l)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(i-c)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},r.multiplyScalarAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t},t.exports=r},function(t,e,n){var a=n(7),r={};r.create=function(){var t=new a.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.clone=function(t){var e=new a.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.fromValues=function(t,e,n,r,o,i){var u=new a.ARRAY_TYPE(6);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=o,u[5]=i,u},r.set=function(t,e,n,a,r,o,i){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t[4]=o,t[5]=i,t},r.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],s=n*o-a*r;return s?(s=1/s,t[0]=o*s,t[1]=-a*s,t[2]=-r*s,t[3]=n*s,t[4]=(r*u-o*i)*s,t[5]=(a*i-n*u)*s,t):null},r.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},r.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=n[0],c=n[1],f=n[2],M=n[3],h=n[4],d=n[5];return t[0]=a*l+o*c,t[1]=r*l+i*c,t[2]=a*f+o*M,t[3]=r*f+i*M,t[4]=a*h+o*d+u,t[5]=r*h+i*d+s,t},r.mul=r.multiply,r.rotate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=Math.sin(n),c=Math.cos(n);return t[0]=a*c+o*l,t[1]=r*c+i*l,t[2]=a*-l+o*c,t[3]=r*-l+i*c,t[4]=u,t[5]=s,t},r.scale=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=n[0],c=n[1];return t[0]=a*l,t[1]=r*l,t[2]=o*c,t[3]=i*c,t[4]=u,t[5]=s,t},r.translate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=n[0],c=n[1];return t[0]=a,t[1]=r,t[2]=o,t[3]=i,t[4]=a*l+o*c+u,t[5]=r*l+i*c+s,t},r.fromRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=-n,t[3]=a,t[4]=0,t[5]=0,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},r.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},r.multiplyScalarAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t[4]=e[4]+n[4]*a,t[5]=e[5]+n[5]*a,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=t[4],s=t[5],l=e[0],c=e[1],f=e[2],M=e[3],h=e[4],d=e[5];return Math.abs(n-l)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-c)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(o-f)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(i-M)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(u-h)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(h))&&Math.abs(s-d)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))},t.exports=r},function(t,e,n){var a=n(7),r={};r.create=function(){var t=new a.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},r.clone=function(t){var e=new a.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromValues=function(t,e,n,r,o,i,u,s,l){var c=new a.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=o,c[5]=i,c[6]=u,c[7]=s,c[8]=l,c},r.set=function(t,e,n,a,r,o,i,u,s,l){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t[4]=o,t[5]=i,t[6]=u,t[7]=s,t[8]=l,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.transpose=function(t,e){if(t===e){var n=e[1],a=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=a,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},r.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=c*i-u*l,M=-c*o+u*s,h=l*o-i*s,d=n*f+a*M+r*h;return d?(d=1/d,t[0]=f*d,t[1]=(-c*a+r*l)*d,t[2]=(u*a-r*i)*d,t[3]=M*d,t[4]=(c*n-r*s)*d,t[5]=(-u*n+r*o)*d,t[6]=h*d,t[7]=(-l*n+a*s)*d,t[8]=(i*n-a*o)*d,t):null},r.adjoint=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],s=e[6],l=e[7],c=e[8];return t[0]=i*c-u*l,t[1]=r*l-a*c,t[2]=a*u-r*i,t[3]=u*s-o*c,t[4]=n*c-r*s,t[5]=r*o-n*u,t[6]=o*l-i*s,t[7]=a*s-n*l,t[8]=n*i-a*o,t},r.determinant=function(t){var e=t[0],n=t[1],a=t[2],r=t[3],o=t[4],i=t[5],u=t[6],s=t[7],l=t[8];return e*(l*o-i*s)+n*(-l*r+i*u)+a*(s*r-o*u)},r.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],M=n[0],h=n[1],d=n[2],m=n[3],v=n[4],S=n[5],x=n[6],p=n[7],I=n[8];return t[0]=M*a+h*i+d*l,t[1]=M*r+h*u+d*c,t[2]=M*o+h*s+d*f,t[3]=m*a+v*i+S*l,t[4]=m*r+v*u+S*c,t[5]=m*o+v*s+S*f,t[6]=x*a+p*i+I*l,t[7]=x*r+p*u+I*c,t[8]=x*o+p*s+I*f,t},r.mul=r.multiply,r.translate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],M=n[0],h=n[1];return t[0]=a,t[1]=r,t[2]=o,t[3]=i,t[4]=u,t[5]=s,t[6]=M*a+h*i+l,t[7]=M*r+h*u+c,t[8]=M*o+h*s+f,t},r.rotate=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],M=Math.sin(n),h=Math.cos(n);return t[0]=h*a+M*i,t[1]=h*r+M*u,t[2]=h*o+M*s,t[3]=h*i-M*a,t[4]=h*u-M*r,t[5]=h*s-M*o,t[6]=l,t[7]=c,t[8]=f,t},r.scale=function(t,e,n){var a=n[0],r=n[1];return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},r.fromRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=0,t[3]=-n,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},r.fromQuat=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n+n,u=a+a,s=r+r,l=n*i,c=a*i,f=a*u,M=r*i,h=r*u,d=r*s,m=o*i,v=o*u,S=o*s;return t[0]=1-f-d,t[3]=c-S,t[6]=M+v,t[1]=c+S,t[4]=1-l-d,t[7]=h-m,t[2]=M-v,t[5]=h+m,t[8]=1-l-f,t},r.normalFromMat4=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=e[9],M=e[10],h=e[11],d=e[12],m=e[13],v=e[14],S=e[15],x=n*u-a*i,p=n*s-r*i,I=n*l-o*i,g=a*s-r*u,b=a*l-o*u,D=r*l-o*s,F=c*m-f*d,y=c*v-M*d,A=c*S-h*d,E=f*v-M*m,_=f*S-h*m,R=M*S-h*v,w=x*R-p*_+I*E+g*A-b*y+D*F;return w?(w=1/w,t[0]=(u*R-s*_+l*E)*w,t[1]=(s*A-i*R-l*y)*w,t[2]=(i*_-u*A+l*F)*w,t[3]=(r*_-a*R-o*E)*w,t[4]=(n*R-r*A+o*y)*w,t[5]=(a*A-n*_-o*F)*w,t[6]=(m*D-v*b+S*g)*w,t[7]=(v*I-d*D-S*p)*w,t[8]=(d*b-m*I+S*x)*w,t):null},r.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},r.multiplyScalarAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t[4]=e[4]+n[4]*a,t[5]=e[5]+n[5]*a,t[6]=e[6]+n[6]*a,t[7]=e[7]+n[7]*a,t[8]=e[8]+n[8]*a,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],M=e[0],h=e[1],d=e[2],m=e[3],v=e[4],S=e[5],x=t[6],p=e[7],I=e[8];return Math.abs(n-M)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(r-h)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(o-d)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(i-m)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(u-v)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(s-S)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(l-x)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(c-p)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(p))&&Math.abs(f-I)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(I))},t.exports=r},function(t,e,n){var a=n(7),r={scalar:{},SIMD:{}};r.create=function(){var t=new a.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.clone=function(t){var e=new a.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.fromValues=function(t,e,n,r,o,i,u,s,l,c,f,M,h,d,m,v){var S=new a.ARRAY_TYPE(16);return S[0]=t,S[1]=e,S[2]=n,S[3]=r,S[4]=o,S[5]=i,S[6]=u,S[7]=s,S[8]=l,S[9]=c,S[10]=f,S[11]=M,S[12]=h,S[13]=d,S[14]=m,S[15]=v,S},r.set=function(t,e,n,a,r,o,i,u,s,l,c,f,M,h,d,m,v){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t[4]=o,t[5]=i,t[6]=u,t[7]=s,t[8]=l,t[9]=c,t[10]=f,t[11]=M,t[12]=h,t[13]=d,t[14]=m,t[15]=v,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.scalar.transpose=function(t,e){if(t===e){var n=e[1],a=e[2],r=e[3],o=e[6],i=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=a,t[9]=o,t[11]=e[14],t[12]=r,t[13]=i,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},r.SIMD.transpose=function(t,e){var n,a,r,o,i,u,s,l,c,f;return n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),r=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),i=SIMD.Float32x4.shuffle(n,a,0,1,4,5),u=SIMD.Float32x4.shuffle(r,o,0,1,4,5),s=SIMD.Float32x4.shuffle(i,u,0,2,4,6),l=SIMD.Float32x4.shuffle(i,u,1,3,5,7),SIMD.Float32x4.store(t,0,s),SIMD.Float32x4.store(t,4,l),i=SIMD.Float32x4.shuffle(n,a,2,3,6,7),u=SIMD.Float32x4.shuffle(r,o,2,3,6,7),c=SIMD.Float32x4.shuffle(i,u,0,2,4,6),f=SIMD.Float32x4.shuffle(i,u,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,f),t},r.transpose=a.USE_SIMD?r.SIMD.transpose:r.scalar.transpose,r.scalar.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=e[9],M=e[10],h=e[11],d=e[12],m=e[13],v=e[14],S=e[15],x=n*u-a*i,p=n*s-r*i,I=n*l-o*i,g=a*s-r*u,b=a*l-o*u,D=r*l-o*s,F=c*m-f*d,y=c*v-M*d,A=c*S-h*d,E=f*v-M*m,_=f*S-h*m,R=M*S-h*v,w=x*R-p*_+I*E+g*A-b*y+D*F;return w?(w=1/w,t[0]=(u*R-s*_+l*E)*w,t[1]=(r*_-a*R-o*E)*w,t[2]=(m*D-v*b+S*g)*w,t[3]=(M*b-f*D-h*g)*w,t[4]=(s*A-i*R-l*y)*w,t[5]=(n*R-r*A+o*y)*w,t[6]=(v*I-d*D-S*p)*w,t[7]=(c*D-M*I+h*p)*w,t[8]=(i*_-u*A+l*F)*w,t[9]=(a*A-n*_-o*F)*w,t[10]=(d*b-m*I+S*x)*w,t[11]=(f*I-c*b-h*x)*w,t[12]=(u*y-i*E-s*F)*w,t[13]=(n*E-a*y+r*F)*w,t[14]=(m*p-d*g-v*x)*w,t[15]=(c*g-f*p+M*x)*w,t):null},r.SIMD.invert=function(t,e){var n,a,r,o,i,u,s,l,c,f,M=SIMD.Float32x4.load(e,0),h=SIMD.Float32x4.load(e,4),d=SIMD.Float32x4.load(e,8),m=SIMD.Float32x4.load(e,12);return i=SIMD.Float32x4.shuffle(M,h,0,1,4,5),a=SIMD.Float32x4.shuffle(d,m,0,1,4,5),n=SIMD.Float32x4.shuffle(i,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,i,1,3,5,7),i=SIMD.Float32x4.shuffle(M,h,2,3,6,7),o=SIMD.Float32x4.shuffle(d,m,2,3,6,7),r=SIMD.Float32x4.shuffle(i,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,i,1,3,5,7),i=SIMD.Float32x4.mul(r,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.mul(a,i),s=SIMD.Float32x4.mul(n,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),u),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),i=SIMD.Float32x4.mul(a,r),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),u),c=SIMD.Float32x4.mul(n,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,i)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),i=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,3,0,1),o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),r=SIMD.Float32x4.swizzle(r,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),u),l=SIMD.Float32x4.mul(n,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(r,i)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),i=SIMD.Float32x4.mul(n,a),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),l),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),c),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(r,i)),i=SIMD.Float32x4.mul(n,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(r,i)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),l),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),s),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(a,i)),i=SIMD.Float32x4.mul(n,r),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),s),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(a,i)),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,i)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),c),f=SIMD.Float32x4.mul(n,u),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f),i=SIMD.Float32x4.reciprocalApproximation(f),f=SIMD.Float32x4.sub(SIMD.Float32x4.add(i,i),SIMD.Float32x4.mul(f,SIMD.Float32x4.mul(i,i))),(f=SIMD.Float32x4.swizzle(f,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(f,u)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(f,s)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(f,l)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(f,c)),t):null},r.invert=a.USE_SIMD?r.SIMD.invert:r.scalar.invert,r.scalar.adjoint=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=e[9],M=e[10],h=e[11],d=e[12],m=e[13],v=e[14],S=e[15];return t[0]=u*(M*S-h*v)-f*(s*S-l*v)+m*(s*h-l*M),t[1]=-(a*(M*S-h*v)-f*(r*S-o*v)+m*(r*h-o*M)),t[2]=a*(s*S-l*v)-u*(r*S-o*v)+m*(r*l-o*s),t[3]=-(a*(s*h-l*M)-u*(r*h-o*M)+f*(r*l-o*s)),t[4]=-(i*(M*S-h*v)-c*(s*S-l*v)+d*(s*h-l*M)),t[5]=n*(M*S-h*v)-c*(r*S-o*v)+d*(r*h-o*M),t[6]=-(n*(s*S-l*v)-i*(r*S-o*v)+d*(r*l-o*s)),t[7]=n*(s*h-l*M)-i*(r*h-o*M)+c*(r*l-o*s),t[8]=i*(f*S-h*m)-c*(u*S-l*m)+d*(u*h-l*f),t[9]=-(n*(f*S-h*m)-c*(a*S-o*m)+d*(a*h-o*f)),t[10]=n*(u*S-l*m)-i*(a*S-o*m)+d*(a*l-o*u),t[11]=-(n*(u*h-l*f)-i*(a*h-o*f)+c*(a*l-o*u)),t[12]=-(i*(f*v-M*m)-c*(u*v-s*m)+d*(u*M-s*f)),t[13]=n*(f*v-M*m)-c*(a*v-r*m)+d*(a*M-r*f),t[14]=-(n*(u*v-s*m)-i*(a*v-r*m)+d*(a*s-r*u)),t[15]=n*(u*M-s*f)-i*(a*M-r*f)+c*(a*s-r*u),t},r.SIMD.adjoint=function(t,e){var n,a,r,o,i,u,s,l,c,f,M,h,d,n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),r=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12);return c=SIMD.Float32x4.shuffle(n,a,0,1,4,5),u=SIMD.Float32x4.shuffle(r,o,0,1,4,5),i=SIMD.Float32x4.shuffle(c,u,0,2,4,6),u=SIMD.Float32x4.shuffle(u,c,1,3,5,7),c=SIMD.Float32x4.shuffle(n,a,2,3,6,7),l=SIMD.Float32x4.shuffle(r,o,2,3,6,7),s=SIMD.Float32x4.shuffle(c,l,0,2,4,6),l=SIMD.Float32x4.shuffle(l,c,1,3,5,7),c=SIMD.Float32x4.mul(s,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.mul(u,c),M=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),f),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),c=SIMD.Float32x4.mul(u,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),f),d=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,3,0,1),l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),s=SIMD.Float32x4.swizzle(s,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),f),h=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(s,c)),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.mul(i,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),h),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.mul(i,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(s,c)),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),h),c=SIMD.Float32x4.swizzle(c,2,3,0,1),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),M),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(i,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),M),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(l,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),d),SIMD.Float32x4.store(t,0,f),SIMD.Float32x4.store(t,4,M),SIMD.Float32x4.store(t,8,h),SIMD.Float32x4.store(t,12,d),t},r.adjoint=a.USE_SIMD?r.SIMD.adjoint:r.scalar.adjoint,r.determinant=function(t){var e=t[0],n=t[1],a=t[2],r=t[3],o=t[4],i=t[5],u=t[6],s=t[7],l=t[8],c=t[9],f=t[10],M=t[11],h=t[12],d=t[13],m=t[14],v=t[15],S=e*i-n*o,x=e*u-a*o,p=e*s-r*o,I=n*u-a*i,g=n*s-r*i,b=a*s-r*u,D=l*d-c*h,F=l*m-f*h,y=l*v-M*h,A=c*m-f*d,E=c*v-M*d,_=f*v-M*m;return S*_-x*E+p*A+I*y-g*F+b*D},r.SIMD.multiply=function(t,e,n){var a=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4.load(n,0),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),i))));
SIMD.Float32x4.store(t,0,s);var l=SIMD.Float32x4.load(n,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),i))));SIMD.Float32x4.store(t,4,c);var f=SIMD.Float32x4.load(n,8),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),i))));SIMD.Float32x4.store(t,8,M);var h=SIMD.Float32x4.load(n,12),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),i))));return SIMD.Float32x4.store(t,12,d),t},r.scalar.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],M=e[9],h=e[10],d=e[11],m=e[12],v=e[13],S=e[14],x=e[15],p=n[0],I=n[1],g=n[2],b=n[3];return t[0]=p*a+I*u+g*f+b*m,t[1]=p*r+I*s+g*M+b*v,t[2]=p*o+I*l+g*h+b*S,t[3]=p*i+I*c+g*d+b*x,p=n[4],I=n[5],g=n[6],b=n[7],t[4]=p*a+I*u+g*f+b*m,t[5]=p*r+I*s+g*M+b*v,t[6]=p*o+I*l+g*h+b*S,t[7]=p*i+I*c+g*d+b*x,p=n[8],I=n[9],g=n[10],b=n[11],t[8]=p*a+I*u+g*f+b*m,t[9]=p*r+I*s+g*M+b*v,t[10]=p*o+I*l+g*h+b*S,t[11]=p*i+I*c+g*d+b*x,p=n[12],I=n[13],g=n[14],b=n[15],t[12]=p*a+I*u+g*f+b*m,t[13]=p*r+I*s+g*M+b*v,t[14]=p*o+I*l+g*h+b*S,t[15]=p*i+I*c+g*d+b*x,t},r.multiply=a.USE_SIMD?r.SIMD.multiply:r.scalar.multiply,r.mul=r.multiply,r.scalar.translate=function(t,e,n){var a,r,o,i,u,s,l,c,f,M,h,d,m=n[0],v=n[1],S=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*S+e[12],t[13]=e[1]*m+e[5]*v+e[9]*S+e[13],t[14]=e[2]*m+e[6]*v+e[10]*S+e[14],t[15]=e[3]*m+e[7]*v+e[11]*S+e[15]):(a=e[0],r=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],M=e[9],h=e[10],d=e[11],t[0]=a,t[1]=r,t[2]=o,t[3]=i,t[4]=u,t[5]=s,t[6]=l,t[7]=c,t[8]=f,t[9]=M,t[10]=h,t[11]=d,t[12]=a*m+u*v+f*S+e[12],t[13]=r*m+s*v+M*S+e[13],t[14]=o*m+l*v+h*S+e[14],t[15]=i*m+c*v+d*S+e[15]),t},r.SIMD.translate=function(t,e,n){var a=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4(n[0],n[1],n[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(u,0,0,0,0)),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(u,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(u,2,2,2,2));var s=SIMD.Float32x4.add(a,SIMD.Float32x4.add(r,SIMD.Float32x4.add(o,i)));return SIMD.Float32x4.store(t,12,s),t},r.translate=a.USE_SIMD?r.SIMD.translate:r.scalar.translate,r.scalar.scale=function(t,e,n){var a=n[0],r=n[1],o=n[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.SIMD.scale=function(t,e,n){var a,r,o,i=SIMD.Float32x4(n[0],n[1],n[2],0);return a=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(i,0,0,0,0))),r=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(i,1,1,1,1))),o=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(i,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.scale=a.USE_SIMD?r.SIMD.scale:r.scalar.scale,r.rotate=function(t,e,n,r){var o,i,u,s,l,c,f,M,h,d,m,v,S,x,p,I,g,b,D,F,y,A,E,_,R=r[0],w=r[1],P=r[2],T=Math.sqrt(R*R+w*w+P*P);return Math.abs(T)<a.EPSILON?null:(T=1/T,R*=T,w*=T,P*=T,o=Math.sin(n),i=Math.cos(n),u=1-i,s=e[0],l=e[1],c=e[2],f=e[3],M=e[4],h=e[5],d=e[6],m=e[7],v=e[8],S=e[9],x=e[10],p=e[11],I=R*R*u+i,g=w*R*u+P*o,b=P*R*u-w*o,D=R*w*u-P*o,F=w*w*u+i,y=P*w*u+R*o,A=R*P*u+w*o,E=w*P*u-R*o,_=P*P*u+i,t[0]=s*I+M*g+v*b,t[1]=l*I+h*g+S*b,t[2]=c*I+d*g+x*b,t[3]=f*I+m*g+p*b,t[4]=s*D+M*F+v*y,t[5]=l*D+h*F+S*y,t[6]=c*D+d*F+x*y,t[7]=f*D+m*F+p*y,t[8]=s*A+M*E+v*_,t[9]=l*A+h*E+S*_,t[10]=c*A+d*E+x*_,t[11]=f*A+m*E+p*_,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},r.scalar.rotateX=function(t,e,n){var a=Math.sin(n),r=Math.cos(n),o=e[4],i=e[5],u=e[6],s=e[7],l=e[8],c=e[9],f=e[10],M=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+l*a,t[5]=i*r+c*a,t[6]=u*r+f*a,t[7]=s*r+M*a,t[8]=l*r-o*a,t[9]=c*r-i*a,t[10]=f*r-u*a,t[11]=M*r-s*a,t},r.SIMD.rotateX=function(t,e,n){var a=SIMD.Float32x4.splat(Math.sin(n)),r=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,a))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,r),SIMD.Float32x4.mul(o,a))),t},r.rotateX=a.USE_SIMD?r.SIMD.rotateX:r.scalar.rotateX,r.scalar.rotateY=function(t,e,n){var a=Math.sin(n),r=Math.cos(n),o=e[0],i=e[1],u=e[2],s=e[3],l=e[8],c=e[9],f=e[10],M=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-l*a,t[1]=i*r-c*a,t[2]=u*r-f*a,t[3]=s*r-M*a,t[8]=o*a+l*r,t[9]=i*a+c*r,t[10]=u*a+f*r,t[11]=s*a+M*r,t},r.SIMD.rotateY=function(t,e,n){var a=SIMD.Float32x4.splat(Math.sin(n)),r=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,a))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,r))),t},r.rotateY=a.USE_SIMD?r.SIMD.rotateY:r.scalar.rotateY,r.scalar.rotateZ=function(t,e,n){var a=Math.sin(n),r=Math.cos(n),o=e[0],i=e[1],u=e[2],s=e[3],l=e[4],c=e[5],f=e[6],M=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+l*a,t[1]=i*r+c*a,t[2]=u*r+f*a,t[3]=s*r+M*a,t[4]=l*r-o*a,t[5]=c*r-i*a,t[6]=f*r-u*a,t[7]=M*r-s*a,t},r.SIMD.rotateZ=function(t,e,n){var a=SIMD.Float32x4.splat(Math.sin(n)),r=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,a))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,r),SIMD.Float32x4.mul(o,a))),t},r.rotateZ=a.USE_SIMD?r.SIMD.rotateZ:r.scalar.rotateZ,r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotation=function(t,e,n){var r,o,i,u=n[0],s=n[1],l=n[2],c=Math.sqrt(u*u+s*s+l*l);return Math.abs(c)<a.EPSILON?null:(c=1/c,u*=c,s*=c,l*=c,r=Math.sin(e),o=Math.cos(e),i=1-o,t[0]=u*u*i+o,t[1]=s*u*i+l*r,t[2]=l*u*i-s*r,t[3]=0,t[4]=u*s*i-l*r,t[5]=s*s*i+o,t[6]=l*s*i+u*r,t[7]=0,t[8]=u*l*i+s*r,t[9]=s*l*i-u*r,t[10]=l*l*i+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},r.fromXRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromYRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromZRotation=function(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotationTranslation=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=a+a,s=r+r,l=o+o,c=a*u,f=a*s,M=a*l,h=r*s,d=r*l,m=o*l,v=i*u,S=i*s,x=i*l;return t[0]=1-(h+m),t[1]=f+x,t[2]=M-S,t[3]=0,t[4]=f-x,t[5]=1-(c+m),t[6]=d+v,t[7]=0,t[8]=M+S,t[9]=d-v,t[10]=1-(c+h),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},r.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},r.getRotation=function(t,e){var n=e[0]+e[5]+e[10],a=0;return n>0?(a=2*Math.sqrt(n+1),t[3]=.25*a,t[0]=(e[6]-e[9])/a,t[1]=(e[8]-e[2])/a,t[2]=(e[1]-e[4])/a):e[0]>e[5]&e[0]>e[10]?(a=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/a,t[0]=.25*a,t[1]=(e[1]+e[4])/a,t[2]=(e[8]+e[2])/a):e[5]>e[10]?(a=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/a,t[0]=(e[1]+e[4])/a,t[1]=.25*a,t[2]=(e[6]+e[9])/a):(a=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/a,t[0]=(e[8]+e[2])/a,t[1]=(e[6]+e[9])/a,t[2]=.25*a),t},r.fromRotationTranslationScale=function(t,e,n,a){var r=e[0],o=e[1],i=e[2],u=e[3],s=r+r,l=o+o,c=i+i,f=r*s,M=r*l,h=r*c,d=o*l,m=o*c,v=i*c,S=u*s,x=u*l,p=u*c,I=a[0],g=a[1],b=a[2];return t[0]=(1-(d+v))*I,t[1]=(M+p)*I,t[2]=(h-x)*I,t[3]=0,t[4]=(M-p)*g,t[5]=(1-(f+v))*g,t[6]=(m+S)*g,t[7]=0,t[8]=(h+x)*b,t[9]=(m-S)*b,t[10]=(1-(f+d))*b,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},r.fromRotationTranslationScaleOrigin=function(t,e,n,a,r){var o=e[0],i=e[1],u=e[2],s=e[3],l=o+o,c=i+i,f=u+u,M=o*l,h=o*c,d=o*f,m=i*c,v=i*f,S=u*f,x=s*l,p=s*c,I=s*f,g=a[0],b=a[1],D=a[2],F=r[0],y=r[1],A=r[2];return t[0]=(1-(m+S))*g,t[1]=(h+I)*g,t[2]=(d-p)*g,t[3]=0,t[4]=(h-I)*b,t[5]=(1-(M+S))*b,t[6]=(v+x)*b,t[7]=0,t[8]=(d+p)*D,t[9]=(v-x)*D,t[10]=(1-(M+m))*D,t[11]=0,t[12]=n[0]+F-(t[0]*F+t[4]*y+t[8]*A),t[13]=n[1]+y-(t[1]*F+t[5]*y+t[9]*A),t[14]=n[2]+A-(t[2]*F+t[6]*y+t[10]*A),t[15]=1,t},r.fromQuat=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n+n,u=a+a,s=r+r,l=n*i,c=a*i,f=a*u,M=r*i,h=r*u,d=r*s,m=o*i,v=o*u,S=o*s;return t[0]=1-f-d,t[1]=c+S,t[2]=M-v,t[3]=0,t[4]=c-S,t[5]=1-l-d,t[6]=h+m,t[7]=0,t[8]=M+v,t[9]=h-m,t[10]=1-l-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.frustum=function(t,e,n,a,r,o,i){var u=1/(n-e),s=1/(r-a),l=1/(o-i);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(r+a)*s,t[10]=(i+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*l,t[15]=0,t},r.perspective=function(t,e,n,a,r){var o=1/Math.tan(e/2),i=1/(a-r);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+a)*i,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*a*i,t[15]=0,t},r.perspectiveFromFieldOfView=function(t,e,n,a){var r=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(i+u),l=2/(r+o);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-((i-u)*s*.5),t[9]=(r-o)*l*.5,t[10]=a/(n-a),t[11]=-1,t[12]=0,t[13]=0,t[14]=a*n/(n-a),t[15]=0,t},r.ortho=function(t,e,n,a,r,o,i){var u=1/(e-n),s=1/(a-r),l=1/(o-i);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*u,t[13]=(r+a)*s,t[14]=(i+o)*l,t[15]=1,t},r.lookAt=function(t,e,n,o){var i,u,s,l,c,f,M,h,d,m,v=e[0],S=e[1],x=e[2],p=o[0],I=o[1],g=o[2],b=n[0],D=n[1],F=n[2];return Math.abs(v-b)<a.EPSILON&&Math.abs(S-D)<a.EPSILON&&Math.abs(x-F)<a.EPSILON?r.identity(t):(M=v-b,h=S-D,d=x-F,m=1/Math.sqrt(M*M+h*h+d*d),M*=m,h*=m,d*=m,i=I*d-g*h,u=g*M-p*d,s=p*h-I*M,m=Math.sqrt(i*i+u*u+s*s),m?(m=1/m,i*=m,u*=m,s*=m):(i=0,u=0,s=0),l=h*s-d*u,c=d*i-M*s,f=M*u-h*i,m=Math.sqrt(l*l+c*c+f*f),m?(m=1/m,l*=m,c*=m,f*=m):(l=0,c=0,f=0),t[0]=i,t[1]=l,t[2]=M,t[3]=0,t[4]=u,t[5]=c,t[6]=h,t[7]=0,t[8]=s,t[9]=f,t[10]=d,t[11]=0,t[12]=-(i*v+u*S+s*x),t[13]=-(l*v+c*S+f*x),t[14]=-(M*v+h*S+d*x),t[15]=1,t)},r.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t},r.sub=r.subtract,r.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},r.multiplyScalarAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t[4]=e[4]+n[4]*a,t[5]=e[5]+n[5]*a,t[6]=e[6]+n[6]*a,t[7]=e[7]+n[7]*a,t[8]=e[8]+n[8]*a,t[9]=e[9]+n[9]*a,t[10]=e[10]+n[10]*a,t[11]=e[11]+n[11]*a,t[12]=e[12]+n[12]*a,t[13]=e[13]+n[13]*a,t[14]=e[14]+n[14]*a,t[15]=e[15]+n[15]*a,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],M=t[9],h=t[10],d=t[11],m=t[12],v=t[13],S=t[14],x=t[15],p=e[0],I=e[1],g=e[2],b=e[3],D=e[4],F=e[5],y=e[6],A=e[7],E=e[8],_=e[9],R=e[10],w=e[11],P=e[12],T=e[13],C=e[14],O=e[15];return Math.abs(n-p)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(r-I)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(I))&&Math.abs(o-g)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(i-b)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(u-D)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(s-F)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(F))&&Math.abs(l-y)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(c-A)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(f-E)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(M-_)<=a.EPSILON*Math.max(1,Math.abs(M),Math.abs(_))&&Math.abs(h-R)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(d-w)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(w))&&Math.abs(m-P)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(v-T)<=a.EPSILON*Math.max(1,Math.abs(v),Math.abs(T))&&Math.abs(S-C)<=a.EPSILON*Math.max(1,Math.abs(S),Math.abs(C))&&Math.abs(x-O)<=a.EPSILON*Math.max(1,Math.abs(x),Math.abs(O))},t.exports=r},function(t,e,n){var a=n(7),r=n(10),o=n(13),i=n(14),u={};u.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),n=o.fromValues(0,1,0);return function(a,r,i){var s=o.dot(r,i);return-.999999>s?(o.cross(t,e,r),o.length(t)<1e-6&&o.cross(t,n,r),o.normalize(t,t),u.setAxisAngle(a,t,Math.PI),a):s>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(o.cross(t,r,i),a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=1+s,u.normalize(a,a))}}(),u.setAxes=function(){var t=r.create();return function(e,n,a,r){return t[0]=a[0],t[3]=a[1],t[6]=a[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],u.normalize(e,u.fromMat3(e,t))}}(),u.clone=i.clone,u.fromValues=i.fromValues,u.copy=i.copy,u.set=i.set,u.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.setAxisAngle=function(t,e,n){n=.5*n;var a=Math.sin(n);return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=Math.cos(n),t},u.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),a=Math.sin(n/2);return 0!=a?(t[0]=e[0]/a,t[1]=e[1]/a,t[2]=e[2]/a):(t[0]=1,t[1]=0,t[2]=0),n},u.add=i.add,u.multiply=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3],u=n[0],s=n[1],l=n[2],c=n[3];return t[0]=a*c+i*u+r*l-o*s,t[1]=r*c+i*s+o*u-a*l,t[2]=o*c+i*l+a*s-r*u,t[3]=i*c-a*u-r*s-o*l,t},u.mul=u.multiply,u.scale=i.scale,u.rotateX=function(t,e,n){n*=.5;var a=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=a*s+i*u,t[1]=r*s+o*u,t[2]=o*s-r*u,t[3]=i*s-a*u,t},u.rotateY=function(t,e,n){n*=.5;var a=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=a*s-o*u,t[1]=r*s+i*u,t[2]=o*s+a*u,t[3]=i*s-r*u,t},u.rotateZ=function(t,e,n){n*=.5;var a=e[0],r=e[1],o=e[2],i=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=a*s+r*u,t[1]=r*s-a*u,t[2]=o*s+i*u,t[3]=i*s-o*u,t},u.calculateW=function(t,e){var n=e[0],a=e[1],r=e[2];return t[0]=n,t[1]=a,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-a*a-r*r)),t},u.dot=i.dot,u.lerp=i.lerp,u.slerp=function(t,e,n,a){var r,o,i,u,s,l=e[0],c=e[1],f=e[2],M=e[3],h=n[0],d=n[1],m=n[2],v=n[3];return o=l*h+c*d+f*m+M*v,0>o&&(o=-o,h=-h,d=-d,m=-m,v=-v),1-o>1e-6?(r=Math.acos(o),i=Math.sin(r),u=Math.sin((1-a)*r)/i,s=Math.sin(a*r)/i):(u=1-a,s=a),t[0]=u*l+s*h,t[1]=u*c+s*d,t[2]=u*f+s*m,t[3]=u*M+s*v,t},u.sqlerp=function(){var t=u.create(),e=u.create();return function(n,a,r,o,i,s){return u.slerp(t,a,i,s),u.slerp(e,r,o,s),u.slerp(n,t,e,2*s*(1-s)),n}}(),u.invert=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n*n+a*a+r*r+o*o,u=i?1/i:0;return t[0]=-n*u,t[1]=-a*u,t[2]=-r*u,t[3]=o*u,t},u.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},u.length=i.length,u.len=u.length,u.squaredLength=i.squaredLength,u.sqrLen=u.squaredLength,u.normalize=i.normalize,u.fromMat3=function(t,e){var n,a=e[0]+e[4]+e[8];if(a>0)n=Math.sqrt(a+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,i=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*i+i]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*o+i]-e[3*i+o])*n,t[o]=(e[3*o+r]+e[3*r+o])*n,t[i]=(e[3*i+r]+e[3*r+i])*n}return t},u.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},u.exactEquals=i.exactEquals,u.equals=i.equals,t.exports=u},function(t,e,n){var a=n(7),r={};r.create=function(){var t=new a.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},r.clone=function(t){var e=new a.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},r.fromValues=function(t,e,n){var r=new a.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=n,r},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},r.set=function(t,e,n,a){return t[0]=e,t[1]=n,t[2]=a,t},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},r.sub=r.subtract,r.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},r.mul=r.multiply,r.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},r.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},r.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},r.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},r.scaleAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t},r.distance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(n*n+a*a+r*r)},r.dist=r.distance,r.squaredDistance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2];return n*n+a*a+r*r},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],n=t[1],a=t[2];return Math.sqrt(e*e+n*n+a*a)},r.len=r.length,r.squaredLength=function(t){var e=t[0],n=t[1],a=t[2];return e*e+n*n+a*a},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},r.normalize=function(t,e){var n=e[0],a=e[1],r=e[2],o=n*n+a*a+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},r.cross=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=n[0],u=n[1],s=n[2];return t[0]=r*s-o*u,t[1]=o*i-a*s,t[2]=a*u-r*i,t},r.lerp=function(t,e,n,a){var r=e[0],o=e[1],i=e[2];return t[0]=r+a*(n[0]-r),t[1]=o+a*(n[1]-o),t[2]=i+a*(n[2]-i),t},r.hermite=function(t,e,n,a,r,o){var i=o*o,u=i*(2*o-3)+1,s=i*(o-2)+o,l=i*(o-1),c=i*(3-2*o);return t[0]=e[0]*u+n[0]*s+a[0]*l+r[0]*c,t[1]=e[1]*u+n[1]*s+a[1]*l+r[1]*c,t[2]=e[2]*u+n[2]*s+a[2]*l+r[2]*c,t},r.bezier=function(t,e,n,a,r,o){var i=1-o,u=i*i,s=o*o,l=u*i,c=3*o*u,f=3*s*i,M=s*o;return t[0]=e[0]*l+n[0]*c+a[0]*f+r[0]*M,t[1]=e[1]*l+n[1]*c+a[1]*f+r[1]*M,t[2]=e[2]*l+n[2]*c+a[2]*f+r[2]*M,t},r.random=function(t,e){e=e||1;var n=2*a.RANDOM()*Math.PI,r=2*a.RANDOM()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=r*e,t},r.transformMat4=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=n[3]*a+n[7]*r+n[11]*o+n[15];return i=i||1,t[0]=(n[0]*a+n[4]*r+n[8]*o+n[12])/i,t[1]=(n[1]*a+n[5]*r+n[9]*o+n[13])/i,t[2]=(n[2]*a+n[6]*r+n[10]*o+n[14])/i,t},r.transformMat3=function(t,e,n){var a=e[0],r=e[1],o=e[2];return t[0]=a*n[0]+r*n[3]+o*n[6],t[1]=a*n[1]+r*n[4]+o*n[7],t[2]=a*n[2]+r*n[5]+o*n[8],t},r.transformQuat=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=n[0],u=n[1],s=n[2],l=n[3],c=l*a+u*o-s*r,f=l*r+s*a-i*o,M=l*o+i*r-u*a,h=-i*a-u*r-s*o;return t[0]=c*l+h*-i+f*-s-M*-u,t[1]=f*l+h*-u+M*-i-c*-s,t[2]=M*l+h*-s+c*-u-f*-i,t},r.rotateX=function(t,e,n,a){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(a)-r[2]*Math.sin(a),o[2]=r[1]*Math.sin(a)+r[2]*Math.cos(a),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},r.rotateY=function(t,e,n,a){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(a)+r[0]*Math.cos(a),o[1]=r[1],o[2]=r[2]*Math.cos(a)-r[0]*Math.sin(a),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},r.rotateZ=function(t,e,n,a){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(a)-r[1]*Math.sin(a),o[1]=r[0]*Math.sin(a)+r[1]*Math.cos(a),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},r.forEach=function(){var t=r.create();return function(e,n,a,r,o,i){var u,s;for(n||(n=3),a||(a=0),s=r?Math.min(r*n+a,e.length):e.length,u=a;s>u;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}(),r.angle=function(t,e){var n=r.fromValues(t[0],t[1],t[2]),a=r.fromValues(e[0],e[1],e[2]);r.normalize(n,n),r.normalize(a,a);var o=r.dot(n,a);return o>1?0:Math.acos(o)},r.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=e[0],u=e[1],s=e[2];return Math.abs(n-i)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-u)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-s)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))},t.exports=r},function(t,e,n){var a=n(7),r={};r.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},r.clone=function(t){var e=new a.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.fromValues=function(t,e,n,r){var o=new a.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.set=function(t,e,n,a,r){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},r.sub=r.subtract,r.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},r.mul=r.multiply,r.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},r.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},r.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},r.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},r.scaleAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t},r.distance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+a*a+r*r+o*o)},r.dist=r.distance,r.squaredDistance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return n*n+a*a+r*r+o*o},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],n=t[1],a=t[2],r=t[3];return Math.sqrt(e*e+n*n+a*a+r*r)},r.len=r.length,r.squaredLength=function(t){var e=t[0],n=t[1],a=t[2],r=t[3];return e*e+n*n+a*a+r*r},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},r.normalize=function(t,e){var n=e[0],a=e[1],r=e[2],o=e[3],i=n*n+a*a+r*r+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=n*i,t[1]=a*i,t[2]=r*i,t[3]=o*i),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},r.lerp=function(t,e,n,a){var r=e[0],o=e[1],i=e[2],u=e[3];return t[0]=r+a*(n[0]-r),t[1]=o+a*(n[1]-o),t[2]=i+a*(n[2]-i),t[3]=u+a*(n[3]-u),t},r.random=function(t,e){return e=e||1,t[0]=a.RANDOM(),t[1]=a.RANDOM(),t[2]=a.RANDOM(),t[3]=a.RANDOM(),r.normalize(t,t),r.scale(t,t,e),t},r.transformMat4=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=e[3];return t[0]=n[0]*a+n[4]*r+n[8]*o+n[12]*i,t[1]=n[1]*a+n[5]*r+n[9]*o+n[13]*i,t[2]=n[2]*a+n[6]*r+n[10]*o+n[14]*i,t[3]=n[3]*a+n[7]*r+n[11]*o+n[15]*i,t},r.transformQuat=function(t,e,n){var a=e[0],r=e[1],o=e[2],i=n[0],u=n[1],s=n[2],l=n[3],c=l*a+u*o-s*r,f=l*r+s*a-i*o,M=l*o+i*r-u*a,h=-i*a-u*r-s*o;return t[0]=c*l+h*-i+f*-s-M*-u,t[1]=f*l+h*-u+M*-i-c*-s,t[2]=M*l+h*-s+c*-u-f*-i,t[3]=e[3],t},r.forEach=function(){var t=r.create();return function(e,n,a,r,o,i){var u,s;for(n||(n=4),a||(a=0),s=r?Math.min(r*n+a,e.length):e.length,u=a;s>u;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}(),r.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],u=e[0],s=e[1],l=e[2],c=e[3];return Math.abs(n-u)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-s)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(o-l)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(i-c)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},t.exports=r},function(t,e,n){var a=n(7),r={};r.create=function(){var t=new a.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},r.clone=function(t){var e=new a.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},r.fromValues=function(t,e){var n=new a.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},r.set=function(t,e,n){return t[0]=e,t[1]=n,t},r.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},r.sub=r.subtract,r.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},r.mul=r.multiply,r.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},r.div=r.divide,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},r.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},r.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},r.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},r.scaleAndAdd=function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t},r.distance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1];return Math.sqrt(n*n+a*a)},r.dist=r.distance,r.squaredDistance=function(t,e){var n=e[0]-t[0],a=e[1]-t[1];return n*n+a*a},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},r.len=r.length,r.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},r.normalize=function(t,e){var n=e[0],a=e[1],r=n*n+a*a;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},r.cross=function(t,e,n){var a=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=a,t},r.lerp=function(t,e,n,a){var r=e[0],o=e[1];return t[0]=r+a*(n[0]-r),t[1]=o+a*(n[1]-o),t},r.random=function(t,e){e=e||1;var n=2*a.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},r.transformMat2=function(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[2]*r,t[1]=n[1]*a+n[3]*r,t},r.transformMat2d=function(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[2]*r+n[4],t[1]=n[1]*a+n[3]*r+n[5],t},r.transformMat3=function(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[3]*r+n[6],t[1]=n[1]*a+n[4]*r+n[7],t},r.transformMat4=function(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[4]*r+n[12],t[1]=n[1]*a+n[5]*r+n[13],t},r.forEach=function(){var t=r.create();return function(e,n,a,r,o,i){var u,s;for(n||(n=2),a||(a=0),s=r?Math.min(r*n+a,e.length):e.length,u=a;s>u;u+=n)t[0]=e[u],t[1]=e[u+1],o(t,t,i),e[u]=t[0],e[u+1]=t[1];return e}}(),r.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},r.equals=function(t,e){var n=t[0],r=t[1],o=e[0],i=e[1];return Math.abs(n-o)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-i)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))},t.exports=r},function(t,e){"use strict";function n(t){return t*(Math.PI/180)}function a(t){return t*(180/Math.PI)}function r(t,e){return Math.floor(Math.random()*(e-t+1))+t}function o(t,e){return Math.random()*(e-t)+t}function i(t,e,n,a){return M[0]=Math.floor(a),M[1]=Math.floor(n),M[2]=Math.floor(e),M[3]=Math.floor(t),h[0]}function u(t){var e=t.toString(16);return 1==e.length?"0"+e:e}function s(t,e,n){return"#"+u(t)+u(e)+u(n)}function l(t,e,n){return(t<<16)+(e<<8)+n}function c(t){var e=t>>16,n=(65280&t)>>8,a=255&t;return e>0&&e--,n>0&&n--,a>0&&a--,[e,n,a]}function f(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?0:arguments[2];return e===n?1:(t-e)/(n-e)}Object.defineProperty(e,"__esModule",{value:!0}),e.degreesToRadians=n,e.radiansToDegrees=a,e.getRandomInt=r,e.getRandom=o,e.decodeFloat=i,e.componentToHex=u,e.rgbToHex=s,e.rgbToValue=l,e.hexToRgb=c,e.normalize=f;var M=new Uint8Array(4),h=new Float32Array(M.buffer)},function(t,e){"use strict";function n(){var t=window.location.search.substring(1)||"";if(""===t)return{};for(var e={},n=t.split("&"),a=0;a<n.length;a++){var r=n[a].split("=",2);1==r.length?e[r[0]]="":e[r[0]]=decodeURIComponent(r[1].replace(/\+/g," "))}return e}Object.defineProperty(e,"__esModule",{value:!0}),e.getQueryParams=n},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];
a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(6),i=o.mat4,u=.05,s=.05,l=[.5,.5,.5],c=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?-10:arguments[2];a(this,t),this.position=[e,n,r],this.pitch=0,this.yaw=0}return r(t,[{key:"moveTo",value:function(t,e,n){this.position=[t,e,n]}},{key:"getModelViewMatrix",value:function(){var t=i.create();return i.rotateX(t,t,-this.pitch),i.rotateY(t,t,this.yaw),i.translate(t,t,this.position),t}},{key:"updatePitch",value:function(){var t=arguments.length<=0||void 0===arguments[0]?1:arguments[0];this.pitch+=u*t}},{key:"updateYaw",value:function(){var t=arguments.length<=0||void 0===arguments[0]?1:arguments[0];this.yaw+=s*t}},{key:"updateX",value:function(){var t=arguments.length<=0||void 0===arguments[0]?1:arguments[0];this.position[0]=this.position[0]+l[0]*t}},{key:"updateY",value:function(){var t=arguments.length<=0||void 0===arguments[0]?1:arguments[0];this.position[1]=this.position[1]+l[1]*t}},{key:"updateZ",value:function(){var t=arguments.length<=0||void 0===arguments[0]?1:arguments[0];this.position[2]=this.position[2]+l[2]*t}}]),t}();e["default"]=c},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n(20),u=a(i),s=n(22),l=a(s),c=n(23),f=n(21),M="#media-player",h="#audio-chooser",d="#file-chooser",m="#voice-chooser",v=".media-btn",S=function(){function t(e){r(this,t),this.audioManager=e}return o(t,[{key:"bind",value:function(){var t=this;this.audioManager.registerStateListener(this.onAudioStateChange.bind(this)),this.audioManager.registerQueueListener(this.onQueueChanged.bind(this));var e=$(d),n=$(m),a=$("#media-controls [data-control='play']"),r=$("#media-controls [data-control='pause']"),o=$("#media-controls [data-control='stop']");e.on("change",function(e){t.onFileChosen(e)}),n.on("click",function(e){t.onVoiceChosen(e)}),a.on("click",function(e){t.onPlayClicked(e)}),r.on("click",function(e){t.onPauseClicked(e)}),o.on("click",function(e){t.onStopClicked(e)}),$("body").on("click","#media-queue [data-queue-index].close",function(e){return t.onRemoveQueueItem(e)})}},{key:"onAudioStateChange",value:function(t,e){console.log("on state change %s %s",t,e);var n=this.audioManager.getCurrentSourceInfo();if(n&&n.type===f.SOURCE_TYPES.MIC)return void this.setMicControls();switch(t===c.AUDIO_STATE.OFF&&e===c.AUDIO_STATE.PLAYING&&(this.setControlsToStarted(),this.setQueueControls()),e){case c.AUDIO_STATE.OFF:this.setControlsToStopped(),this.setNowPlaying(null),this.resetQueueControls();break;case c.AUDIO_STATE.PLAYING:this.setControlsToPlaying(),this.displayCurrentSong();break;case c.AUDIO_STATE.PAUSED:this.setControlsToPaused()}this.renderMediaQueue()}},{key:"displayCurrentSong",value:function(){var t=this.audioManager.getCurrentSourceInfo();this.setNowPlaying(t.label)}},{key:"onQueueChanged",value:function(){this.displayCurrentSong(),this.renderMediaQueue()}},{key:"addSource",value:function(t){var e=this;t.onLoaded(function(){console.log("SUCCESS"),e.audioManager.addMediaSource(t)},function(){console.log("ERROR")})}},{key:"onFileChosen",value:function(t){var e=this;0!==t.target.files.length&&!function(){var n=e.audioManager.getAudioContext(),a=Array.prototype.slice.call(t.target.files);a.forEach(function(t){var a=new u["default"](n,t);e.addSource(a)}),e.resetFileChooser()}()}},{key:"onVoiceChosen",value:function(){var t=this.audioManager.getCurrentSourceInfo();if(t&&t.type===f.SOURCE_TYPES.MIC)this.resetMicControls(),this.audioManager.stop();else{var e=this.audioManager.getAudioContext(),n=new l["default"](e);this.addSource(n)}}},{key:"onPlayClicked",value:function(){this.audioManager.resume()}},{key:"onPauseClicked",value:function(){this.audioManager.pause()}},{key:"onStopClicked",value:function(t){this.audioManager.stop()}},{key:"setNowPlaying",value:function(t){$("#now-playing").text(t)}},{key:"setControlsToStarted",value:function(){$(M).removeClass("off").addClass("on")}},{key:"setControlsToStopped",value:function(){$(M).addClass("off").removeClass("on"),$(h).removeClass("no-select")}},{key:"resetFileChooser",value:function(){var t=$(h);t.wrap("<form>").closest("form").get(0).reset(),t.unwrap()}},{key:"setControlsToPaused",value:function(){var t=$(M);t.removeClass("playing"),t.addClass("paused")}},{key:"setControlsToPlaying",value:function(){var t=$(M);t.removeClass("paused"),t.addClass("playing")}},{key:"setMicControls",value:function(){var t=$(m),e=$(d);e.find("input, .media-btn").attr("disabled","disabled"),t.addClass("active")}},{key:"setQueueControls",value:function(){var t=$(m);t.find(""+v).attr("disabled","disabled")}},{key:"resetQueueControls",value:function(){var t=$(m);t.find(""+v).removeAttr("disabled")}},{key:"resetMicControls",value:function(){var t=$(m),e=$(d);e.find("input, "+v).removeAttr("disabled"),t.removeClass("active")}},{key:"renderMediaSource",value:function(t,e){var n='<button type="button" class="close" data-queue-index='+e+' aria-label="Remove"><span aria-hidden="true"></span></button>';return"<li>"+n+'<span class="title" data-index="'+e+'">'+t.label+"</span></li>"}},{key:"onRemoveQueueItem",value:function(t){var e=$(t.target).attr("data-queue-index");this.audioManager.removeQueueIndex(e)}},{key:"renderMediaQueue",value:function(){var t=this,e=$("#media-queue"),n=this.audioManager.getQueueInfo().map(function(e,n){return t.renderMediaSource(e,n)}),a=$("<ul></ul>").append(n);e.empty().append(a)}}]),t}();e["default"]=S},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t){return new Promise(function(e,n){var a=new FileReader;a.onload=function(t){var n=t.target.result;e(n)},a.onerror=function(t){console.error(t),n(t)},a.readAsArrayBuffer(t)})}function u(t,e){var n=t.createBufferSource();return n.buffer=e,n.start||(n.start=n.noteOn,n.stop=n.noteOff),n}function s(t,e){return new Promise(function(n,a){t.decodeAudioData(e,function(e){var a=u(t,e);n(a)},function(t){console.error(t),a(t)})})}Object.defineProperty(e,"__esModule",{value:!0});var l=n(21),c=function(t){function e(t,n){a(this,e);var o=r(this,Object.getPrototypeOf(e).call(this,l.SOURCE_TYPES.FILE,t,!0));return o.file=n,o.fileName=n.name,o.label=o.fileName,o.isLoaded=!1,o.fileLoaderPromise=i(n).then(function(e){return s(t,e)}).then(function(t){return o.isLoaded=!0,o.audioNode=t,Promise.resolve()})["catch"](function(t){return Promise.reject(t)}),o}return o(e,t),e}(l.MediaSource);e["default"]=c},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=e.SOURCE_TYPES={FILE:"FILE",MIC:"MIC"},u=function(t){function e(t){n(this,e);var r=a(this,Object.getPrototypeOf(e).call(this,t));return r.message=t,r.name=r.constructor.name,r}return r(e,t),e}(Error),s="Invalid source type";e.MediaSource=function(){function t(e,a){var r=arguments.length<=2||void 0===arguments[2]?!0:arguments[2],o=arguments.length<=3||void 0===arguments[3]?!0:arguments[3];if(n(this,t),!(e in i))throw new u(s);this.sourceType=e,this.audioContext=a,this.useSpeakerDestination=r,this.allowQueuing=o,this.label=null,this.metaData=null,this.isLoaded=!0,this.audioNode=null,this.fileLoaderPromise=Promise.resolve()}return o(t,[{key:"isLoaded",value:function(){return this.isLoaded}},{key:"onLoaded",value:function(t,e){this.fileLoaderPromise.then(t,e)}},{key:"shouldConnectDestination",value:function(){return this.useSpeakerDestination}},{key:"shouldAllowQueueing",value:function(){return this.allowQueuing}},{key:"getLabel",value:function(){return this.label}},{key:"getMetaData",value:function(){return this.metaData}},{key:"getType",value:function(){return this.sourceType}},{key:"getAudioNode",value:function(){return this.audioNode}}]),t}()},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t){return new Promise(function(e,n){navigator.getUserMedia(s,function(n){var a=t.createMediaStreamSource(n);e(a)},function(t){console.error(t),n(t)})})}Object.defineProperty(e,"__esModule",{value:!0});var u=n(21),s={audio:!0},l=function(t){function e(t,n){a(this,e);var o=r(this,Object.getPrototypeOf(e).call(this,u.SOURCE_TYPES.MIC,t,!1,!1));return o.file=n,o.isLoaded=!1,o.fileLoaderPromise=i(t).then(function(t){return o.isLoaded=!0,o.audioNode=t,Promise.resolve()})["catch"](function(t){return Promise.reject(t)}),o}return o(e,t),e}(u.MediaSource);e["default"]=l},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.AUDIO_STATE=void 0;var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n(24),u=a(i),s=e.AUDIO_STATE={OFF:"OFF",PLAYING:"PLAYING",PAUSED:"PAUSED"},l=.85,c=function(){function t(){r(this,t),this.mediaQueue=new u["default"],this.audioContext=new AudioContext,this.analyser=null,this.state=s.OFF,this.currentMediaSource=null,this.stateListeners=[],this.queueListeners=[]}return o(t,[{key:"getAudioContext",value:function(){return this.audioContext}},{key:"isPlaying",value:function(){return this.state===s.PLAYING}},{key:"addMediaSource",value:function(t){0!==this.mediaQueue.size()||this.isPlaying()?t.shouldAllowQueueing()?(this.mediaQueue.enqueue(t),this.notifyQueueListeners()):console.error("Attempt to enqueue source that doesn't allow queueing"):this.connectMediaSource(t)}},{key:"notifyQueueListeners",value:function(){for(var t=0;t<this.stateListeners.length;t++)this.queueListeners[t]()}},{key:"notifyStateListeners",value:function(t,e){for(var n=0;n<this.stateListeners.length;n++)this.stateListeners[n](t,e)}},{key:"setState",value:function(t){var e=this.state;this.state=t,this.notifyStateListeners(e,t)}},{key:"registerQueueListener",value:function(t){this.queueListeners.push(t)}},{key:"registerStateListener",value:function(t){this.stateListeners.push(t)}},{key:"getQueueInfo",value:function(){return this.mediaQueue.getDisplayValues()}},{key:"removeQueueIndex",value:function(t){this.mediaQueue.popIndex(t),this.notifyQueueListeners()}},{key:"getCurrentSourceInfo",value:function(){return this.currentMediaSource?{label:this.currentMediaSource.getLabel(),metadata:this.currentMediaSource.getMetaData(),type:this.currentMediaSource.getType()}:null}},{key:"connectMediaSource",value:function(t){var e=this;this.currentMediaSource=t;var n=this.currentMediaSource.getAudioNode();n.onended=function(){if(console.log("song ended"),e.mediaQueue.size()>0){var t=e.mediaQueue.dequeue();e.notifyQueueListeners,e.connectMediaSource(t)}else e.currentMediaSource=null,e.setState(s.OFF)};var a=void 0;this.currentMediaSource.shouldConnectDestination()&&(a=this.audioContext.destination),this.setupAudioNodes(n,a),n.start&&n.start(0),this.setState(s.PLAYING)}},{key:"resume",value:function(){var t=this;"suspended"===this.audioContext.state&&this.audioContext.resume().then(function(){return t.setState(s.PLAYING)})}},{key:"pause",value:function(){var t=this;"running"===this.audioContext.state&&this.audioContext.suspend().then(function(){return t.setState(s.PAUSED)})}},{key:"stop",value:function(){var t=this.currentMediaSource;if(t&&t.getAudioNode()){var e=t.getAudioNode();if(e.mediaStream){var n=e.mediaStream;if(n.getAudioTracks())for(var a=0;a<n.getAudioTracks().length;a++)n.getAudioTracks()[a].stop&&n.getAudioTracks()[a].stop()}else e.stop&&e.stop();e.disconnect()}this.currentMediaSource=null,this.mediaQueue.clear(),this.setState(s.OFF)}},{key:"createDefaultAnalyser",value:function(){var t=arguments.length<=0||void 0===arguments[0]?256:arguments[0],e=arguments.length<=1||void 0===arguments[1]?l:arguments[1],n=this.audioContext.createAnalyser();return n.smoothingTimeConstant=e,n.fftSize=t,n}},{key:"setupAudioNodes",value:function(t,e){var n=this.createDefaultAnalyser();t.connect(n),e&&n.connect(e),this.analyser=n}},{key:"getFrequencyBinCount",value:function(){return this.analyser.frequencyBinCount}},{key:"getNormalizedFrequencyData",value:function(){if(this.isPlaying()){var t=this.getFrequencyData();if(t&&t.length){for(var e=t.length,n={average:0,bins:[],max:0,min:255},a=8,r=e/a,o=0,i=0;e>i;i++){var u=Math.floor(i/r);n.bins[u]?n.bins[u]+=t[i]:n.bins[u]=t[i],t[i]>n.max&&(n.max=t[i]),t[i]<n.min&&(n.min=t[i]),o+=t[i]}for(var s=0;s<n.bins.length;s++)n.bins[s]=n.bins[s]/255/r;return n.max/=255,n.min/=255,n.average=o/255/e,n}}return null}},{key:"getFrequencyData",value:function(){var t=this.analyser;if(!t)return console.warn("no analyser"),null;var e=t.frequencyBinCount,n=new Uint8Array(e);return t.getByteFrequencyData(n),n}},{key:"getTimeDomainData",value:function(){var t=this.analyser,e=t.frequencyBinCount,n=new Uint8Array(e);return t.getByteTimeDomainData(n),n}}]),t}();e["default"]=c},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=function(){function t(){n(this,t),this.mediaSources=[]}return a(t,[{key:"enqueue",value:function(t){this.mediaSources.push(t)}},{key:"dequeue",value:function(){return this.popIndex(0)}},{key:"size",value:function(){return this.mediaSources.length}},{key:"popIndex",value:function(t){return this.mediaSources.splice(t,1)[0]}},{key:"clear",value:function(){this.mediaSources.splice(0,this.mediaSources.length)}},{key:"getDisplayValues",value:function(){return this.mediaSources.map(function(t){return{label:t.getLabel(),metadata:t.getMetaData(),type:t.getType()}})}}]),t}();e["default"]=r},function(t,e,n){"use strict";function a(t,e,n,a){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.log("An error occurred compiling the shaders: ",t.getShaderInfoLog(r),a),null)}var r=n(26),o=function(){this.fragment={},this.vertex={}};o.prototype.compileShaders=function(t){for(var e=0;e<r.config.length;e++){var n=r.config[e],o=n.source,i=n.type,u=n.name;i===r.TYPE_VERTEX?this.vertex[u]=a(t,t.VERTEX_SHADER,o,u):this.fragment[u]=a(t,t.FRAGMENT_SHADER,o,u)}},t.exports=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=e.TYPE_VERTEX=1,r=e.TYPE_FRAGMENT=2;e.config=[{name:"simpleShader",type:a,source:n(27)},{name:"simpleShader",type:r,source:n(28)},{name:"lineShader",type:a,source:n(29)},{name:"lineShader",type:r,source:n(30)},{name:"barShader",type:a,source:n(31)},{name:"barShader",type:r,source:n(32)},{name:"quadShader",type:a,source:n(33)},{name:"quadShader",type:r,source:n(34)},{name:"gpuParticleShader",type:a,source:n(35)},{name:"gpuParticleShader",type:r,source:n(36)}]},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nattribute vec3 aVertexPosition;\nattribute vec4 aVertexColor;\n\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform mat4 uMMatrix;\n\nvarying lowp vec4 vColor;\n\nvoid main(void) {\n  gl_Position = uPMatrix * uMVMatrix * uMMatrix * vec4(aVertexPosition, 1.0);\n  vColor = aVertexColor;\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nvarying lowp vec4 vColor;\n      \nvoid main(void) {\n  gl_FragColor = vColor;\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nattribute vec3 inCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\n\n\nvoid main(void) {\n  gl_Position = uPMatrix * uMVMatrix * vec4(inCoord, 1.0);\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n      \nvoid main(void) {\n  gl_FragColor = vec4(1,0,0,1);\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nattribute vec3 aVertexPosition;\n\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform mat4 uMMatrix;\n\nvarying lowp vec4 vColor;\n\nvoid main(void) {\n  gl_Position = uPMatrix * uMVMatrix * uMMatrix * vec4(aVertexPosition, 1.0);\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nvoid main(void) {\n  gl_FragColor = vec4(0.4,1.0,1.0,1.0);\n}\n"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\n\nattribute vec2 inCoord;\n\nvarying vec2 coord;\n\nvoid main(void) {\n  gl_Position = vec4((inCoord * 2.0) - vec2(1.0), 0.0, 1.0);\n  coord = inCoord;\n}"},function(t,e){t.exports="/**\n* Copyright 2015 Nick Stanish\n*\n*/\n\nprecision mediump float;\n\nuniform sampler2D inTexture;\nuniform float inWidth;\nuniform float inHeight;\nuniform float inVolume;\n\nvarying vec2 coord;\n\n      \nvoid main(void) {\n  // gl_FragColor = texture2D(inTexture, coord);\n  vec2 center = vec2(0.5, 0.5);\n  vec2 offsetRatio = vec2(1.0 / inWidth, 1.0 / inHeight);\n  float intensity = 20.0 * inVolume;\n  if (inVolume <= 0.0) {\n    intensity = 1.0;\n  }\n\n  vec2 blurVec = (coord - center) * intensity;\n  vec4 pixel = vec4(0.0);\n  for (float i = 0.0; i < 4.0 ; i++){\n    vec2 offset =  blurVec * (i - 4.0) * offsetRatio;\n    float weight = (4.0 - i) / 8.0;\n    pixel += weight * texture2D(inTexture, coord + offset);\n  }\n  gl_FragColor = vec4(pixel.rgb, 1.0);\n}"},function(t,e){t.exports="precision highp float;\n\nconst vec4 bitSh = vec4(256. * 256. * 256., 256. * 256., 256., 1.);\nconst vec4 bitMsk = vec4(0.,vec3(1./256.0));\nconst vec4 bitShifts = vec4(1.) / bitSh;\n\n#define FLOAT_MAX	1.70141184e38\n#define FLOAT_MIN	1.17549435e-38\n\nlowp vec4 encode_float(highp float v) {\n  highp float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n  return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n  return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n  return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  highp vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  highp float e = floor(log2(av));\n  highp float m = av * pow(2.0, -e) - 1.0;\n\n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n\n  //Unpack exponent\n  highp float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0;\n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nvec4 pack(const in float depth) {\n  const vec4 bit_shift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n  const vec4 bit_mask	= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n  vec4 res = mod(depth*bit_shift*vec4(255), vec4(256))/vec4(255);\n  res -= res.xxyz * bit_mask;\n  return res;\n}\n\nfloat unpack(const in vec4 rgba_depth) {\n  const vec4 bit_shift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n  float depth = dot(rgba_depth, bit_shift);\n  return depth;\n}\n\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform vec3 position;\n\n\nuniform float uTime;\nuniform float uScale;\n// uniform sampler2D tNoise;\n\nattribute vec4 particlePositionsStartTime;\nattribute vec4 particleVelColSizeLife;\n\nvarying vec4 vColor;\nvarying float lifeLeft;\n\nvoid main() {\n\n  // unpack things from our attributes\n  vColor = encode_float( particleVelColSizeLife.y );\n\n  // convert our velocity back into a value we can use\n  vec4 velTurb = encode_float( particleVelColSizeLife.x );\n  vec3 velocity = vec3( velTurb.xyz );\n  float turbulence = velTurb.w;\n\n  vec3 newPosition;\n\n  float timeElapsed = uTime - particlePositionsStartTime.a;\n\n  lifeLeft = 1. - (timeElapsed / particleVelColSizeLife.w);\n\n  gl_PointSize = ( uScale * particleVelColSizeLife.z ) * lifeLeft;\n\n  velocity.x = ( velocity.x - .5 ) * 3.;\n  velocity.y = ( velocity.y - .5 ) * 3.;\n  velocity.z = ( velocity.z - .5 ) * 3.;\n\n  newPosition = particlePositionsStartTime.xyz + ( velocity * 10. ) * ( uTime - particlePositionsStartTime.a );\n\n  // vec3 noise = texture2D( tNoise, vec2( newPosition.x * .015 + (uTime * .05), newPosition.y * .02 + (uTime * .015) )).rgb;\n  // vec3 noiseVel = ( noise.rgb - .5 ) * 30.;\n\n  newPosition = mix(newPosition, newPosition /* + vec3(noiseVel * ( turbulence * 5. ) ) */, (timeElapsed / particleVelColSizeLife.a) );\n\n  if (velocity.y > 0. && velocity.y < .05) {\n    lifeLeft = 0.;\n  }\n\n  if (velocity.x < -1.45 ) {\n    lifeLeft = 0.0;\n  }\n\n  if (timeElapsed > 0.0) {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );\n  } else {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    lifeLeft = 0.0;\n    gl_PointSize = 0.0;\n  }\n}\n"},function(t,e){t.exports="precision highp float;\n\nfloat scaleLinear(float value, vec2 valueDomain) {\n  return (value - valueDomain.x) / (valueDomain.y - valueDomain.x);\n}\n\nfloat scaleLinear(float value, vec2 valueDomain, vec2 valueRange) {\n  return mix(valueRange.x, valueRange.y, scaleLinear(value, valueDomain));\n}\n\nvarying vec4 vColor;\nvarying float lifeLeft;\n\nuniform sampler2D tSprite;\n\nvoid main() {\n\n  float alpha = 0.;\n\n  if (lifeLeft > .995 ) {\n    alpha = scaleLinear( lifeLeft, vec2(1., .995), vec2(0., 1.)); //mix( 0., 1., ( lifeLeft - .95 ) * 100. ) * .75;\n  } else {\n    alpha = lifeLeft * .75;\n  }\n\n  vec4 tex = texture2D( tSprite, gl_PointCoord );\n\n  gl_FragColor = vec4( vColor.rgb * tex.rgb, alpha);\n}\n"},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];n(this,t),this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return a(t,[{key:"start",value:function(){this.startTime=Date.now(),this.oldTime=this.startTime,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1}},{key:"getElapsedTime",value:function(){return this.elapsedTime+=this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=Date.now();t=.001*(e-this.oldTime),this.oldTime=e,this.elapsedTime+=t}return t}}]),t}();e["default"]=r},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),u=n(16),s=r(u),l=n(39),c=a(l),f=1e5,M=window.devicePixelRatio,h=function(){function t(e){o(this,t),this.PARTICLE_COUNT=e||f,this.PARTICLE_CURSOR=0,this.time=0,this.randomsStore=new c["default"](function(){return s.getRandom(-1,1)}),this.particles=[],this.deadParticles=[],this.particlesAvailableSlot=[],this.particleUpdate=!1,this.particleBuffers={vertices:new Float32Array(3*this.PARTICLE_COUNT),positionsStartTime:new Float32Array(4*this.PARTICLE_COUNT),velColSizeLife:new Float32Array(4*this.PARTICLE_COUNT)},this.geometryPosStart=new Float32Array(4*this.PARTICLE_COUNT),this.geometryVelCol=new Float32Array(4*this.PARTICLE_COUNT),this.offset=0,this.count=0}return i(t,[{key:"init",value:function(t){this.geometryPosStartBuffer=t.createBuffer(),this.geometryVelColBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.geometryPosStartBuffer),t.bufferData(t.ARRAY_BUFFER,this.geometryPosStart,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.geometryVelColBuffer),t.bufferData(t.ARRAY_BUFFER,this.geometryVelCol,t.DYNAMIC_DRAW);for(var e=this.particleBuffers,n=e.vertices,a=e.positionsStartTime,r=e.velColSizeLife,o=0;o<this.PARTICLE_COUNT;o++){var i=4*o,u=3*o;a[i]=0,a[i+1]=0,a[i+2]=0,a[i+3]=0,n[u]=0,n[u+1]=0,n[u+2]=0,r[i]=s.decodeFloat(128,128,0,0),r[i+1]=s.decodeFloat(0,255,0,255),r[i+2]=1,r[i+3]=0}}},{key:"spawnParticle",value:function(t){t=t||{};var e=[0,0,0],n=[0,0,0],a=0,r=0,o=16777215,i=0,u=0,l=0,c=0,f=0,h=void 0,d=2,m=250;e=void 0!==t.position?t.position:e,n=void 0!==t.velocity?t.velocity:n,a=void 0!==t.positionRandomness?t.positionRandomness:0,r=void 0!==t.velocityRandomness?t.velocityRandomness:0,o=void 0!==t.color?t.color:16777215,i=void 0!==t.colorRandomness?t.colorRandomness:1,u=void 0!==t.turbulence?t.turbulence:1,l=void 0!==t.lifetime?t.lifetime:5,c=void 0!==t.size?t.size:10,f=void 0!==t.sizeRandomness?t.sizeRandomness:0,h=void 0!==t.smoothPosition?t.smoothPosition:!1,void 0!==M&&(c*=M);var v=this.PARTICLE_CURSOR;this.geometryPosStart[4*v+0]=e[0]+this.randomsStore.random()*a,this.geometryPosStart[4*v+1]=e[1]+this.randomsStore.random()*a,this.geometryPosStart[4*v+2]=e[2]+this.randomsStore.random()*a,this.geometryPosStart[4*v+3]=this.time,h===!0&&(this.geometryPosStart[4*v+0]+=-(n[0]*this.randomsStore.random()),this.geometryPosStart[4*v+1]+=-(n[1]*this.randomsStore.random()),this.geometryPosStart[4*v+2]+=-(n[2]*this.randomsStore.random()));var S=n[0]+this.randomsStore.random()*r,x=n[1]+this.randomsStore.random()*r,p=n[2]+this.randomsStore.random()*r;u=Math.floor(255*u),S=Math.floor(m*((S- -d)/(d- -d))),x=Math.floor(m*((x- -d)/(d- -d))),p=Math.floor(m*((p- -d)/(d- -d))),this.geometryVelCol[4*v+0]=s.decodeFloat(S,x,p,u);for(var I=s.hexToRgb(o),g=0;g<I.length;g++)I[g]=Math.floor(I[g]+this.randomsStore.random()*i*255),I[g]>=255&&(I[g]=255),I[g]<=0&&(I[g]=0);this.geometryVelCol[4*v+1]=s.decodeFloat(I[0],I[1],I[2],255),this.geometryVelCol[4*v+2]=c+this.randomsStore.random()*f,this.geometryVelCol[4*v+3]=l,0==this.offset&&(this.offset=this.PARTICLE_CURSOR),this.count++,this.PARTICLE_CURSOR++,this.PARTICLE_CURSOR>=this.PARTICLE_COUNT&&(this.PARTICLE_CURSOR=0),this.particleUpdate=!0}},{key:"update",value:function(t,e){this.time=t,this.geometryUpdate(e)}},{key:"geometryUpdate",value:function(t){if(1==this.particleUpdate){if(this.particleUpdate=!1,this.count<this.PARTICLE_COUNT){var e=4*this.offset,n=e+4*this.count,a=4*e;t.bindBuffer(t.ARRAY_BUFFER,this.geometryPosStartBuffer),t.bufferSubData(t.ARRAY_BUFFER,a,this.geometryPosStart.subarray(e,n)),t.bindBuffer(t.ARRAY_BUFFER,this.geometryVelColBuffer),t.bufferSubData(t.ARRAY_BUFFER,a,this.geometryVelCol.subarray(e,n))}else t.bufferData(t.ARRAY_BUFFER,this.geometryPosStart,t.DYNAMIC_DRAW),t.bufferData(t.ARRAY_BUFFER,this.geometryVelColBuffer,t.DYNAMIC_DRAW);this.offset=0,this.count=0}}}]),t}();e["default"]=h},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=e.DEFAULT_MAX_RANDOMS=1e4,o=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?Math.random:arguments[0],a=arguments.length<=1||void 0===arguments[1]?r:arguments[1];n(this,t),this.MAX_RANDOMS=a,this.randoms=new Float32Array(this.MAX_RANDOMS),this.init(e),this.cursor=0}return a(t,[{key:"init",value:function(t){for(var e=0;e<this.randoms.length;e++)this.randoms[e]=t()}},{key:"random",value:function(){return this.cursor>=this.randoms.length&&(this.cursor=0),this.randoms[this.cursor++]}}]),t}();e["default"]=o},function(t,e){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=function(){function t(){a(this,t),this.keyStatus={},this.keysToActions={}}return r(t,[{key:"setKeyActive",value:function(t){this.keyStatus[t]=!0}},{key:"setKeyInactive",value:function(t){this.keyStatus[t]=!1}},{key:"isKeyActive",value:function(t){return!!this.keyStatus[t]}},{key:"registerKeyAction",value:function(t,e){this.keysToActions[t]=e}},{key:"getActiveActions",value:function(){var t=this,e=Object.keys(this.keyStatus).filter(function(e){return t.isKeyActive(e)}),a=new Set;return e.forEach(function(e){t.keysToActions[e]&&a.add(t.keysToActions[e])}),[].concat(n(a))}}]),t}();e["default"]=o},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.COLORS=e.COLOR_MAP=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,
"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(16),i=function(){function t(e,n,r){a(this,t),this.r=e,this.g=n,this.b=r}return r(t,[{key:"toHexString",value:function(){var t=this.r,e=this.g,n=this.b;return o.rgbToHex(t,e,n)}},{key:"toValue",value:function(){var t=this.r,e=this.g,n=this.b;return o.rgbToValue(t,e,n)}},{key:"toArray",value:function(){var t=this.r,e=this.g,n=this.b;return[t,e,n]}}]),t}(),u=e.COLOR_MAP={red:new i(244,67,54),purple:new i(156,39,176),blue:new i(33,150,243),green:new i(76,175,80),yellow:new i(255,235,59),orange:new i(255,152,0),cyan:new i(0,172,193),pink:new i(233,30,99)};e.COLORS=Object.keys(u).map(function(t){return u[t]})},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.VK_W=87,e.VK_A=65,e.VK_S=83,e.VK_D=68,e.VK_ARROW_LEFT=37,e.VK_ARROW_UP=38,e.VK_ARROW_RIGHT=39,e.VK_ARROW_DOWN=40},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.CAMERA_MOVE_POS_YAW="CAMERA_MOVE_POS_YAW",e.CAMERA_MOVE_NEG_YAW="CAMERA_MOVE_NEG_YAW",e.CAMERA_MOVE_POS_PITCH="CAMERA_MOVE_POS_PITCH",e.CAMERA_MOVE_NEG_PITCH="CAMERA_MOVE_NEG_PITCH",e.CAMERA_MOVE_POS_X="CAMERA_MOVE_POS_X",e.CAMERA_MOVE_NEG_X="CAMERA_MOVE_NEG_X",e.CAMERA_MOVE_POS_Y="CAMERA_MOVE_POS_Y",e.CAMERA_MOVE_NEG_Y="CAMERA_MOVE_NEG_Y",e.CAMERA_MOVE_POS_Z="CAMERA_MOVE_POS_Z",e.CAMERA_MOVE_NEG_Z="CAMERA_MOVE_NEG_Z"},function(t,e){}])});
//# sourceMappingURL=visual-audio.js.map